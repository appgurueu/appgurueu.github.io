<!doctype html>
<!-- Template for lua_api.html -->
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="description" content="Minetest Magic-CTF homepage">
        <meta name="author" content="Lars MÃ¼ller">
        <link rel="icon" href="icon.png"> 
        <div class="bg"></div>

        <title>Minetest Lua API</title>
        <link rel="shortcut icon" href="https://forum.minetest.net/styles/mt_v1/theme/images/favicon.ico">

        <!-- Scripts and stylesheets -->
        <!-- Bootstrap core CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        <link href="/jumbotron.css" rel="stylesheet">
    </head>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

    <body data-spy="scroll" data-target="#contenttable" data-offset="15">

        <!-- Table of content -->
        <div class="position-fixed">
            <nav class="col-lg" id="contenttable">
                <ul class="nav nav-pills nav-stacked affix" data-spy="affix" data-offset-top="205">
                    <li><a class="nav-link" href="#gheader1"><h1><p>Minetest Lua Modding API Reference</p></h1></a></li><li><a class="nav-link" href="#gheader2"><h2><p>Introduction</p></h2></a></li><li><a class="nav-link" href="#gheader3"><h2><p>Programming in Lua</p></h2></a></li><li><a class="nav-link" href="#gheader4"><h2><p>Startup</p></h2></a></li><li><a class="nav-link" href="#gheader5"><h2><p>Paths</p></h2></a></li><li><a class="nav-link" href="#gheader6"><h2><p>Games</p></h2></a></li><li><a class="nav-link" href="#gheader7"><h3><p>Menu images</p></h3></a></li><li><a class="nav-link" href="#gheader8"><h2><p>Mod load path</p></h2></a></li><li><a class="nav-link" href="#gheader9"><h2><p>Mod load path for world-specific games</p></h2></a></li><li><a class="nav-link" href="#gheader10"><h2><p>Modpack support</p></h2></a></li><li><a class="nav-link" href="#gheader11"><h2><p>Mod directory structure</p></h2></a></li><li><a class="nav-link" href="#gheader12"><h3><p>modname</p></h3></a></li><li><a class="nav-link" href="#gheader13"><h3><p>mod.conf</p></h3></a></li><li><a class="nav-link" href="#gheader14"><h3><p><code>screenshot.png</code></p></h3></a></li><li><a class="nav-link" href="#gheader15"><h3><p><code>depends.txt</code></p></h3></a></li><li><a class="nav-link" href="#gheader16"><h3><p><code>description.txt</code></p></h3></a></li><li><a class="nav-link" href="#gheader17"><h3><p><code>settingtypes.txt</code></p></h3></a></li><li><a class="nav-link" href="#gheader18"><h3><p><code>init.lua</code></p></h3></a></li><li><a class="nav-link" href="#gheader19"><h3><p><code>models</code></p></h3></a></li><li><a class="nav-link" href="#gheader20"><h3><p><code>textures</code>, <code>sounds</code>, <code>media</code></p></h3></a></li><li><a class="nav-link" href="#gheader21"><h3><p><code>locale</code></p></h3></a></li><li><a class="nav-link" href="#gheader22"><h2><p>Naming convention for registered textual names</p></h2></a></li><li><a class="nav-link" href="#gheader23"><h3><p>Example</p></h3></a></li><li><a class="nav-link" href="#gheader24"><h2><p>Aliases</p></h2></a></li><li><a class="nav-link" href="#gheader25"><h2><p>Mapgen aliases</p></h2></a></li><li><a class="nav-link" href="#gheader26"><h3><p>Aliases needed for all mapgens except Mapgen v6</p></h3></a></li><li><a class="nav-link" href="#gheader27"><h3><p>Aliases needed for Mapgen v6</p></h3></a></li><li><a class="nav-link" href="#gheader28"><h2><p>Textures</p></h2></a></li><li><a class="nav-link" href="#gheader29"><h2><p>Texture modifiers</p></h2></a></li><li><a class="nav-link" href="#gheader30"><h3><p>Texture overlaying</p></h3></a></li><li><a class="nav-link" href="#gheader31"><h3><p>Texture grouping</p></h3></a></li><li><a class="nav-link" href="#gheader32"><h3><p>Escaping</p></h3></a></li><li><a class="nav-link" href="#gheader33"><h3><p>Advanced texture modifiers</p></h3></a></li><li><a class="nav-link" href="#gheader34"><h4><p>Crack</p></h4></a></li><li><a class="nav-link" href="#gheader35"><h4><p><code>[combine:&lt;w&gt;x&lt;h&gt;:&lt;x1&gt;,&lt;y1&gt;=&lt;file1&gt;:&lt;x2&gt;,&lt;y2&gt;=&lt;file2&gt;:...</code></p></h4></a></li><li><a class="nav-link" href="#gheader36"><h4><p><code>[resize:&lt;w&gt;x&lt;h&gt;</code></p></h4></a></li><li><a class="nav-link" href="#gheader37"><h4><p><code>[opacity:&lt;r&gt;</code></p></h4></a></li><li><a class="nav-link" href="#gheader38"><h4><p><code>[invert:&lt;mode&gt;</code></p></h4></a></li><li><a class="nav-link" href="#gheader39"><h4><p><code>[brighten</code></p></h4></a></li><li><a class="nav-link" href="#gheader40"><h4><p><code>[noalpha</code></p></h4></a></li><li><a class="nav-link" href="#gheader41"><h4><p><code>[makealpha:&lt;r&gt;,&lt;g&gt;,&lt;b&gt;</code></p></h4></a></li><li><a class="nav-link" href="#gheader42"><h4><p><code>[transform&lt;t&gt;</code></p></h4></a></li><li><a class="nav-link" href="#gheader43"><h4><p><code>[inventorycube{&lt;top&gt;{&lt;left&gt;{&lt;right&gt;</code></p></h4></a></li><li><a class="nav-link" href="#gheader44"><h4><p><code>[lowpart:&lt;percent&gt;:&lt;file&gt;</code></p></h4></a></li><li><a class="nav-link" href="#gheader45"><h4><p><code>[verticalframe:&lt;t&gt;:&lt;n&gt;</code></p></h4></a></li><li><a class="nav-link" href="#gheader46"><h4><p><code>[mask:&lt;file&gt;</code></p></h4></a></li><li><a class="nav-link" href="#gheader47"><h4><p><code>[sheet:&lt;w&gt;x&lt;h&gt;:&lt;x&gt;,&lt;y&gt;</code></p></h4></a></li><li><a class="nav-link" href="#gheader48"><h1><br></h1></a></li><li><a class="nav-link" href="#gheader49"><h4><p><code>[colorize:&lt;color&gt;:&lt;ratio&gt;</code></p></h4></a></li><li><a class="nav-link" href="#gheader50"><h4><p><code>[multiply:&lt;color&gt;</code></p></h4></a></li><li><a class="nav-link" href="#gheader51"><h2><p>Hardware coloring</p></h2></a></li><li><a class="nav-link" href="#gheader52"><h3><p>Static coloring</p></h3></a></li><li><a class="nav-link" href="#gheader53"><h4><p>Global color</p></h4></a></li><li><a class="nav-link" href="#gheader54"><h4><p>Tile color</p></h4></a></li><li><a class="nav-link" href="#gheader55"><h3><p>Palettes</p></h3></a></li><li><a class="nav-link" href="#gheader56"><h4><p>Palette indexing</p></h4></a></li><li><a class="nav-link" href="#gheader57"><h4><p>Using palettes with items</p></h4></a></li><li><a class="nav-link" href="#gheader58"><h4><p>Linking palettes with nodes</p></h4></a></li><li><a class="nav-link" href="#gheader59"><h3><p>Conversion between nodes in the inventory and the on the map</p></h3></a></li><li><a class="nav-link" href="#gheader60"><h3><p>Colored items in craft recipes</p></h3></a></li><li><a class="nav-link" href="#gheader61"><h2><p>Soft texture overlay</p></h2></a></li><li><a class="nav-link" href="#gheader62"><h2><p>Sounds</p></h2></a></li><li><a class="nav-link" href="#gheader63"><h3><p><code>SimpleSoundSpec</code></p></h3></a></li><li><a class="nav-link" href="#gheader64"><h2><p>Registered definitions of stuff</p></h2></a></li><li><a class="nav-link" href="#gheader65"><h2><p>Nodes</p></h2></a></li><li><a class="nav-link" href="#gheader66"><h2><p>Node drawtypes</p></h2></a></li><li><a class="nav-link" href="#gheader67"><h2><p>Node boxes</p></h2></a></li><li><a class="nav-link" href="#gheader68"><h1><br></h1></a></li><li><a class="nav-link" href="#gheader69"><h2><p>HUD element types</p></h2></a></li><li><a class="nav-link" href="#gheader70"><h3><p><code>image</code></p></h3></a></li><li><a class="nav-link" href="#gheader71"><h3><p><code>text</code></p></h3></a></li><li><a class="nav-link" href="#gheader72"><h3><p><code>statbar</code></p></h3></a></li><li><a class="nav-link" href="#gheader73"><h3><p><code>inventory</code></p></h3></a></li><li><a class="nav-link" href="#gheader74"><h3><p><code>waypoint</code></p></h3></a></li><li><a class="nav-link" href="#gheader75"><h2><p>Representations of simple things</p></h2></a></li><li><a class="nav-link" href="#gheader76"><h3><p>Position/vector</p></h3></a></li><li><a class="nav-link" href="#gheader77"><h3><p><code>pointed_thing</code></p></h3></a></li><li><a class="nav-link" href="#gheader78"><h2><p>Flag Specifier Format</p></h2></a></li><li><a class="nav-link" href="#gheader79"><h2><p>Items</p></h2></a></li><li><a class="nav-link" href="#gheader80"><h3><p>Item types</p></h3></a></li><li><a class="nav-link" href="#gheader81"><h3><p>Amount and wear</p></h3></a></li><li><a class="nav-link" href="#gheader82"><h3><p>Item formats</p></h3></a></li><li><a class="nav-link" href="#gheader83"><h4><p>Serialized</p></h4></a></li><li><a class="nav-link" href="#gheader84"><h4><p>Table format</p></h4></a></li><li><a class="nav-link" href="#gheader85"><h4><p><code>ItemStack</code></p></h4></a></li><li><a class="nav-link" href="#gheader86"><h1><br></h1></a></li><li><a class="nav-link" href="#gheader87"><h2><p>Groups</p></h2></a></li><li><a class="nav-link" href="#gheader88"><h3><p>Usage</p></h3></a></li><li><a class="nav-link" href="#gheader89"><h3><p>Groups of items</p></h3></a></li><li><a class="nav-link" href="#gheader90"><h3><p>Groups of nodes</p></h3></a></li><li><a class="nav-link" href="#gheader91"><h3><p>Groups of entities</p></h3></a></li><li><a class="nav-link" href="#gheader92"><h3><p>Groups of tools</p></h3></a></li><li><a class="nav-link" href="#gheader93"><h3><p>Groups in crafting recipes</p></h3></a></li><li><a class="nav-link" href="#gheader94"><h3><p>Special groups</p></h3></a></li><li><a class="nav-link" href="#gheader95"><h1><br></h1></a></li><li><a class="nav-link" href="#gheader96"><h3><p>Known damage and digging time defining groups</p></h3></a></li><li><a class="nav-link" href="#gheader97"><h3><p>Examples of custom groups</p></h3></a></li><li><a class="nav-link" href="#gheader98"><h3><p>Digging time calculation specifics</p></h3></a></li><li><a class="nav-link" href="#gheader99"><h4><p>Tools definition</p></h4></a></li><li><a class="nav-link" href="#gheader100"><h4><p>Full punch interval</p></h4></a></li><li><a class="nav-link" href="#gheader101"><h4><p>Maximum drop level</p></h4></a></li><li><a class="nav-link" href="#gheader102"><h4><p>Uses</p></h4></a></li><li><a class="nav-link" href="#gheader103"><h4><p>Maximum level</p></h4></a></li><li><a class="nav-link" href="#gheader104"><h4><p>Digging times</p></h4></a></li><li><a class="nav-link" href="#gheader105"><h4><p>Damage groups</p></h4></a></li><li><a class="nav-link" href="#gheader106"><h4><p>Example definition of the capabilities of a tool</p></h4></a></li><li><a class="nav-link" href="#gheader107"><h2><p>Entity damage mechanism</p></h2></a></li><li><a class="nav-link" href="#gheader108"><h2><p>Node Metadata</p></h2></a></li><li><a class="nav-link" href="#gheader109"><h2><p>Item Metadata</p></h2></a></li><li><a class="nav-link" href="#gheader110"><h2><p>Formspec</p></h2></a></li><li><a class="nav-link" href="#gheader111"><h3><p>Examples</p></h3></a></li><li><a class="nav-link" href="#gheader112"><h4><p>Chest</p></h4></a></li><li><a class="nav-link" href="#gheader113"><h4><p>Furnace</p></h4></a></li><li><a class="nav-link" href="#gheader114"><h4><p>Minecraft-like player inventory</p></h4></a></li><li><a class="nav-link" href="#gheader115"><h3><p>Elements</p></h3></a></li><li><a class="nav-link" href="#gheader116"><h4><p><code>size[&lt;W&gt;,&lt;H&gt;,&lt;fixed_size&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader117"><h4><p><code>position[&lt;X&gt;,&lt;Y&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader118"><h4><p><code>anchor[&lt;X&gt;,&lt;Y&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader119"><h4><p><code>no_prepend[]</code></p></h4></a></li><li><a class="nav-link" href="#gheader120"><h4><p><code>container[&lt;X&gt;,&lt;Y&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader121"><h4><p><code>container_end[]</code></p></h4></a></li><li><a class="nav-link" href="#gheader122"><h4><p><code>list[&lt;inventory location&gt;;&lt;list name&gt;;&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader123"><h4><p><code>list[&lt;inventory location&gt;;&lt;list name&gt;;&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;starting item index&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader124"><h4><p><code>listring[&lt;inventory location&gt;;&lt;list name&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader125"><h4><p><code>listring[]</code></p></h4></a></li><li><a class="nav-link" href="#gheader126"><h4><p><code>listcolors[&lt;slot_bg_normal&gt;;&lt;slot_bg_hover&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader127"><h4><p><code>listcolors[&lt;slot_bg_normal&gt;;&lt;slot_bg_hover&gt;;&lt;slot_border&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader128"><h4><p><code>listcolors[&lt;slot_bg_normal&gt;;&lt;slot_bg_hover&gt;;&lt;slot_border&gt;;&lt;tooltip_bgcolor&gt;;&lt;tooltip_fontcolor&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader129"><h4><p><code>tooltip[&lt;gui_element_name&gt;;&lt;tooltip_text&gt;;&lt;bgcolor&gt;;&lt;fontcolor&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader130"><h4><p><code>image[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;texture name&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader131"><h4><p><code>item_image[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;item name&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader132"><h4><p><code>bgcolor[&lt;color&gt;;&lt;fullscreen&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader133"><h4><p><code>background[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;texture name&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader134"><h4><p><code>background[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;texture name&gt;;&lt;auto_clip&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader135"><h4><p><code>pwdfield[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;label&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader136"><h4><p><code>field[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;label&gt;;&lt;default&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader137"><h4><p><code>field[&lt;name&gt;;&lt;label&gt;;&lt;default&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader138"><h4><p><code>field_close_on_enter[&lt;name&gt;;&lt;close_on_enter&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader139"><h4><p><code>textarea[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;label&gt;;&lt;default&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader140"><h4><p><code>label[&lt;X&gt;,&lt;Y&gt;;&lt;label&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader141"><h4><p><code>vertlabel[&lt;X&gt;,&lt;Y&gt;;&lt;label&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader142"><h4><p><code>button[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;label&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader143"><h4><p><code>image_button[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;texture name&gt;;&lt;name&gt;;&lt;label&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader144"><h4><p><code>image_button[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;texture name&gt;;&lt;name&gt;;&lt;label&gt;;&lt;noclip&gt;;&lt;drawborder&gt;;&lt;pressed texture name&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader145"><h4><p><code>item_image_button[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;item name&gt;;&lt;name&gt;;&lt;label&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader146"><h4><p><code>button_exit[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;label&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader147"><h4><p><code>image_button_exit[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;texture name&gt;;&lt;name&gt;;&lt;label&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader148"><h4><p><code>textlist[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;listelem 1&gt;,&lt;listelem 2&gt;,...,&lt;listelem n&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader149"><h4><p><code>textlist[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;listelem 1&gt;,&lt;listelem 2&gt;,...,&lt;listelem n&gt;;&lt;selected idx&gt;;&lt;transparent&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader150"><h4><p><code>tabheader[&lt;X&gt;,&lt;Y&gt;;&lt;name&gt;;&lt;caption 1&gt;,&lt;caption 2&gt;,...,&lt;caption n&gt;;&lt;current_tab&gt;;&lt;transparent&gt;;&lt;draw_border&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader151"><h4><p><code>box[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;color&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader152"><h4><p><code>dropdown[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;;&lt;name&gt;;&lt;item 1&gt;,&lt;item 2&gt;, ...,&lt;item n&gt;;&lt;selected idx&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader153"><h4><p><code>checkbox[&lt;X&gt;,&lt;Y&gt;;&lt;name&gt;;&lt;label&gt;;&lt;selected&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader154"><h4><p><code>scrollbar[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;orientation&gt;;&lt;name&gt;;&lt;value&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader155"><h4><p><code>table[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;cell 1&gt;,&lt;cell 2&gt;,...,&lt;cell n&gt;;&lt;selected idx&gt;]</code></p></h4></a></li><li><a class="nav-link" href="#gheader156"><h4><p><code>tableoptions[&lt;opt 1&gt;;&lt;opt 2&gt;;...]</code></p></h4></a></li><li><a class="nav-link" href="#gheader157"><h4><p><code>tablecolumns[&lt;type 1&gt;,&lt;opt 1a&gt;,&lt;opt 1b&gt;,...;&lt;type 2&gt;,&lt;opt 2a&gt;,&lt;opt 2b&gt;;...]</code></p></h4></a></li><li><a class="nav-link" href="#gheader158"><h2><p>Inventory locations</p></h2></a></li><li><a class="nav-link" href="#gheader159"><h2><p>Player Inventory lists</p></h2></a></li><li><a class="nav-link" href="#gheader160"><h2><p><code>ColorString</code></p></h2></a></li><li><a class="nav-link" href="#gheader161"><h2><p><code>ColorSpec</code></p></h2></a></li><li><a class="nav-link" href="#gheader162"><h2><p>Escape sequences</p></h2></a></li><li><a class="nav-link" href="#gheader163"><h2><p>Spatial Vectors</p></h2></a></li><li><a class="nav-link" href="#gheader164"><h2><p>Helper functions</p></h2></a></li><li><a class="nav-link" href="#gheader165"><h2><p>Translations</p></h2></a></li><li><a class="nav-link" href="#gheader166"><h3><p>Translating a string</p></h3></a></li><li><a class="nav-link" href="#gheader167"><h3><p>Operations on translated strings</p></h3></a></li><li><a class="nav-link" href="#gheader168"><h3><p>Translation file format</p></h3></a></li><li><a class="nav-link" href="#gheader169"><h3><p>Escapes</p></h3></a></li><li><a class="nav-link" href="#gheader170"><h2><p>Perlin noise</p></h2></a></li><li><a class="nav-link" href="#gheader171"><h3><p>Structure of perlin noise</p></h3></a></li><li><a class="nav-link" href="#gheader172"><h2><p>Noise Parameters</p></h2></a></li><li><a class="nav-link" href="#gheader173"><h3><p><code>offset</code></p></h3></a></li><li><a class="nav-link" href="#gheader174"><h3><p><code>scale</code></p></h3></a></li><li><a class="nav-link" href="#gheader175"><h3><p><code>spread</code></p></h3></a></li><li><a class="nav-link" href="#gheader176"><h3><p><code>seed</code></p></h3></a></li><li><a class="nav-link" href="#gheader177"><h3><p><code>octaves</code></p></h3></a></li><li><a class="nav-link" href="#gheader178"><h3><p><code>persistence</code></p></h3></a></li><li><a class="nav-link" href="#gheader179"><h3><p><code>lacunarity</code></p></h3></a></li><li><a class="nav-link" href="#gheader180"><h3><p><code>flags</code></p></h3></a></li><li><a class="nav-link" href="#gheader181"><h4><p><code>defaults</code></p></h4></a></li><li><a class="nav-link" href="#gheader182"><h4><p><code>eased</code></p></h4></a></li><li><a class="nav-link" href="#gheader183"><h4><p><code>absvalue</code></p></h4></a></li><li><a class="nav-link" href="#gheader184"><h3><p>Format example</p></h3></a></li><li><a class="nav-link" href="#gheader185"><h2><p>Ore types</p></h2></a></li><li><a class="nav-link" href="#gheader186"><h3><p><code>scatter</code></p></h3></a></li><li><a class="nav-link" href="#gheader187"><h3><p><code>sheet</code></p></h3></a></li><li><a class="nav-link" href="#gheader188"><h3><p><code>puff</code></p></h3></a></li><li><a class="nav-link" href="#gheader189"><h3><p><code>blob</code></p></h3></a></li><li><a class="nav-link" href="#gheader190"><h3><p><code>vein</code></p></h3></a></li><li><a class="nav-link" href="#gheader191"><h3><p><code>stratum</code></p></h3></a></li><li><a class="nav-link" href="#gheader192"><h2><p>Ore attributes</p></h2></a></li><li><a class="nav-link" href="#gheader193"><h3><p><code>puff_cliffs</code></p></h3></a></li><li><a class="nav-link" href="#gheader194"><h3><p><code>puff_additive_composition</code></p></h3></a></li><li><a class="nav-link" href="#gheader195"><h2><p>Decoration types</p></h2></a></li><li><a class="nav-link" href="#gheader196"><h3><p><code>simple</code></p></h3></a></li><li><a class="nav-link" href="#gheader197"><h3><p><code>schematic</code></p></h3></a></li><li><a class="nav-link" href="#gheader198"><h2><p>Schematic specifier</p></h2></a></li><li><a class="nav-link" href="#gheader199"><h2><p>Schematic attributes</p></h2></a></li><li><a class="nav-link" href="#gheader200"><h2><p>Lua Voxel Manipulator</p></h2></a></li><li><a class="nav-link" href="#gheader201"><h3><p>About VoxelManip</p></h3></a></li><li><a class="nav-link" href="#gheader202"><h3><p>Using VoxelManip</p></h3></a></li><li><a class="nav-link" href="#gheader203"><h1><br></h1></a></li><li><a class="nav-link" href="#gheader204"><h4><p>Flat array format</p></h4></a></li><li><a class="nav-link" href="#gheader205"><h1><br></h1></a></li><li><a class="nav-link" href="#gheader206"><h1><br></h1></a></li><li><a class="nav-link" href="#gheader207"><h4><p>Content IDs</p></h4></a></li><li><a class="nav-link" href="#gheader208"><h4><p>Mapgen VoxelManip objects</p></h4></a></li><li><a class="nav-link" href="#gheader209"><h4><p>Other API functions operating on a VoxelManip</p></h4></a></li><li><a class="nav-link" href="#gheader210"><h4><p>Notes</p></h4></a></li><li><a class="nav-link" href="#gheader211"><h3><p>Methods</p></h3></a></li><li><a class="nav-link" href="#gheader212"><h3><p><code>VoxelArea</code></p></h3></a></li><li><a class="nav-link" href="#gheader213"><h4><p>Methods</p></h4></a></li><li><a class="nav-link" href="#gheader214"><h2><p>Mapgen objects</p></h2></a></li><li><a class="nav-link" href="#gheader215"><h3><p><code>voxelmanip</code></p></h3></a></li><li><a class="nav-link" href="#gheader216"><h3><p><code>heightmap</code></p></h3></a></li><li><a class="nav-link" href="#gheader217"><h3><p><code>biomemap</code></p></h3></a></li><li><a class="nav-link" href="#gheader218"><h3><p><code>heatmap</code></p></h3></a></li><li><a class="nav-link" href="#gheader219"><h3><p><code>humiditymap</code></p></h3></a></li><li><a class="nav-link" href="#gheader220"><h3><p><code>gennotify</code></p></h3></a></li><li><a class="nav-link" href="#gheader221"><h2><p>Registered entities</p></h2></a></li><li><a class="nav-link" href="#gheader222"><h2><p>L-system trees</p></h2></a></li><li><a class="nav-link" href="#gheader223"><h3><p>Tree definition</p></h3></a></li><li><a class="nav-link" href="#gheader224"><h3><p>Key for Special L-System Symbols used in Axioms</p></h3></a></li><li><a class="nav-link" href="#gheader225"><h3><p>Example</p></h3></a></li><li><a class="nav-link" href="#gheader226"><h1><br></h1></a></li><li><a class="nav-link" href="#gheader227"><h2><p><code>minetest</code> namespace reference</p></h2></a></li><li><a class="nav-link" href="#gheader228"><h3><p>Utilities</p></h3></a></li><li><a class="nav-link" href="#gheader229"><h3><p>Logging</p></h3></a></li><li><a class="nav-link" href="#gheader230"><h3><p>Registration functions</p></h3></a></li><li><a class="nav-link" href="#gheader231"><h3><p>Global callback registration functions</p></h3></a></li><li><a class="nav-link" href="#gheader232"><h3><p>Other registration functions</p></h3></a></li><li><a class="nav-link" href="#gheader233"><h3><p>Setting-related</p></h3></a></li><li><a class="nav-link" href="#gheader234"><h3><p>Authentication</p></h3></a></li><li><a class="nav-link" href="#gheader235"><h3><p>Chat</p></h3></a></li><li><a class="nav-link" href="#gheader236"><h3><p>Environment access</p></h3></a></li><li><a class="nav-link" href="#gheader237"><h3><p>Mod channels</p></h3></a></li><li><a class="nav-link" href="#gheader238"><h3><p>Inventory</p></h3></a></li><li><a class="nav-link" href="#gheader239"><h3><p>Formspec</p></h3></a></li><li><a class="nav-link" href="#gheader240"><h3><p>Item handling</p></h3></a></li><li><a class="nav-link" href="#gheader241"><h3><p>Rollback</p></h3></a></li><li><a class="nav-link" href="#gheader242"><h3><p>Defaults for the <code>on_*</code> item definition functions</p></h3></a></li><li><a class="nav-link" href="#gheader243"><h3><p>Defaults for the <code>on_punch</code> and <code>on_dig</code> node definition callbacks</p></h3></a></li><li><a class="nav-link" href="#gheader244"><h3><p>Sounds</p></h3></a></li><li><a class="nav-link" href="#gheader245"><h3><p>Timing</p></h3></a></li><li><a class="nav-link" href="#gheader246"><h3><p>Server</p></h3></a></li><li><a class="nav-link" href="#gheader247"><h3><p>Bans</p></h3></a></li><li><a class="nav-link" href="#gheader248"><h3><p>Particles</p></h3></a></li><li><a class="nav-link" href="#gheader249"><h3><p>Schematics</p></h3></a></li><li><a class="nav-link" href="#gheader250"><h3><p>HTTP Requests:</p></h3></a></li><li><a class="nav-link" href="#gheader251"><h3><p>Storage API:</p></h3></a></li><li><a class="nav-link" href="#gheader252"><h3><p>Misc.</p></h3></a></li><li><a class="nav-link" href="#gheader253"><h3><p>Global objects</p></h3></a></li><li><a class="nav-link" href="#gheader254"><h3><p>Global tables</p></h3></a></li><li><a class="nav-link" href="#gheader255"><h1><br></h1></a></li><li><a class="nav-link" href="#gheader256"><h2><p>Class reference</p></h2></a></li><li><a class="nav-link" href="#gheader257"><h3><p><code>AreaStore</code></p></h3></a></li><li><a class="nav-link" href="#gheader258"><h4><p>Methods</p></h4></a></li><li><a class="nav-link" href="#gheader259"><h3><p><code>InvRef</code></p></h3></a></li><li><a class="nav-link" href="#gheader260"><h4><p>Methods</p></h4></a></li><li><a class="nav-link" href="#gheader261"><h3><p><code>ItemStack</code></p></h3></a></li><li><a class="nav-link" href="#gheader262"><h4><p>Methods</p></h4></a></li><li><a class="nav-link" href="#gheader263"><h3><p><code>ItemStackMetaRef</code></p></h3></a></li><li><a class="nav-link" href="#gheader264"><h4><p>Methods</p></h4></a></li><li><a class="nav-link" href="#gheader265"><h3><p><code>MetaDataRef</code></p></h3></a></li><li><a class="nav-link" href="#gheader266"><h4><p>Methods</p></h4></a></li><li><a class="nav-link" href="#gheader267"><h3><p>ModChannel</p></h3></a></li><li><a class="nav-link" href="#gheader268"><h4><p>Methods</p></h4></a></li><li><a class="nav-link" href="#gheader269"><h3><p><code>NodeMetaRef</code></p></h3></a></li><li><a class="nav-link" href="#gheader270"><h4><p>Methods</p></h4></a></li><li><a class="nav-link" href="#gheader271"><h3><p><code>NodeTimerRef</code></p></h3></a></li><li><a class="nav-link" href="#gheader272"><h4><p>Methods</p></h4></a></li><li><a class="nav-link" href="#gheader273"><h3><p><code>ObjectRef</code></p></h3></a></li><li><a class="nav-link" href="#gheader274"><h4><p>Methods</p></h4></a></li><li><a class="nav-link" href="#gheader275"><h5><p>LuaEntitySAO-only (no-op for other objects)</p></h5></a></li><li><a class="nav-link" href="#gheader276"><h5><p>Player-only (no-op for other objects)</p></h5></a></li><li><a class="nav-link" href="#gheader277"><h3><p><code>PcgRandom</code></p></h3></a></li><li><a class="nav-link" href="#gheader278"><h4><p>Methods</p></h4></a></li><li><a class="nav-link" href="#gheader279"><h3><p><code>PerlinNoise</code></p></h3></a></li><li><a class="nav-link" href="#gheader280"><h4><p>Methods</p></h4></a></li><li><a class="nav-link" href="#gheader281"><h3><p><code>PerlinNoiseMap</code></p></h3></a></li><li><a class="nav-link" href="#gheader282"><h4><p>Methods</p></h4></a></li><li><a class="nav-link" href="#gheader283"><h3><p><code>PlayerMetaRef</code></p></h3></a></li><li><a class="nav-link" href="#gheader284"><h4><p>Methods</p></h4></a></li><li><a class="nav-link" href="#gheader285"><h3><p><code>PseudoRandom</code></p></h3></a></li><li><a class="nav-link" href="#gheader286"><h4><p>Methods</p></h4></a></li><li><a class="nav-link" href="#gheader287"><h3><p><code>Raycast</code></p></h3></a></li><li><a class="nav-link" href="#gheader288"><h4><p>Methods</p></h4></a></li><li><a class="nav-link" href="#gheader289"><h3><p><code>SecureRandom</code></p></h3></a></li><li><a class="nav-link" href="#gheader290"><h4><p>Methods</p></h4></a></li><li><a class="nav-link" href="#gheader291"><h3><p><code>Settings</code></p></h3></a></li><li><a class="nav-link" href="#gheader292"><h4><p>Methods</p></h4></a></li><li><a class="nav-link" href="#gheader293"><h3><p><code>StorageRef</code></p></h3></a></li><li><a class="nav-link" href="#gheader294"><h4><p>Methods</p></h4></a></li><li><a class="nav-link" href="#gheader295"><h1><br></h1></a></li><li><a class="nav-link" href="#gheader296"><h2><p>Definition tables</p></h2></a></li><li><a class="nav-link" href="#gheader297"><h3><p>Object Properties</p></h3></a></li><li><a class="nav-link" href="#gheader298"><h3><p>Entity definition (<code>register_entity</code>)</p></h3></a></li><li><a class="nav-link" href="#gheader299"><h3><p>ABM (ActiveBlockModifier) definition (<code>register_abm</code>)</p></h3></a></li><li><a class="nav-link" href="#gheader300"><h3><p>LBM (LoadingBlockModifier) definition (<code>register_lbm</code>)</p></h3></a></li><li><a class="nav-link" href="#gheader301"><h3><p>Item definition (<code>register_node</code>, <code>register_craftitem</code>, <code>register_tool</code>)</p></h3></a></li><li><a class="nav-link" href="#gheader302"><h3><p>Tile definition</p></h3></a></li><li><a class="nav-link" href="#gheader303"><h3><p>Tile animation definition</p></h3></a></li><li><a class="nav-link" href="#gheader304"><h3><p>Node definition (<code>register_node</code>)</p></h3></a></li><li><a class="nav-link" href="#gheader305"><h3><p>Recipe for <code>register_craft</code> (shaped)</p></h3></a></li><li><a class="nav-link" href="#gheader306"><h3><p>Recipe for <code>register_craft</code> (shapeless)</p></h3></a></li><li><a class="nav-link" href="#gheader307"><h3><p>Recipe for <code>register_craft</code> (tool repair)</p></h3></a></li><li><a class="nav-link" href="#gheader308"><h3><p>Recipe for <code>register_craft</code> (cooking)</p></h3></a></li><li><a class="nav-link" href="#gheader309"><h3><p>Recipe for <code>register_craft</code> (furnace fuel)</p></h3></a></li><li><a class="nav-link" href="#gheader310"><h3><p>Ore definition (<code>register_ore</code>)</p></h3></a></li><li><a class="nav-link" href="#gheader311"><h3><p>Biome definition (<code>register_biome</code>)</p></h3></a></li><li><a class="nav-link" href="#gheader312"><h3><p>Decoration definition (<code>register_decoration</code>)</p></h3></a></li><li><a class="nav-link" href="#gheader313"><h3><p>Chat command definition (<code>register_chatcommand</code>)</p></h3></a></li><li><a class="nav-link" href="#gheader314"><h3><p>Detached inventory callbacks</p></h3></a></li><li><a class="nav-link" href="#gheader315"><h3><p>HUD Definition (<code>hud_add</code>, <code>hud_get</code>)</p></h3></a></li><li><a class="nav-link" href="#gheader316"><h3><p>Particle definition (<code>add_particle</code>)</p></h3></a></li><li><a class="nav-link" href="#gheader317"><h1><br></h1></a></li><li><a class="nav-link" href="#gheader318"><h3><p><code>ParticleSpawner</code> definition (<code>add_particlespawner</code>)</p></h3></a></li><li><a class="nav-link" href="#gheader319"><h3><p><code>HTTPRequest</code> definition (<code>HTTPApiTable.fetch_async</code>, <code>HTTPApiTable.fetch_async</code>)</p></h3></a></li><li><a class="nav-link" href="#gheader320"><h3><p><code>HTTPRequestResult</code> definition (<code>HTTPApiTable.fetch</code> callback, <code>HTTPApiTable.fetch_async_get</code>)</p></h3></a></li><li><a class="nav-link" href="#gheader321"><h3><p>Authentication handler definition</p></h3></a></li>
                    <!--Python script places stuff here-->
                </ul>
            </nav>
        </div>

        <div class="jumbotron" style="background: url('background.png') no-repeat center center fixed;background-size: 100% 100%;background-repeat: no-repeat;image-rendering:optimizeSpeed">
            <div class="container">
                <div class="row">
                    <div class="col-lg">
                        <h1 id="gheader1"><p>Minetest Lua Modding API Reference</p></h1><br><ul><li><p>More information at <a href="http://www.minetest.net/">http://www.minetest.net/</a></p></li><li><p>Developer Wiki: <a href="http://dev.minetest.net/">http://dev.minetest.net/</a></p></li></ul><br><h2 id="gheader2"><p>Introduction</p></h2><br><p>Content and functionality can be added to Minetest using Lua scripting</p><p>in run-time loaded mods.</p><br><p>A mod is a self-contained bunch of scripts, textures and other related</p><p>things, which is loaded by and interfaces with Minetest.</p><br><p>Mods are contained and ran solely on the server side. Definitions and media</p><p>files are automatically transferred to the client.</p><br><p>If you see a deficiency in the API, feel free to attempt to add the</p><p>functionality in the engine and API, and to document it here.</p><br><h2 id="gheader3"><p>Programming in Lua</p></h2><br><p>If you have any difficulty in understanding this, please read</p><p><a href="http://www.lua.org/pil/">Programming in Lua</a></p><br><h2 id="gheader4"><p>Startup</p></h2><br><p>Mods are loaded during server startup from the mod load paths by running</p><p>the <code>init.lua</code> scripts in a shared environment.</p><br><h2 id="gheader5"><p>Paths</p></h2><br><ul><li><p><code>RUN_IN_PLACE=1</code> (Windows release, local build)</p></li><ul><li><p> <code>$path_user</code>:</p></li><ul><li><p>Linux: <code>&lt;build directory&gt;</code></p></li><li><p>Windows: <code>&lt;build directory&gt;</code></p></li></ul><li><p><code>$path_share</code></p></li><ul><li><p>Linux: <code>&lt;build directory&gt;</code></p></li><li><p>Windows:  <code>&lt;build directory&gt;</code></p></li></ul></ul><li><p><code>RUN_IN_PLACE=0</code>: (Linux release)</p></li><ul><li><p><code>$path_share</code></p></li><ul><li><p>Linux: <code>/usr/share/minetest</code></p></li><li><p>Windows: <code>&lt;install directory&gt;/minetest-0.4.x</code></p></li></ul><li><p><code>$path_user</code>:</p></li><ul><li><p>Linux: <code>$HOME/.minetest</code></p></li><li><p>Windows: <code>C:/users/&lt;user&gt;/AppData/minetest</code> (maybe)</p></li></ul></ul></ul><br><h2 id="gheader6"><p>Games</p></h2><br><p>Games are looked up from:</p><br><ul><li><p><code>$path_share/games/gameid/</code></p></li><li><p><code>$path_user/games/gameid/</code></p></li></ul><br><p>Where <code>gameid</code> is unique to each game.</p><br><p>The game directory can contain the following files:</p><br><ul><li><p><code>game.conf</code>, with the following keys:</p></li><ul><li><p><code>name</code> - required, human readable name  e.g. <code>name = Minetest</code></p></li><li><p><code>description</code> - Short description to be shown in the content tab</p></li><li><p><code>disallowed_mapgens = &lt;comma-separated mapgens&gt;</code></p></li><p>      e.g. <code>disallowed_mapgens = v5,v6,flat</code></p><p>      These mapgens are removed from the list of mapgens for the game.</p></ul><li><p><code>minetest.conf</code>:</p></li><p>  Used to set default settings when running this game.</p><li><p><code>settingtypes.txt</code>:</p></li><p>  In the same format as the one in builtin.</p><p>  This settingtypes.txt will be parsed by the menu and the settings will be</p><p>  displayed in the &quot;Games&quot; category in the advanced settings tab.</p><li><p>If the game contains a folder called <code>textures</code> the server will load it as a</p></li><p>  texturepack, overriding mod textures.</p><p>  Any server texturepack will override mod textures and the game texturepack.</p></ul><br><h3 id="gheader7"><p>Menu images</p></h3><br><p>Games can provide custom main menu images. They are put inside a <code>menu</code></p><p>directory inside the game directory.</p><br><p>The images are named <code>$identifier.png</code>, where <code>$identifier</code> is one of</p><p><code>overlay</code>, <code>background</code>, <code>footer</code>, <code>header</code>.</p><p>If you want to specify multiple images for one identifier, add additional</p><p>images named like <code>$identifier.$n.png</code>, with an ascending number $n starting</p><p>with 1, and a random image will be chosen from the provided ones.</p><br><h2 id="gheader8"><p>Mod load path</p></h2><br><p>Generic:</p><br><ul><li><p><code>$path_share/games/gameid/mods/</code></p></li><li><p><code>$path_share/mods/</code></p></li><li><p><code>$path_user/games/gameid/mods/</code></p></li><li><p><code>$path_user/mods/</code> (User-installed mods)</p></li><li><p><code>$worldpath/worldmods/</code></p></li></ul><br><p>In a run-in-place version (e.g. the distributed windows version):</p><br><ul><li><p><code>minetest-0.4.x/games/gameid/mods/</code></p></li><li><p><code>minetest-0.4.x/mods/</code> (User-installed mods)</p></li><li><p><code>minetest-0.4.x/worlds/worldname/worldmods/</code></p></li></ul><br><p>On an installed version on Linux:</p><br><ul><li><p><code>/usr/share/minetest/games/gameid/mods/</code></p></li><li><p><code>$HOME/.minetest/mods/</code> (User-installed mods)</p></li><li><p><code>$HOME/.minetest/worlds/worldname/worldmods</code></p></li></ul><br><h2 id="gheader9"><p>Mod load path for world-specific games</p></h2><br><p>It is possible to include a game in a world; in this case, no mods or</p><p>games are loaded or checked from anywhere else.</p><br><p>This is useful for e.g. adventure worlds.</p><br><p>This happens if the following directory exists:</p><br><pre><code>$world/game/
</code></pre><br><p>Mods should be then be placed in:</p><br><pre><code>$world/game/mods/
</code></pre><br><h2 id="gheader10"><p>Modpack support</p></h2><br><p>Mods can be put in a subdirectory, if the parent directory, which otherwise</p><p>should be a mod, contains a file named <code>modpack.txt</code>. This file shall be</p><p>empty, except for lines starting with <code>#</code>, which are comments.</p><br><h2 id="gheader11"><p>Mod directory structure</p></h2><br><br><pre><code>mods
|-- modname
|   |-- mod.conf
|   |-- screenshot.png
|   |-- settingtypes.txt
|   |-- init.lua
|   |-- models
|   |-- textures
|   |   |-- modname_stuff.png
|   |   `-- modname_something_else.png
|   |-- sounds
|   |-- media
|   |-- locale
|   `-- &lt;custom data&gt;
`-- another
</code></pre><br><h3 id="gheader12"><p>modname</p></h3><p>The location of this directory can be fetched by using</p><p><code>minetest.get_modpath(modname)</code>.</p><br><h3 id="gheader13"><p>mod.conf</p></h3><p>A key-value store of mod details.</p><br><ul><li><p><code>name</code> - the mod name. Allows Minetest to determine the mod name even if the</p></li><p>           folder is wrongly named.</p><li><p><code>description</code> - Description of mod to be shown in the Mods tab of the mainmenu.</p></li><li><p><code>depends</code> - A comma separated list of dependencies. These are mods that must</p></li><p>              be loaded before this mod.</p><li><p><code>optional_depends</code> - A comma separated list of optional dependencies.</p></li><p>                       Like a dependency, but no error if the mod doesn&#x27;t exist.</p></ul><br><p>Note: to support 0.4.x, please also provide depends.txt.</p><br><h3 id="gheader14"><p><code>screenshot.png</code></p></h3><p>A screenshot shown in the mod manager within the main menu. It should</p><p>have an aspect ratio of 3:2 and a minimum size of 300200 pixels.</p><br><h3 id="gheader15"><p><code>depends.txt</code></p></h3><p><b>Deprecated:</b> you should use mod.conf instead.</p><br><p>This file is used if there are no dependencies in mod.conf.</p><br><p>List of mods that have to be loaded before loading this mod.</p><br><p>A single line contains a single modname.</p><br><p>Optional dependencies can be defined by appending a question mark</p><p>to a single modname. This means that if the specified mod</p><p>is missing, it does not prevent this mod from being loaded.</p><br><h3 id="gheader16"><p><code>description.txt</code></p></h3><p><b>Deprecated:</b> you should use mod.conf instead.</p><br><p>This file is used if there is no description in mod.conf.</p><br><p>A file containing a description to be shown in the Mods tab of the mainmenu.</p><br><h3 id="gheader17"><p><code>settingtypes.txt</code></p></h3><p>A file in the same format as the one in builtin. It will be parsed by the</p><p>settings menu and the settings will be displayed in the &quot;Mods&quot; category.</p><br><h3 id="gheader18"><p><code>init.lua</code></p></h3><p>The main Lua script. Running this script should register everything it</p><p>wants to register. Subsequent execution depends on minetest calling the</p><p>registered callbacks.</p><br><p><code>minetest.settings</code> can be used to read custom or existing settings at load</p><p>time, if necessary. (See <code>Settings</code>)</p><br><h3 id="gheader19"><p><code>models</code></p></h3><p>Models for entities or meshnodes.</p><br><h3 id="gheader20"><p><code>textures</code>, <code>sounds</code>, <code>media</code></p></h3><p>Media files (textures, sounds, whatever) that will be transferred to the</p><p>client and will be available for use by the mod.</p><br><h3 id="gheader21"><p><code>locale</code></p></h3><p>Translation files for the clients. (See <code>Translations</code>)</p><br><h2 id="gheader22"><p>Naming convention for registered textual names</p></h2><br><p>Registered names should generally be in this format:</p><br><pre><code>`modname:&lt;whatever&gt;`
</code></pre><br><p><code>&lt;whatever&gt;</code> can have these characters:</p><br><pre><code>a-zA-Z0-9_
</code></pre><br><p>This is to prevent conflicting names from corrupting maps and is</p><p>enforced by the mod loader.</p><br><h3 id="gheader23"><p>Example</p></h3><p>In the mod <code>experimental</code>, there is the ideal item/node/entity name <code>tnt</code>.</p><p>So the name should be <code>experimental:tnt</code>.</p><br><p>Enforcement can be overridden by prefixing the name with <code>:</code>. This can</p><p>be used for overriding the registrations of some other mod.</p><br><p>Example: Any mod can redefine <code>experimental:tnt</code> by using the name</p><br><pre><code>:experimental:tnt
</code></pre><br><p>when registering it.</p><p>(also that mod is required to have <code>experimental</code> as a dependency)</p><br><p>The <code>:</code> prefix can also be used for maintaining backwards compatibility.</p><br><h2 id="gheader24"><p>Aliases</p></h2><br><p>Aliases can be added by using <code>minetest.register_alias(name, convert_to)</code> or</p><p><code>minetest.register_alias_force(name, convert_to)</code>.</p><br><p>This converts anything called <code>name</code> to <code>convert_to</code>.</p><br><p>The only difference between <code>minetest.register_alias</code> and</p><p><code>minetest.register_alias_force</code> is that if an item called <code>name</code> exists,</p><p><code>minetest.register_alias</code> will do nothing while</p><p><code>minetest.register_alias_force</code> will unregister it.</p><br><p>This can be used for maintaining backwards compatibility.</p><br><p>This can also set quick access names for things, e.g. if</p><p>you have an item called <code>epiclylongmodname:stuff</code>, you could do</p><br><pre><code>minetest.register_alias(&quot;stuff&quot;, &quot;epiclylongmodname:stuff&quot;)
</code></pre><br><p>and be able to use <code>/giveme stuff</code>.</p><br><h2 id="gheader25"><p>Mapgen aliases</p></h2><br><p>In a game, a certain number of these must be set to tell core mapgens which</p><p>of the game&#x27;s nodes are to be used by the core mapgens. For example:</p><br><pre><code>minetest.register_alias(&quot;mapgen_stone&quot;, &quot;default:stone&quot;)
</code></pre><br><h3 id="gheader26"><p>Aliases needed for all mapgens except Mapgen v6</p></h3><br><p>Base terrain:</p><br><p>&quot;mapgen_stone&quot;</p><p>&quot;mapgen_water_source&quot;</p><p>&quot;mapgen_river_water_source&quot;</p><br><p>Caves:</p><br><p>&quot;mapgen_lava_source&quot;</p><br><p>Dungeons:</p><br><p>Only needed for registered biomes where &#x27;node_stone&#x27; is stone:</p><p>&quot;mapgen_cobble&quot;</p><p>&quot;mapgen_stair_cobble&quot;</p><p>&quot;mapgen_mossycobble&quot;</p><p>Only needed for registered biomes where &#x27;node_stone&#x27; is desert stone:</p><p>&quot;mapgen_desert_stone&quot;</p><p>&quot;mapgen_stair_desert_stone&quot;</p><p>Only needed for registered biomes where &#x27;node_stone&#x27; is sandstone:</p><p>&quot;mapgen_sandstone&quot;</p><p>&quot;mapgen_sandstonebrick&quot;</p><p>&quot;mapgen_stair_sandstone_block&quot;</p><br><h3 id="gheader27"><p>Aliases needed for Mapgen v6</p></h3><br><p>Terrain and biomes:</p><br><p>&quot;mapgen_stone&quot;</p><p>&quot;mapgen_water_source&quot;</p><p>&quot;mapgen_lava_source&quot;</p><p>&quot;mapgen_dirt&quot;</p><p>&quot;mapgen_dirt_with_grass&quot;</p><p>&quot;mapgen_sand&quot;</p><p>&quot;mapgen_gravel&quot;</p><p>&quot;mapgen_desert_stone&quot;</p><p>&quot;mapgen_desert_sand&quot;</p><p>&quot;mapgen_dirt_with_snow&quot;</p><p>&quot;mapgen_snowblock&quot;</p><p>&quot;mapgen_snow&quot;</p><p>&quot;mapgen_ice&quot;</p><br><p>Flora:</p><br><p>&quot;mapgen_tree&quot;</p><p>&quot;mapgen_leaves&quot;</p><p>&quot;mapgen_apple&quot;</p><p>&quot;mapgen_jungletree&quot;</p><p>&quot;mapgen_jungleleaves&quot;</p><p>&quot;mapgen_junglegrass&quot;</p><p>&quot;mapgen_pine_tree&quot;</p><p>&quot;mapgen_pine_needles&quot;</p><br><p>Dungeons:</p><br><p>&quot;mapgen_cobble&quot;</p><p>&quot;mapgen_stair_cobble&quot;</p><p>&quot;mapgen_mossycobble&quot;</p><p>&quot;mapgen_stair_desert_stone&quot;</p><br><h2 id="gheader28"><p>Textures</p></h2><br><p>Mods should generally prefix their textures with <code>modname_</code>, e.g. given</p><p>the mod name <code>foomod</code>, a texture could be called:</p><br><pre><code>foomod_foothing.png
</code></pre><br><p>Textures are referred to by their complete name, or alternatively by</p><p>stripping out the file extension:</p><br><ul><li><p>e.g. <code>foomod_foothing.png</code></p></li><li><p>e.g. <code>foomod_foothing</code></p></li></ul><br><h2 id="gheader29"><p>Texture modifiers</p></h2><br><p>There are various texture modifiers that can be used</p><p>to generate textures on-the-fly.</p><br><h3 id="gheader30"><p>Texture overlaying</p></h3><p>Textures can be overlaid by putting a <code>^</code> between them.</p><br><p>Example:</p><br><pre><code>default_dirt.png^default_grass_side.png
</code></pre><br><p><code>default_grass_side.png</code> is overlaid over <code>default_dirt.png</code>.</p><p>The texture with the lower resolution will be automatically upscaled to</p><p>the higher resolution texture.</p><br><h3 id="gheader31"><p>Texture grouping</p></h3><p>Textures can be grouped together by enclosing them in <code>(</code> and <code>)</code>.</p><br><p>Example: <code>cobble.png^(thing1.png^thing2.png)</code></p><br><p>A texture for <code>thing1.png^thing2.png</code> is created and the resulting</p><p>texture is overlaid on top of <code>cobble.png</code>.</p><br><h3 id="gheader32"><p>Escaping</p></h3><p>Modifiers that accept texture names (e.g. <code>[combine</code>) accept escaping to allow</p><p>passing complex texture names as arguments. Escaping is done with backslash and</p><p>is required for <code>^</code> and <code>:</code>.</p><br><p>Example: <code>cobble.png^[lowpart:50:color.png\^[mask\:trans.png</code></p><br><p>The lower 50 percent of <code>color.png^[mask:trans.png</code> are overlaid</p><p>on top of <code>cobble.png</code>.</p><br><h3 id="gheader33"><p>Advanced texture modifiers</p></h3><br><h4 id="gheader34"><p>Crack</p></h4><ul><li><p><code>[crack:&lt;n&gt;:&lt;p&gt;</code></p></li><li><p><code>[cracko:&lt;n&gt;:&lt;p&gt;</code></p></li><li><p><code>[crack:&lt;t&gt;:&lt;n&gt;:&lt;p&gt;</code></p></li><li><p><code>[cracko:&lt;t&gt;:&lt;n&gt;:&lt;p&gt;</code></p></li></ul><br><p>Parameters:</p><ul><li><p><code>&lt;t&gt;</code> = tile count (in each direction)</p></li><li><p><code>&lt;n&gt;</code> = animation frame count</p></li><li><p><code>&lt;p&gt;</code> = current animation frame</p></li></ul><br><p>Draw a step of the crack animation on the texture.</p><p><code>crack</code> draws it normally, while <code>cracko</code> lays it over, keeping transparent</p><p>pixels intact.</p><br><p>Example:</p><br><pre><code>default_cobble.png^[crack:10:1
</code></pre><br><h4 id="gheader35"><p><code>[combine:&lt;w&gt;x&lt;h&gt;:&lt;x1&gt;,&lt;y1&gt;=&lt;file1&gt;:&lt;x2&gt;,&lt;y2&gt;=&lt;file2&gt;:...</code></p></h4><ul><li><p><code>&lt;w&gt;</code> = width</p></li><li><p><code>&lt;h&gt;</code> = height</p></li><li><p><code>&lt;x&gt;</code> = x position</p></li><li><p><code>&lt;y&gt;</code> = y position</p></li><li><p><code>&lt;file&gt;</code> = texture to combine</p></li></ul><br><p>Creates a texture of size <code>&lt;w&gt;</code> times <code>&lt;h&gt;</code> and blits the listed files to their</p><p>specified coordinates.</p><br><p>Example:</p><br><pre><code>[combine:16x32:0,0=default_cobble.png:0,16=default_wood.png
</code></pre><br><h4 id="gheader36"><p><code>[resize:&lt;w&gt;x&lt;h&gt;</code></p></h4><p>Resizes the texture to the given dimensions.</p><br><p>Example:</p><br><pre><code>default_sandstone.png^[resize:16x16
</code></pre><br><h4 id="gheader37"><p><code>[opacity:&lt;r&gt;</code></p></h4><p>Makes the base image transparent according to the given ratio.</p><br><p><code>r</code> must be between 0 and 255.</p><p>0 means totally transparent. 255 means totally opaque.</p><br><p>Example:</p><br><pre><code>default_sandstone.png^[opacity:127
</code></pre><br><h4 id="gheader38"><p><code>[invert:&lt;mode&gt;</code></p></h4><p>Inverts the given channels of the base image.</p><p>Mode may contain the characters &quot;r&quot;, &quot;g&quot;, &quot;b&quot;, &quot;a&quot;.</p><p>Only the channels that are mentioned in the mode string will be inverted.</p><br><p>Example:</p><br><pre><code>default_apple.png^[invert:rgb
</code></pre><br><h4 id="gheader39"><p><code>[brighten</code></p></h4><p>Brightens the texture.</p><br><p>Example:</p><br><pre><code>tnt_tnt_side.png^[brighten
</code></pre><br><h4 id="gheader40"><p><code>[noalpha</code></p></h4><p>Makes the texture completely opaque.</p><br><p>Example:</p><br><pre><code>default_leaves.png^[noalpha
</code></pre><br><h4 id="gheader41"><p><code>[makealpha:&lt;r&gt;,&lt;g&gt;,&lt;b&gt;</code></p></h4><p>Convert one color to transparency.</p><br><p>Example:</p><br><pre><code>default_cobble.png^[makealpha:128,128,128
</code></pre><br><h4 id="gheader42"><p><code>[transform&lt;t&gt;</code></p></h4><ul><li><p><code>&lt;t&gt;</code> = transformation(s) to apply</p></li></ul><br><p>Rotates and/or flips the image.</p><br><p><code>&lt;t&gt;</code> can be a number (between 0 and 7) or a transform name.</p><p>Rotations are counter-clockwise.</p><br><pre><code>0  I      identity
1  R90    rotate by 90 degrees
2  R180   rotate by 180 degrees
3  R270   rotate by 270 degrees
4  FX     flip X
5  FXR90  flip X then rotate by 90 degrees
6  FY     flip Y
7  FYR90  flip Y then rotate by 90 degrees
</code></pre><br><p>Example:</p><br><pre><code>default_stone.png^[transformFXR90
</code></pre><br><h4 id="gheader43"><p><code>[inventorycube{&lt;top&gt;{&lt;left&gt;{&lt;right&gt;</code></p></h4><p>Escaping does not apply here and <code>^</code> is replaced by <code>&amp;</code> in texture names</p><p>instead.</p><br><p>Create an inventory cube texture using the side textures.</p><br><p>Example:</p><br><pre><code>[inventorycube{grass.png{dirt.png&amp;grass_side.png{dirt.png&amp;grass_side.png
</code></pre><br><p>Creates an inventorycube with <code>grass.png</code>, <code>dirt.png^grass_side.png</code> and</p><p><code>dirt.png^grass_side.png</code> textures</p><br><h4 id="gheader44"><p><code>[lowpart:&lt;percent&gt;:&lt;file&gt;</code></p></h4><p>Blit the lower <code>&lt;percent&gt;</code>% part of <code>&lt;file&gt;</code> on the texture.</p><br><p>Example:</p><br><pre><code>base.png^[lowpart:25:overlay.png
</code></pre><br><h4 id="gheader45"><p><code>[verticalframe:&lt;t&gt;:&lt;n&gt;</code></p></h4><ul><li><p><code>&lt;t&gt;</code> = animation frame count</p></li><li><p><code>&lt;n&gt;</code> = current animation frame</p></li></ul><br><p>Crops the texture to a frame of a vertical animation.</p><br><p>Example:</p><br><pre><code>default_torch_animated.png^[verticalframe:16:8
</code></pre><br><h4 id="gheader46"><p><code>[mask:&lt;file&gt;</code></p></h4><p>Apply a mask to the base image.</p><br><p>The mask is applied using binary AND.</p><br><h4 id="gheader47"><p><code>[sheet:&lt;w&gt;x&lt;h&gt;:&lt;x&gt;,&lt;y&gt;</code></p></h4><p>Retrieves a tile at position x,y from the base image</p><p>which it assumes to be a tilesheet with dimensions w,h.</p><h1 id="gheader48"><br></h1><br><h4 id="gheader49"><p><code>[colorize:&lt;color&gt;:&lt;ratio&gt;</code></p></h4><p>Colorize the textures with the given color.</p><p><code>&lt;color&gt;</code> is specified as a <code>ColorString</code>.</p><p><code>&lt;ratio&gt;</code> is an int ranging from 0 to 255 or the word &quot;<code>alpha</code>&quot;.  If</p><p>it is an int, then it specifies how far to interpolate between the</p><p>colors where 0 is only the texture color and 255 is only <code>&lt;color&gt;</code>. If</p><p>omitted, the alpha of <code>&lt;color&gt;</code> will be used as the ratio.  If it is</p><p>the word &quot;<code>alpha</code>&quot;, then each texture pixel will contain the RGB of</p><p><code>&lt;color&gt;</code> and the alpha of <code>&lt;color&gt;</code> multiplied by the alpha of the</p><p>texture pixel.</p><br><h4 id="gheader50"><p><code>[multiply:&lt;color&gt;</code></p></h4><p>Multiplies texture colors with the given color.</p><p><code>&lt;color&gt;</code> is specified as a <code>ColorString</code>.</p><p>Result is more like what you&#x27;d expect if you put a color on top of another</p><p>color. Meaning white surfaces get a lot of your new color while black parts</p><p>don&#x27;t change very much.</p><br><h2 id="gheader51"><p>Hardware coloring</p></h2><br><p>The goal of hardware coloring is to simplify the creation of</p><p>colorful nodes. If your textures use the same pattern, and they only</p><p>differ in their color (like colored wool blocks), you can use hardware</p><p>coloring instead of creating and managing many texture files.</p><p>All of these methods use color multiplication (so a white-black texture</p><p>with red coloring will result in red-black color).</p><br><h3 id="gheader52"><p>Static coloring</p></h3><p>This method is useful if you wish to create nodes/items with</p><p>the same texture, in different colors, each in a new node/item definition.</p><br><h4 id="gheader53"><p>Global color</p></h4><p>When you register an item or node, set its <code>color</code> field (which accepts a</p><p><code>ColorSpec</code>) to the desired color.</p><br><p>An <code>ItemStack</code>s static color can be overwritten by the <code>color</code> metadata</p><p>field. If you set that field to a <code>ColorString</code>, that color will be used.</p><br><h4 id="gheader54"><p>Tile color</p></h4><p>Each tile may have an individual static color, which overwrites every</p><p>other coloring methods. To disable the coloring of a face,</p><p>set its color to white (because multiplying with white does nothing).</p><p>You can set the <code>color</code> property of the tiles in the node&#x27;s definition</p><p>if the tile is in table format.</p><br><h3 id="gheader55"><p>Palettes</p></h3><p>For nodes and items which can have many colors, a palette is more</p><p>suitable. A palette is a texture, which can contain up to 256 pixels.</p><p>Each pixel is one possible color for the node/item.</p><p>You can register one node/item, which can have up to 256 colors.</p><br><h4 id="gheader56"><p>Palette indexing</p></h4><p>When using palettes, you always provide a pixel index for the given</p><p>node or <code>ItemStack</code>. The palette is read from left to right and from</p><p>top to bottom. If the palette has less than 256 pixels, then it is</p><p>stretched to contain exactly 256 pixels (after arranging the pixels</p><p>to one line). The indexing starts from 0.</p><br><p>Examples:</p><br><ul><li><p>16x16 palette, index = 0: the top left corner</p></li><li><p>16x16 palette, index = 4: the fifth pixel in the first row</p></li><li><p>16x16 palette, index = 16: the pixel below the top left corner</p></li><li><p>16x16 palette, index = 255: the bottom right corner</p></li><li><p>2 (width)x4 (height) palette, index=31: the top left corner.</p></li><p>  The palette has 8 pixels, so each pixel is stretched to 32 pixels,</p><p>  to ensure the total 256 pixels.</p><li><p>2x4 palette, index=32: the top right corner</p></li><li><p>2x4 palette, index=63: the top right corner</p></li><li><p>2x4 palette, index=64: the pixel below the top left corner</p></li></ul><br><h4 id="gheader57"><p>Using palettes with items</p></h4><p>When registering an item, set the item definition&#x27;s <code>palette</code> field to</p><p>a texture. You can also use texture modifiers.</p><br><p>The <code>ItemStack</code>&#x27;s color depends on the <code>palette_index</code> field of the</p><p>stack&#x27;s metadata. <code>palette_index</code> is an integer, which specifies the</p><p>index of the pixel to use.</p><br><h4 id="gheader58"><p>Linking palettes with nodes</p></h4><p>When registering a node, set the item definition&#x27;s <code>palette</code> field to</p><p>a texture. You can also use texture modifiers.</p><p>The node&#x27;s color depends on its <code>param2</code>, so you also must set an</p><p>appropriate <code>paramtype2</code>:</p><br><ul><li><p><code>paramtype2 = &quot;color&quot;</code> for nodes which use their full <code>param2</code> for</p></li><p>  palette indexing. These nodes can have 256 different colors.</p><p>  The palette should contain 256 pixels.</p><li><p><code>paramtype2 = &quot;colorwallmounted&quot;</code> for nodes which use the first</p></li><p>  five bits (most significant) of <code>param2</code> for palette indexing.</p><p>  The remaining three bits are describing rotation, as in <code>wallmounted</code></p><p>  paramtype2. Division by 8 yields the palette index (without stretching the</p><p>  palette). These nodes can have 32 different colors, and the palette</p><p>  should contain 32 pixels.</p><p>  Examples:</p><ul><li><p><code>param2 = 17</code> is 2 * 8 + 1, so the rotation is 1 and the third (= 2 + 1)</p></li><p>      pixel will be picked from the palette.</p><li><p><code>param2 = 35</code> is 4 * 8 + 3, so the rotation is 3 and the fifth (= 4 + 1)</p></li><p>      pixel will be picked from the palette.</p></ul><li><p><code>paramtype2 = &quot;colorfacedir&quot;</code> for nodes which use the first</p></li><p>  three bits of <code>param2</code> for palette indexing. The remaining</p><p>  five bits are describing rotation, as in <code>facedir</code> paramtype2.</p><p>  Division by 32 yields the palette index (without stretching the</p><p>  palette). These nodes can have 8 different colors, and the</p><p>  palette should contain 8 pixels.</p><p>  Examples:</p><ul><li><p><code>param2 = 17</code> is 0 * 32 + 17, so the rotation is 17 and the</p></li><p>      first (= 0 + 1) pixel will be picked from the palette.</p><li><p><code>param2 = 35</code> is 1 * 32 + 3, so the rotation is 3 and the</p></li><p>      second (= 1 + 1) pixel will be picked from the palette.</p></ul></ul><br><p>To colorize a node on the map, set its <code>param2</code> value (according</p><p>to the node&#x27;s paramtype2).</p><br><h3 id="gheader59"><p>Conversion between nodes in the inventory and the on the map</p></h3><p>Static coloring is the same for both cases, there is no need</p><p>for conversion.</p><br><p>If the <code>ItemStack</code>&#x27;s metadata contains the <code>color</code> field, it will be</p><p>lost on placement, because nodes on the map can only use palettes.</p><br><p>If the <code>ItemStack</code>&#x27;s metadata contains the <code>palette_index</code> field, it is</p><p>automatically transferred between node and item forms by the engine,</p><p>when a player digs or places a colored node.</p><p>You can disable this feature by setting the <code>drop</code> field of the node</p><p>to itself (without metadata).</p><p>To transfer the color to a special drop, you need a drop table.</p><br><p>Example:</p><br><pre><code>minetest.register_node(&quot;mod:stone&quot;, {
    description = &quot;Stone&quot;,
    tiles = {&quot;default_stone.png&quot;},
    paramtype2 = &quot;color&quot;,
    palette = &quot;palette.png&quot;,
    drop = {
        items = {
            -- assume that mod:cobblestone also has the same palette
            {items = {&quot;mod:cobblestone&quot;}, inherit_color = true },
        }
    }
})
</code></pre><br><h3 id="gheader60"><p>Colored items in craft recipes</p></h3><p>Craft recipes only support item strings, but fortunately item strings</p><p>can also contain metadata. Example craft recipe registration:</p><br><pre><code>minetest.register_craft({
    output = minetest.itemstring_with_palette(&quot;wool:block&quot;, 3),
    type = &quot;shapeless&quot;,
    recipe = {
        &quot;wool:block&quot;,
        &quot;dye:red&quot;,
    },
})
</code></pre><br><p>To set the <code>color</code> field, you can use <code>minetest.itemstring_with_color</code>.</p><br><p>Metadata field filtering in the <code>recipe</code> field are not supported yet,</p><p>so the craft output is independent of the color of the ingredients.</p><br><h2 id="gheader61"><p>Soft texture overlay</p></h2><br><p>Sometimes hardware coloring is not enough, because it affects the</p><p>whole tile. Soft texture overlays were added to Minetest to allow</p><p>the dynamic coloring of only specific parts of the node&#x27;s texture.</p><p>For example a grass block may have colored grass, while keeping the</p><p>dirt brown.</p><br><p>These overlays are &#x27;soft&#x27;, because unlike texture modifiers, the layers</p><p>are not merged in the memory, but they are simply drawn on top of each</p><p>other. This allows different hardware coloring, but also means that</p><p>tiles with overlays are drawn slower. Using too much overlays might</p><p>cause FPS loss.</p><br><p>For inventory and wield images you can specify overlays which</p><p>hardware coloring does not modify. You have to set <code>inventory_overlay</code></p><p>and <code>wield_overlay</code> fields to an image name.</p><br><p>To define a node overlay, simply set the <code>overlay_tiles</code> field of the node</p><p>definition. These tiles are defined in the same way as plain tiles:</p><p>they can have a texture name, color etc.</p><p>To skip one face, set that overlay tile to an empty string.</p><br><p>Example (colored grass block):</p><br><pre><code>minetest.register_node(&quot;default:dirt_with_grass&quot;, {
    description = &quot;Dirt with Grass&quot;,
    -- Regular tiles, as usual
    -- The dirt tile disables palette coloring
    tiles = {{name = &quot;default_grass.png&quot;},
        {name = &quot;default_dirt.png&quot;, color = &quot;white&quot;}},
    -- Overlay tiles: define them in the same style
    -- The top and bottom tile does not have overlay
    overlay_tiles = {&quot;&quot;, &quot;&quot;,
        {name = &quot;default_grass_side.png&quot;, tileable_vertical = false}},
    -- Global color, used in inventory
    color = &quot;green&quot;,
    -- Palette in the world
    paramtype2 = &quot;color&quot;,
    palette = &quot;default_foilage.png&quot;,
})
</code></pre><br><h2 id="gheader62"><p>Sounds</p></h2><br><p>Only Ogg Vorbis files are supported.</p><br><p>For positional playing of sounds, only single-channel (mono) files are</p><p>supported. Otherwise OpenAL will play them non-positionally.</p><br><p>Mods should generally prefix their sounds with <code>modname_</code>, e.g. given</p><p>the mod name &quot;<code>foomod</code>&quot;, a sound could be called:</p><br><pre><code>foomod_foosound.ogg
</code></pre><br><p>Sounds are referred to by their name with a dot, a single digit and the</p><p>file extension stripped out. When a sound is played, the actual sound file</p><p>is chosen randomly from the matching sounds.</p><br><p>When playing the sound <code>foomod_foosound</code>, the sound is chosen randomly</p><p>from the available ones of the following files:</p><br><ul><li><p><code>foomod_foosound.ogg</code></p></li><li><p><code>foomod_foosound.0.ogg</code></p></li><li><p><code>foomod_foosound.1.ogg</code></p></li><li><p>(...)</p></li><li><p><code>foomod_foosound.9.ogg</code></p></li></ul><br><p>Examples of sound parameter tables:</p><br><pre><code>-- Play locationless on all clients
{
    gain = 1.0, -- default
    fade = 0.0, -- default, change to a value &gt; 0 to fade the sound in
    pitch = 1.0, -- default
}
-- Play locationless to one player
{
    to_player = name,
    gain = 1.0, -- default
    fade = 0.0, -- default, change to a value &gt; 0 to fade the sound in
    pitch = 1.0, -- default
}
-- Play locationless to one player, looped
{
    to_player = name,
    gain = 1.0, -- default
    loop = true,
}
-- Play in a location
{
    pos = {x = 1, y = 2, z = 3},
    gain = 1.0, -- default
    max_hear_distance = 32, -- default, uses an euclidean metric
}
-- Play connected to an object, looped
{
    object = &lt;an ObjectRef&gt;,
    gain = 1.0, -- default
    max_hear_distance = 32, -- default, uses an euclidean metric
    loop = true,
}
</code></pre><br><p>Looped sounds must either be connected to an object or played locationless to</p><p>one player using <code>to_player = name,</code></p><br><h3 id="gheader63"><p><code>SimpleSoundSpec</code></p></h3><ul><li><p>e.g. <code>&quot;&quot;</code></p></li><li><p>e.g. <code>&quot;default_place_node&quot;</code></p></li><li><p>e.g. <code>{}</code></p></li><li><p>e.g. <code>{name = &quot;default_place_node&quot;}</code></p></li><li><p>e.g. <code>{name = &quot;default_place_node&quot;, gain = 1.0}</code></p></li><li><p>e.g. <code>{name = &quot;default_place_node&quot;, gain = 1.0, pitch = 1.0}</code></p></li></ul><br><h2 id="gheader64"><p>Registered definitions of stuff</p></h2><br><p>Anything added using certain <code>minetest.register_*</code> functions get added to</p><p>the global <code>minetest.registered_*</code> tables.</p><br><ul><li><p><code>minetest.register_entity(name, prototype table)</code></p></li><ul><li><p>added to <code>minetest.registered_entities[name]</code></p></li></ul></ul><br><ul><li><p><code>minetest.register_node(name, node definition)</code></p></li><ul><li><p>added to <code>minetest.registered_items[name]</code></p></li><li><p>added to <code>minetest.registered_nodes[name]</code></p></li></ul></ul><br><ul><li><p><code>minetest.register_tool(name, item definition)</code></p></li><ul><li><p>added to <code>minetest.registered_items[name]</code></p></li></ul></ul><br><ul><li><p><code>minetest.register_craftitem(name, item definition)</code></p></li><ul><li><p>added to <code>minetest.registered_items[name]</code></p></li></ul></ul><br><ul><li><p><code>minetest.unregister_item(name)</code></p></li><ul><li><p>Unregisters the item name from engine, and deletes the entry with key</p></li><li><p><code>name</code> from <code>minetest.registered_items</code> and from the associated item</p></li><li><p>table according to its nature: <code>minetest.registered_nodes[]</code> etc</p></li></ul></ul><br><ul><li><p><code>minetest.register_biome(biome definition)</code></p></li><ul><li><p>returns an integer uniquely identifying the registered biome</p></li><li><p>added to <code>minetest.registered_biome</code> with the key of <code>biome.name</code></p></li><li><p>if <code>biome.name</code> is nil, the key is the returned ID</p></li></ul></ul><br><ul><li><p><code>minetest.unregister_biome(name)</code></p></li><ul><li><p>Unregisters the biome name from engine, and deletes the entry with key</p></li><li><p><code>name</code> from <code>minetest.registered_biome</code></p></li></ul></ul><br><ul><li><p><code>minetest.register_ore(ore definition)</code></p></li><ul><li><p>returns an integer uniquely identifying the registered ore</p></li><li><p>added to <code>minetest.registered_ores</code> with the key of <code>ore.name</code></p></li><li><p>if <code>ore.name</code> is nil, the key is the returned ID</p></li></ul></ul><br><ul><li><p><code>minetest.register_decoration(decoration definition)</code></p></li><ul><li><p>returns an integer uniquely identifying the registered decoration</p></li><li><p>added to <code>minetest.registered_decorations</code> with the key of</p></li><p>      <code>decoration.name</code>.</p><li><p>if <code>decoration.name</code> is nil, the key is the returned ID</p></li></ul></ul><br><ul><li><p><code>minetest.register_schematic(schematic definition)</code></p></li><ul><li><p>returns an integer uniquely identifying the registered schematic</p></li><li><p>added to <code>minetest.registered_schematic</code> with the key of <code>schematic.name</code></p></li><li><p>if <code>schematic.name</code> is nil, the key is the returned ID</p></li><li><p>if the schematic is loaded from a file, schematic.name is set to the</p></li><p>      filename.</p><li><p>if the function is called when loading the mod, and schematic.name is a</p></li><p>      relative path, then the current mod path will be prepended to the</p><p>      schematic filename.</p></ul></ul><br><ul><li><p><code>minetest.clear_registered_biomes()</code></p></li><ul><li><p>clears all biomes currently registered</p></li></ul></ul><br><ul><li><p><code>minetest.clear_registered_ores()</code></p></li><ul><li><p>clears all ores currently registered</p></li></ul></ul><br><ul><li><p><code>minetest.clear_registered_decorations()</code></p></li><ul><li><p>clears all decorations currently registered</p></li></ul></ul><br><ul><li><p><code>minetest.clear_registered_schematics()</code></p></li><ul><li><p>clears all schematics currently registered</p></li></ul></ul><br><p>Note that in some cases you will stumble upon things that are not contained</p><p>in these tables (e.g. when a mod has been removed). Always check for</p><p>existence before trying to access the fields.</p><br><p>Example: If you want to check the drawtype of a node, you could do:</p><br><pre><code>local function get_nodedef_field(nodename, fieldname)
    if not minetest.registered_nodes[nodename] then
        return nil
    end
    return minetest.registered_nodes[nodename][fieldname]
end
local drawtype = get_nodedef_field(nodename, &quot;drawtype&quot;)
</code></pre><br><p>Example: <code>minetest.get_item_group(name, group)</code> has been implemented as:</p><br><pre><code>function minetest.get_item_group(name, group)
    if not minetest.registered_items[name] or not
            minetest.registered_items[name].groups[group] then
        return 0
    end
    return minetest.registered_items[name].groups[group]
end
</code></pre><br><h2 id="gheader65"><p>Nodes</p></h2><br><p>Nodes are the bulk data of the world: cubes and other things that take the</p><p>space of a cube. Huge amounts of them are handled efficiently, but they</p><p>are quite static.</p><br><p>The definition of a node is stored and can be accessed by name in</p><br><pre><code>minetest.registered_nodes[node.name]
</code></pre><br><p>See &quot;Registered definitions of stuff&quot;.</p><br><p>Nodes are passed by value between Lua and the engine.</p><p>They are represented by a table:</p><br><pre><code>{name=&quot;name&quot;, param1=num, param2=num}
</code></pre><br><p><code>param1</code> and <code>param2</code> are 8-bit integers ranging from 0 to 255. The engine uses</p><p>them for certain automated functions. If you don&#x27;t use these functions, you can</p><p>use them to store arbitrary values.</p><br><p>The functions of <code>param1</code> and <code>param2</code> are determined by certain fields in the</p><p>node definition:</p><br><p><code>param1</code> is reserved for the engine when <code>paramtype != &quot;none&quot;</code>:</p><br><pre><code>paramtype = &quot;light&quot;
^ The value stores light with and without sun in its upper and lower 4 bits
  respectively.
  Required by a light source node to enable spreading its light.
  Required by the following drawtypes as they determine their visual
  brightness from their internal light value:
    torchlike,
    signlike,
    firelike,
    fencelike,
    raillike,
    nodebox,
    mesh,
    plantlike,
    plantlike_rooted.
</code></pre><br><p><code>param2</code> is reserved for the engine when any of these are used:</p><br><pre><code>liquidtype == &quot;flowing&quot;
^ The level and some flags of the liquid is stored in param2
drawtype == &quot;flowingliquid&quot;
^ The drawn liquid level is read from param2
drawtype == &quot;torchlike&quot;
drawtype == &quot;signlike&quot;
paramtype2 == &quot;wallmounted&quot;
^ The rotation of the node is stored in param2. You can make this value
  by using minetest.dir_to_wallmounted().
paramtype2 == &quot;facedir&quot;
^ The rotation of the node is stored in param2. Furnaces and chests are
  rotated this way. Can be made by using minetest.dir_to_facedir().
  Values range 0 - 23
  facedir / 4 = axis direction:
  0 = y+    1 = z+    2 = z-    3 = x+    4 = x-    5 = y-
  facedir modulo 4 = rotation around that axis
paramtype2 == &quot;leveled&quot;
^ Only valid for &quot;nodebox&quot; with &#x27;type = &quot;leveled&quot;&#x27;, and &quot;plantlike_rooted&quot;.
  Leveled nodebox:
    The level of the top face of the nodebox is stored in param2.
    The other faces are defined by &#x27;fixed = {}&#x27; like &#x27;type = &quot;fixed&quot;&#x27;
    nodeboxes.
    The nodebox height is (param2 / 64) nodes.
    The maximum accepted value of param2 is 127.
  Rooted plantlike:
    The height of the &#x27;plantlike&#x27; section is stored in param2.
    The height is (param2 / 16) nodes.
paramtype2 == &quot;degrotate&quot;
^ Only valid for &quot;plantlike&quot;. The rotation of the node is stored in param2.
  Values range 0 - 179. The value stored in param2 is multiplied by two to
  get the actual rotation in degrees of the node.
paramtype2 == &quot;meshoptions&quot;
^ Only valid for &quot;plantlike&quot;. The value of param2 becomes a bitfield which
  can be used to change how the client draws plantlike nodes.
  Bits 0, 1 and 2 form a mesh selector.
  Currently the following meshes are choosable:
    0 = a &quot;x&quot; shaped plant (ordinary plant)
    1 = a &quot;+&quot; shaped plant (just rotated 45 degrees)
    2 = a &quot;*&quot; shaped plant with 3 faces instead of 2
    3 = a &quot;#&quot; shaped plant with 4 faces instead of 2
    4 = a &quot;#&quot; shaped plant with 4 faces that lean outwards
    5-7 are unused and reserved for future meshes.
  Bits 3 through 7 are optional flags that can be combined and give these
  effects:
    bit 3 (0x08) - Makes the plant slightly vary placement horizontally
    bit 4 (0x10) - Makes the plant mesh 1.4x larger
    bit 5 (0x20) - Moves each face randomly a small bit down (1/8 max)
    bits 6-7 are reserved for future use.
paramtype2 == &quot;color&quot;
^ `param2` tells which color is picked from the palette.
  The palette should have 256 pixels.
paramtype2 == &quot;colorfacedir&quot;
^ Same as `facedir`, but with colors.
  The first three bits of `param2` tells which color
  is picked from the palette.
  The palette should have 8 pixels.
paramtype2 == &quot;colorwallmounted&quot;
^ Same as `wallmounted`, but with colors.
  The first five bits of `param2` tells which color
  is picked from the palette.
  The palette should have 32 pixels.
paramtype2 == &quot;glasslikeliquidlevel&quot;
^ Only valid for &quot;glasslike_framed&quot; or &quot;glasslike_framed_optional&quot;
  drawtypes.
  param2 values 0-63 define 64 levels of internal liquid, 0 being empty and
  63 being full.
  Liquid texture is defined using `special_tiles = {&quot;modname_tilename.png&quot;},`
</code></pre><br><p>Nodes can also contain extra data. See &quot;Node Metadata&quot;.</p><br><h2 id="gheader66"><p>Node drawtypes</p></h2><br><p>There are a bunch of different looking node types.</p><br><p>Look for examples in <code>games/minimal</code> or <code>games/minetest_game</code>.</p><br><ul><li><p><code>normal</code></p></li><ul><li><p>A node-sized cube.</p></li></ul><li><p><code>airlike</code></p></li><ul><li><p>Invisible, uses no texture.</p></li></ul><li><p><code>liquid</code></p></li><ul><li><p>The cubic source node for a liquid.</p></li></ul><li><p><code>flowingliquid</code></p></li><ul><li><p>The flowing version of a liquid, appears with various heights and slopes.</p></li></ul><li><p><code>glasslike</code></p></li><ul><li><p>Often used for partially-transparent nodes.</p></li><li><p>Only external sides of textures are visible.</p></li></ul><li><p><code>glasslike_framed</code></p></li><ul><li><p>All face-connected nodes are drawn as one volume within a surrounding</p></li><p>      frame.</p><li><p>The frame appearence is generated from the edges of the first texture</p></li><p>      specified in <code>tiles</code>. The width of the edges used are 1/16th of texture</p><p>      size: 1 pixel for 16x16, 2 pixels for 32x32 etc.</p><li><p>The glass &#x27;shine&#x27; (or other desired detail) on each node face is supplied</p></li><p>      by the second texture specified in <code>tiles</code>.</p></ul><li><p><code>glasslike_framed_optional</code></p></li><ul><li><p>This switches between the above 2 drawtypes according to the menu setting</p></li><p>      &#x27;Connected Glass&#x27;.</p></ul><li><p><code>allfaces</code></p></li><ul><li><p>Often used for partially-transparent nodes.</p></li><li><p>External and internal sides of textures are visible.</p></li></ul><li><p><code>allfaces_optional</code></p></li><ul><li><p>Often used for leaves nodes.</p></li><li><p>This switches between <code>normal</code>, <code>glasslike</code> and <code>allfaces</code> according to</p></li><p>      the menu setting: Opaque Leaves / Simple Leaves / Fancy Leaves.</p><li><p>With &#x27;Simple Leaves&#x27; selected, the texture specified in <code>special_tiles</code></p></li><p>      is used instead, if present. This allows a visually thicker texture to be</p><p>      used to compensate for how <code>glasslike</code> reduces visual thickness.</p></ul><li><p><code>torchlike</code></p></li><ul><li><p>A single vertical texture.</p></li><li><p>If placed on top of a node, uses the first texture specified in <code>tiles</code>.</p></li><li><p>If placed against the underside of a node, uses the second texture</p></li><p>      specified in <code>tiles</code>.</p><li><p>If placed on the side of a node, uses the third texture specified in</p></li><p>      <code>tiles</code> and is perpendicular to that node.</p></ul><li><p><code>signlike</code></p></li><ul><li><p>A single texture parallel to, and mounted against, the top, underside or</p></li><p>      side of a node.</p></ul><li><p><code>plantlike</code></p></li><ul><li><p>Two vertical and diagonal textures at right-angles to each other.</p></li><li><p>See <code>paramtype2 == &quot;meshoptions&quot;</code> above for other options.</p></li></ul><li><p><code>firelike</code></p></li><ul><li><p>When above a flat surface, appears as 6 textures, the central 2 as</p></li><p>      <code>plantlike</code> plus 4 more surrounding those.</p><li><p>If not above a surface the central 2 do not appear, but the texture</p></li><p>      appears against the faces of surrounding nodes if they are present.</p></ul><li><p><code>fencelike</code></p></li><ul><li><p>A 3D model suitable for a wooden fence.</p></li><li><p>One placed node appears as a single vertical post.</p></li><li><p>Adjacently-placed nodes cause horizontal bars to appear between them.</p></li></ul><li><p><code>raillike</code></p></li><ul><li><p>Often used for tracks for mining carts.</p></li><li><p>Requires 4 textures to be specified in <code>tiles</code>, in order: Straight,</p></li><p>      curved, t-junction, crossing.</p><li><p>Each placed node automatically switches to a suitable rotated texture</p></li><p>      determined by the adjacent <code>raillike</code> nodes, in order to create a</p><p>      continuous track network.</p><li><p>Becomes a sloping node if placed against stepped nodes.</p></li></ul><li><p><code>nodebox</code></p></li><ul><li><p>Often used for stairs and slabs.</p></li><li><p>Allows defining nodes consisting of an arbitrary number of boxes.</p></li><li><p>See &#x27;Node boxes&#x27; below for more information.</p></li></ul><li><p><code>mesh</code></p></li><ul><li><p>Uses models for nodes.</p></li><li><p>Tiles should hold model materials textures.</p></li><li><p>Only static meshes are implemented.</p></li><li><p>For supported model formats see Irrlicht engine documentation.</p></li></ul><li><p><code>plantlike_rooted</code></p></li><ul><li><p>Enables underwater <code>plantlike</code> without air bubbles around the nodes.</p></li><li><p>Consists of a base cube at the co-ordinates of the node plus a</p></li><p>      <code>plantlike</code> extension above with a height of <code>param2 / 16</code> nodes.</p><li><p>The <code>plantlike</code> extension visually passes through any nodes above the</p></li><p>      base cube without affecting them.</p><li><p>The base cube texture tiles are defined as normal, the <code>plantlike</code></p></li><p>      extension uses the defined special tile, for example:</p><p>      <code>special_tiles = {{name = &quot;default_papyrus.png&quot;, tileable_vertical = true}},</code></p></ul></ul><br><p><code>*_optional</code> drawtypes need less rendering time if deactivated</p><p>(always client-side).</p><br><h2 id="gheader67"><p>Node boxes</p></h2><br><p>Node selection boxes are defined using &quot;node boxes&quot;.</p><br><p>A nodebox is defined as any of:</p><br><pre><code>{
    -- A normal cube; the default in most things
    type = &quot;regular&quot;
}
{
    -- A fixed box (or boxes) (facedir param2 is used, if applicable)
    type = &quot;fixed&quot;,
    fixed = box OR {box1, box2, ...}
}
{
    -- A variable height box (or boxes) with the top face position defined
    -- by the node parameter &#x27;leveled = &#x27;, or if &#x27;paramtype2 == &quot;leveled&quot;&#x27;
    -- by param2.
    -- Other faces are defined by &#x27;fixed = {}&#x27; as with &#x27;type = &quot;fixed&quot;&#x27;.
    type = &quot;leveled&quot;,
    fixed = box OR {box1, box2, ...}
}
{
    -- A box like the selection box for torches
    -- (wallmounted param2 is used, if applicable)
    type = &quot;wallmounted&quot;,
    wall_top = box,
    wall_bottom = box,
    wall_side = box
}
{
    -- A node that has optional boxes depending on neighbouring nodes&#x27;
    -- presence and type. See also `connects_to`.
    type = &quot;connected&quot;,
    fixed = box OR {box1, box2, ...}
    connect_top = box OR {box1, box2, ...}
    connect_bottom = box OR {box1, box2, ...}
    connect_front = box OR {box1, box2, ...}
    connect_left = box OR {box1, box2, ...}
    connect_back = box OR {box1, box2, ...}
    connect_right = box OR {box1, box2, ...}
    -- The following `disconnected_*` boxes are the opposites of the
    -- `connect_*` ones above, i.e. when a node has no suitable neighbour
    -- on the respective side, the corresponding disconnected box is drawn.
    disconnected_top = box OR {box1, box2, ...}
    disconnected_bottom = box OR {box1, box2, ...}
    disconnected_front = box OR {box1, box2, ...}
    disconnected_left = box OR {box1, box2, ...}
    disconnected_back = box OR {box1, box2, ...}
    disconnected_right = box OR {box1, box2, ...}
    disconnected = box OR {box1, box2, ...} -- when there is *no* neighbour
    disconnected_sides = box OR {box1, box2, ...} -- when there are *no*
                                                    neighbours to the sides
}
</code></pre><br><p>A <code>box</code> is defined as:</p><br><pre><code>{x1, y1, z1, x2, y2, z2}
</code></pre><br><p>A box of a regular node would look like:</p><br><pre><code>{-0.5, -0.5, -0.5, 0.5, 0.5, 0.5},
</code></pre><br><h1 id="gheader68"><br></h1><br><h2 id="gheader69"><p>HUD element types</p></h2><br><p>The position field is used for all element types.</p><br><p>To account for differing resolutions, the position coordinates are the</p><p>percentage of the screen, ranging in value from <code>0</code> to <code>1</code>.</p><br><p>The name field is not yet used, but should contain a description of what the</p><p>HUD element represents. The direction field is the direction in which something</p><p>is drawn.</p><br><p><code>0</code> draws from left to right, <code>1</code> draws from right to left, <code>2</code> draws from</p><p>top to bottom, and <code>3</code> draws from bottom to top.</p><br><p>The <code>alignment</code> field specifies how the item will be aligned. It ranges from</p><p><code>-1</code> to <code>1</code>, with <code>0</code> being the center. <code>-1</code> is moved to the left/up, and <code>1</code></p><p>is to the right/down. Fractional values can be used.</p><br><p>The <code>offset</code> field specifies a pixel offset from the position. Contrary to</p><p>position, the offset is not scaled to screen size. This allows for some</p><p>precisely positioned items in the HUD.</p><br><p><b>Note</b>: <code>offset</code> _will_ adapt to screen DPI as well as user defined scaling</p><p>factor!</p><br><p>Below are the specific uses for fields in each type; fields not listed for that</p><p>type are ignored.</p><br><h3 id="gheader70"><p><code>image</code></p></h3><p>Displays an image on the HUD.</p><br><ul><li><p><code>scale</code>: The scale of the image, with 1 being the original texture size.</p></li><p>  Only the X coordinate scale is used (positive values).</p><p>  Negative values represent that percentage of the screen it</p><p>  should take; e.g. <code>x=-100</code> means 100% (width).</p><li><p><code>text</code>: The name of the texture that is displayed.</p></li><li><p><code>alignment</code>: The alignment of the image.</p></li><li><p><code>offset</code>: offset in pixels from position.</p></li></ul><br><h3 id="gheader71"><p><code>text</code></p></h3><p>Displays text on the HUD.</p><br><ul><li><p><code>scale</code>: Defines the bounding rectangle of the text.</p></li><p>  A value such as <code>{x=100, y=100}</code> should work.</p><li><p><code>text</code>: The text to be displayed in the HUD element.</p></li><li><p><code>number</code>: An integer containing the RGB value of the color used to draw the</p></li><p>  text. Specify <code>0xFFFFFF</code> for white text, <code>0xFF0000</code> for red, and so on.</p><li><p><code>alignment</code>: The alignment of the text.</p></li><li><p><code>offset</code>: offset in pixels from position.</p></li></ul><br><h3 id="gheader72"><p><code>statbar</code></p></h3><p>Displays a horizontal bar made up of half-images.</p><br><ul><li><p><code>text</code>: The name of the texture that is used.</p></li><li><p><code>number</code>: The number of half-textures that are displayed.</p></li><p>  If odd, will end with a vertically center-split texture.</p><li><p><code>direction</code></p></li><li><p><code>offset</code>: offset in pixels from position.</p></li><li><p><code>size</code>: If used, will force full-image size to this value (override texture</p></li><p>  pack image size)</p></ul><br><h3 id="gheader73"><p><code>inventory</code></p></h3><ul><li><p><code>text</code>: The name of the inventory list to be displayed.</p></li><li><p><code>number</code>: Number of items in the inventory to be displayed.</p></li><li><p><code>item</code>: Position of item that is selected.</p></li><li><p><code>direction</code></p></li><li><p><code>offset</code>: offset in pixels from position.</p></li></ul><br><h3 id="gheader74"><p><code>waypoint</code></p></h3><p>Displays distance to selected world position.</p><br><ul><li><p><code>name</code>: The name of the waypoint.</p></li><li><p><code>text</code>: Distance suffix. Can be blank.</p></li><li><p><code>number:</code> An integer containing the RGB value of the color used to draw the</p></li><p>  text.</p><li><p><code>world_pos</code>: World position of the waypoint.</p></li></ul><br><h2 id="gheader75"><p>Representations of simple things</p></h2><br><br><h3 id="gheader76"><p>Position/vector</p></h3><br><pre><code>{x=num, y=num, z=num}
</code></pre><br><p>For helper functions see &quot;Spatial Vectors&quot;.</p><br><h3 id="gheader77"><p><code>pointed_thing</code></p></h3><ul><li><p><code>{type=&quot;nothing&quot;}</code></p></li><li><p><code>{type=&quot;node&quot;, under=pos, above=pos}</code></p></li><li><p><code>{type=&quot;object&quot;, ref=ObjectRef}</code></p></li></ul><br><h2 id="gheader78"><p>Flag Specifier Format</p></h2><br><p>Flags using the standardized flag specifier format can be specified in either</p><p>of two ways, by string or table.</p><br><p>The string format is a comma-delimited set of flag names; whitespace and</p><p>unrecognized flag fields are ignored. Specifying a flag in the string sets the</p><p>flag, and specifying a flag prefixed by the string <code>&quot;no&quot;</code> explicitly</p><p>clears the flag from whatever the default may be.</p><br><p>In addition to the standard string flag format, the schematic flags field can</p><p>also be a table of flag names to boolean values representing whether or not the</p><p>flag is set. Additionally, if a field with the flag name prefixed with <code>&quot;no&quot;</code></p><p>is present, mapped to a boolean of any value, the specified flag is unset.</p><br><p>E.g. A flag field of value</p><br><pre><code>{place_center_x = true, place_center_y=false, place_center_z=true}
</code></pre><br><p>is equivalent to</p><br><pre><code>{place_center_x = true, noplace_center_y=true, place_center_z=true}
</code></pre><br><p>which is equivalent to</p><br><pre><code>&quot;place_center_x, noplace_center_y, place_center_z&quot;
</code></pre><br><p>or even</p><br><pre><code>&quot;place_center_x, place_center_z&quot;
</code></pre><br><p>since, by default, no schematic attributes are set.</p><br><h2 id="gheader79"><p>Items</p></h2><br><br><h3 id="gheader80"><p>Item types</p></h3><p>There are three kinds of items: nodes, tools and craftitems.</p><br><ul><li><p>Node (<code>register_node</code>): A node from the world.</p></li><li><p>Tool (<code>register_tool</code>): A tool/weapon that can dig and damage</p></li><p>  things according to <code>tool_capabilities</code>.</p><li><p>Craftitem (<code>register_craftitem</code>): A miscellaneous item.</p></li></ul><br><h3 id="gheader81"><p>Amount and wear</p></h3><p>All item stacks have an amount between 0 to 65535. It is 1 by</p><p>default. Tool item stacks can not have an amount greater than 1.</p><br><p>Tools use a wear (=damage) value ranging from 0 to 65535. The</p><p>value 0 is the default and used is for unworn tools. The values</p><p>1 to 65535 are used for worn tools, where a higher value stands for</p><p>a higher wear. Non-tools always have a wear value of 0.</p><br><h3 id="gheader82"><p>Item formats</p></h3><p>Items and item stacks can exist in three formats: Serializes, table format</p><p>and <code>ItemStack</code>.</p><br><h4 id="gheader83"><p>Serialized</p></h4><p>This is called &quot;stackstring&quot; or &quot;itemstring&quot;. It is a simple string with</p><p>1-3 components: the full item identifier, an optional amount and an optional</p><p>wear value. Syntax:</p><br><pre><code>&lt;identifier&gt; [&lt;amount&gt;[ &lt;wear&gt;]]
</code></pre><br><p>Examples:</p><br><ul><li><p><code>&#x27;default:apple&#x27;</code>: 1 apple</p></li><li><p><code>&#x27;default:dirt 5&#x27;</code>: 5 dirt</p></li><li><p><code>&#x27;default:pick_stone&#x27;</code>: a new stone pickaxe</p></li><li><p><code>&#x27;default:pick_wood 1 21323&#x27;</code>: a wooden pickaxe, ca. 1/3 worn out</p></li></ul><br><h4 id="gheader84"><p>Table format</p></h4><p>Examples:</p><br><p>5 dirt nodes:</p><br><pre><code>{name=&quot;default:dirt&quot;, count=5, wear=0, metadata=&quot;&quot;}
</code></pre><br><p>A wooden pick about 1/3 worn out:</p><br><pre><code>{name=&quot;default:pick_wood&quot;, count=1, wear=21323, metadata=&quot;&quot;}
</code></pre><br><p>An apple:</p><br><pre><code>{name=&quot;default:apple&quot;, count=1, wear=0, metadata=&quot;&quot;}
</code></pre><br><h4 id="gheader85"><p><code>ItemStack</code></p></h4><p>A native C++ format with many helper methods. Useful for converting</p><p>between formats. See the Class reference section for details.</p><br><p>When an item must be passed to a function, it can usually be in any of</p><p>these formats.</p><h1 id="gheader86"><br></h1><br><h2 id="gheader87"><p>Groups</p></h2><br><p>In a number of places, there is a group table. Groups define the</p><p>properties of a thing (item, node, armor of entity, capabilities of</p><p>tool) in such a way that the engine and other mods can can interact with</p><p>the thing without actually knowing what the thing is.</p><br><h3 id="gheader88"><p>Usage</p></h3><p>Groups are stored in a table, having the group names with keys and the</p><p>group ratings as values. For example:</p><br><pre><code>groups = {crumbly=3, soil=1}
-- ^ Default dirt
</code></pre><br><pre><code>groups = {crumbly=2, soil=1, level=2, outerspace=1}
-- ^ A more special dirt-kind of thing
</code></pre><br><p>Groups always have a rating associated with them. If there is no</p><p>useful meaning for a rating for an enabled group, it shall be <code>1</code>.</p><br><p>When not defined, the rating of a group defaults to <code>0</code>. Thus when you</p><p>read groups, you must interpret <code>nil</code> and <code>0</code> as the same value, <code>0</code>.</p><br><p>You can read the rating of a group for an item or a node by using</p><br><pre><code>minetest.get_item_group(itemname, groupname)
</code></pre><br><h3 id="gheader89"><p>Groups of items</p></h3><p>Groups of items can define what kind of an item it is (e.g. wool).</p><br><h3 id="gheader90"><p>Groups of nodes</p></h3><p>In addition to the general item things, groups are used to define whether</p><p>a node is destroyable and how long it takes to destroy by a tool.</p><br><h3 id="gheader91"><p>Groups of entities</p></h3><p>For entities, groups are, as of now, used only for calculating damage.</p><p>The rating is the percentage of damage caused by tools with this damage group.</p><p>See &quot;Entity damage mechanism&quot;.</p><br><pre><code>object.get_armor_groups() --&gt; a group-rating table (e.g. {fleshy=100})
object.set_armor_groups({fleshy=30, cracky=80})
</code></pre><br><h3 id="gheader92"><p>Groups of tools</p></h3><p>Groups in tools define which groups of nodes and entities they are</p><p>effective towards.</p><br><h3 id="gheader93"><p>Groups in crafting recipes</p></h3><p>An example: Make meat soup from any meat, any water and any bowl:</p><br><pre><code>{
    output = &#x27;food:meat_soup_raw&#x27;,
    recipe = {
        {&#x27;group:meat&#x27;},
        {&#x27;group:water&#x27;},
        {&#x27;group:bowl&#x27;},
    },
    -- preserve = {&#x27;group:bowl&#x27;}, -- Not implemented yet (TODO)
}
</code></pre><br><p>Another example: Make red wool from white wool and red dye:</p><br><pre><code>{
    type = &#x27;shapeless&#x27;,
    output = &#x27;wool:red&#x27;,
    recipe = {&#x27;wool:white&#x27;, &#x27;group:dye,basecolor_red&#x27;},
}
</code></pre><br><h3 id="gheader94"><p>Special groups</p></h3><ul><li><p><code>immortal</code>: Disables the group damage system for an entity</p></li><li><p><code>punch_operable</code>: For entities; disables the regular damage mechanism for</p></li><p>  players punching it by hand or a non-tool item, so that it can do something</p><p>  else than take damage.</p><li><p><code>level</code>: Can be used to give an additional sense of progression in the game.</p></li><ul><li><p>A larger level will cause e.g. a weapon of a lower level make much less</p></li><p>       damage, and get worn out much faster, or not be able to get drops</p><p>       from destroyed nodes.</p><li><p><code>0</code> is something that is directly accessible at the start of gameplay</p></li><li><p>There is no upper limit</p></li></ul><li><p><code>dig_immediate</code>: (player can always pick up node without reducing tool wear)</p></li><ul><li><p><code>2</code>: the node always gets the digging time 0.5 seconds (rail, sign)</p></li><li><p><code>3</code>: the node always gets the digging time 0 seconds (torch)</p></li></ul><li><p><code>disable_jump</code>: Player (and possibly other things) cannot jump from node</p></li><li><p><code>fall_damage_add_percent</code>: damage speed = <code>speed * (1 + value/100)</code></p></li><li><p><code>bouncy</code>: value is bounce speed in percent</p></li><li><p><code>falling_node</code>: if there is no walkable block under the node it will fall</p></li><li><p><code>attached_node</code>: if the node under it is not a walkable block the node will be</p></li><p>  dropped as an item. If the node is wallmounted the wallmounted direction is</p><p>  checked.</p><li><p><code>soil</code>: saplings will grow on nodes in this group</p></li><li><p><code>connect_to_raillike</code>: makes nodes of raillike drawtype with same group value</p></li><p>  connect to each other</p><li><p><code>slippery</code>: Players and items will slide on the node.</p></li><p>  Slipperiness rises steadily with <code>slippery</code> value, starting at 1.</p><h1 id="gheader95"><br></h1></ul><br><h3 id="gheader96"><p>Known damage and digging time defining groups</p></h3><ul><li><p><code>crumbly</code>: dirt, sand</p></li><li><p><code>cracky</code>: tough but crackable stuff like stone.</p></li><li><p><code>snappy</code>: something that can be cut using fine tools; e.g. leaves, small</p></li><p>  plants, wire, sheets of metal</p><li><p><code>choppy</code>: something that can be cut using force; e.g. trees, wooden planks</p></li><li><p><code>fleshy</code>: Living things like animals and the player. This could imply</p></li><p>  some blood effects when hitting.</p><li><p><code>explody</code>: Especially prone to explosions</p></li><li><p><code>oddly_breakable_by_hand</code>:</p></li><p>   Can be added to nodes that shouldn&#x27;t logically be breakable by the</p><p>   hand but are. Somewhat similar to <code>dig_immediate</code>, but times are more</p><p>   like <code>{[1]=3.50,[2]=2.00,[3]=0.70}</code> and this does not override the</p><p>   speed of a tool if the tool can dig at a faster speed than this</p><p>   suggests for the hand.</p></ul><br><h3 id="gheader97"><p>Examples of custom groups</p></h3><p>Item groups are often used for defining, well, _groups of items_.</p><br><ul><li><p><code>meat</code>: any meat-kind of a thing (rating might define the size or healing</p></li><p>  ability or be irrelevant -- it is not defined as of yet)</p><li><p><code>eatable</code>: anything that can be eaten. Rating might define HP gain in half</p></li><p>  hearts.</p><li><p><code>flammable</code>: can be set on fire. Rating might define the intensity of the</p></li><p>  fire, affecting e.g. the speed of the spreading of an open fire.</p><li><p><code>wool</code>: any wool (any origin, any color)</p></li><li><p><code>metal</code>: any metal</p></li><li><p><code>weapon</code>: any weapon</p></li><li><p><code>heavy</code>: anything considerably heavy</p></li></ul><br><h3 id="gheader98"><p>Digging time calculation specifics</p></h3><p>Groups such as <code>crumbly</code>, <code>cracky</code> and <code>snappy</code> are used for this</p><p>purpose. Rating is <code>1</code>, <code>2</code> or <code>3</code>. A higher rating for such a group implies</p><p>faster digging time.</p><br><p>The <code>level</code> group is used to limit the toughness of nodes a tool can dig</p><p>and to scale the digging times / damage to a greater extent.</p><br><p><b>Please do understand this</b>, otherwise you cannot use the system to it&#x27;s</p><p>full potential.</p><br><p>Tools define their properties by a list of parameters for groups. They</p><p>cannot dig other groups; thus it is important to use a standard bunch of</p><p>groups to enable interaction with tools.</p><br><h4 id="gheader99"><p>Tools definition</p></h4><p>Tools define:</p><br><ul><li><p>Full punch interval</p></li><li><p>Maximum drop level</p></li><li><p>For an arbitrary list of groups:</p></li><ul><li><p>Uses (until the tool breaks)</p></li><ul><li><p>Maximum level (usually <code>0</code>, <code>1</code>, <code>2</code> or <code>3</code>)</p></li><li><p>Digging times</p></li><li><p>Damage groups</p></li></ul></ul></ul><br><h4 id="gheader100"><p>Full punch interval</p></h4><p>When used as a weapon, the tool will do full damage if this time is spent</p><p>between punches. If e.g. half the time is spent, the tool will do half</p><p>damage.</p><br><h4 id="gheader101"><p>Maximum drop level</p></h4><p>Suggests the maximum level of node, when dug with the tool, that will drop</p><p>it&#x27;s useful item. (e.g. iron ore to drop a lump of iron).</p><br><p>This is not automated; it is the responsibility of the node definition</p><p>to implement this.</p><br><h4 id="gheader102"><p>Uses</p></h4><p>Determines how many uses the tool has when it is used for digging a node,</p><p>of this group, of the maximum level. For lower leveled nodes, the use count</p><p>is multiplied by <code>3^leveldiff</code>.</p><br><ul><li><p><code>uses=10, leveldiff=0</code>: actual uses: 10</p></li><li><p><code>uses=10, leveldiff=1</code>: actual uses: 30</p></li><li><p><code>uses=10, leveldiff=2</code>: actual uses: 90</p></li></ul><br><h4 id="gheader103"><p>Maximum level</p></h4><p>Tells what is the maximum level of a node of this group that the tool will</p><p>be able to dig.</p><br><h4 id="gheader104"><p>Digging times</p></h4><p>List of digging times for different ratings of the group, for nodes of the</p><p>maximum level.</p><br><p>For example, as a Lua table, <code>times={2=2.00, 3=0.70}</code>. This would</p><p>result in the tool to be able to dig nodes that have a rating of <code>2</code> or <code>3</code></p><p>for this group, and unable to dig the rating <code>1</code>, which is the toughest.</p><p>Unless there is a matching group that enables digging otherwise.</p><br><p>If the result digging time is 0, a delay of 0.15 seconds is added between</p><p>digging nodes; If the player releases LMB after digging, this delay is set to 0,</p><p>i.e. players can more quickly click the nodes away instead of holding LMB.</p><br><h4 id="gheader105"><p>Damage groups</p></h4><p>List of damage for groups of entities. See &quot;Entity damage mechanism&quot;.</p><br><h4 id="gheader106"><p>Example definition of the capabilities of a tool</p></h4><br><pre><code>tool_capabilities = {
    full_punch_interval=1.5,
    max_drop_level=1,
    groupcaps={
        crumbly={maxlevel=2, uses=20, times={[1]=1.60, [2]=1.20, [3]=0.80}}
    }
    damage_groups = {fleshy=2},
}
</code></pre><br><p>This makes the tool be able to dig nodes that fulfil both of these:</p><br><ul><li><p>Have the <code>crumbly</code> group</p></li><li><p>Have a <code>level</code> group less or equal to <code>2</code></p></li></ul><br><p>Table of resulting digging times:</p><br><pre><code>crumbly        0     1     2     3     4  &lt;- level
     -&gt;  0     -     -     -     -     -
         1  0.80  1.60  1.60     -     -
         2  0.60  1.20  1.20     -     -
         3  0.40  0.80  0.80     -     -
</code></pre><br><pre><code>level diff:    2     1     0    -1    -2
</code></pre><br><p>Table of resulting tool uses:</p><br><pre><code>-&gt;  0     -     -     -     -     -
    1   180    60    20     -     -
    2   180    60    20     -     -
    3   180    60    20     -     -
</code></pre><br><p><b>Notes</b>:</p><br><ul><li><p>At <code>crumbly==0</code>, the node is not diggable.</p></li><li><p>At <code>crumbly==3</code>, the level difference digging time divider kicks in and makes</p></li><p>  easy nodes to be quickly breakable.</p><li><p>At <code>level &gt; 2</code>, the node is not diggable, because it&#x27;s <code>level &gt; maxlevel</code></p></li></ul><br><h2 id="gheader107"><p>Entity damage mechanism</p></h2><br><p>Damage calculation:</p><br><pre><code>damage = 0
foreach group in cap.damage_groups:
    damage += cap.damage_groups[group] * limit(actual_interval /
           cap.full_punch_interval, 0.0, 1.0)
        * (object.armor_groups[group] / 100.0)
        -- Where object.armor_groups[group] is 0 for inexistent values
return damage
</code></pre><br><p>Client predicts damage based on damage groups. Because of this, it is able to</p><p>give an immediate response when an entity is damaged or dies; the response is</p><p>pre-defined somehow (e.g. by defining a sprite animation) (not implemented;</p><p>TODO).</p><p>Currently a smoke puff will appear when an entity dies.</p><br><p>The group <code>immortal</code> completely disables normal damage.</p><br><p>Entities can define a special armor group, which is <code>punch_operable</code>. This</p><p>group disables the regular damage mechanism for players punching it by hand or</p><p>a non-tool item, so that it can do something else than take damage.</p><br><p>On the Lua side, every punch calls:</p><br><p>  entity:on_punch(puncher, time_from_last_punch, tool_capabilities, direction, damage)</p><br><p>This should never be called directly, because damage is usually not handled by</p><p>the entity itself.</p><br><ul><li><p><code>puncher</code> is the object performing the punch. Can be <code>nil</code>. Should never be</p></li><p>  accessed unless absolutely required, to encourage interoperability.</p><li><p><code>time_from_last_punch</code> is time from last punch (by <code>puncher</code>) or <code>nil</code>.</p></li><li><p><code>tool_capabilities</code> can be <code>nil</code>.</p></li><li><p><code>direction</code> is a unit vector, pointing from the source of the punch to</p></li><p>   the punched object.</p><li><p><code>damage</code> damage that will be done to entity</p></li><p>Return value of this function will determine if damage is done by this function</p><p>(retval true) or shall be done by engine (retval false)</p></ul><br><p>To punch an entity/object in Lua, call:</p><br><p>  object:punch(puncher, time_from_last_punch, tool_capabilities, direction)</p><br><ul><li><p>Return value is tool wear.</p></li><li><p>Parameters are equal to the above callback.</p></li><li><p>If <code>direction</code> equals <code>nil</code> and <code>puncher</code> does not equal <code>nil</code>, <code>direction</code></p></li><p>  will be automatically filled in based on the location of <code>puncher</code>.</p></ul><br><h2 id="gheader108"><p>Node Metadata</p></h2><br><p>The instance of a node in the world normally only contains the three values</p><p>mentioned in &quot;Nodes&quot;. However, it is possible to insert extra data into a</p><p>node. It is called &quot;node metadata&quot;; See <code>NodeMetaRef</code>.</p><br><p>Node metadata contains two things:</p><br><ul><li><p>A key-value store</p></li><li><p>An inventory</p></li></ul><br><p>Some of the values in the key-value store are handled specially:</p><br><ul><li><p><code>formspec</code>: Defines a right-click inventory menu. See &quot;Formspec&quot;.</p></li><li><p><code>infotext</code>: Text shown on the screen when the node is pointed at</p></li></ul><br><p>Example stuff:</p><br><pre><code>local meta = minetest.get_meta(pos)
meta:set_string(&quot;formspec&quot;,
        &quot;size[8,9]&quot;..
        &quot;list[context;main;0,0;8,4;]&quot;..
        &quot;list[current_player;main;0,5;8,4;]&quot;)
meta:set_string(&quot;infotext&quot;, &quot;Chest&quot;);
local inv = meta:get_inventory()
inv:set_size(&quot;main&quot;, 8*4)
print(dump(meta:to_table()))
meta:from_table({
    inventory = {
        main = {[1] = &quot;default:dirt&quot;, [2] = &quot;&quot;, [3] = &quot;&quot;, [4] = &quot;&quot;,
                [5] = &quot;&quot;, [6] = &quot;&quot;, [7] = &quot;&quot;, [8] = &quot;&quot;, [9] = &quot;&quot;,
                [10] = &quot;&quot;, [11] = &quot;&quot;, [12] = &quot;&quot;, [13] = &quot;&quot;,
                [14] = &quot;default:cobble&quot;, [15] = &quot;&quot;, [16] = &quot;&quot;, [17] = &quot;&quot;,
                [18] = &quot;&quot;, [19] = &quot;&quot;, [20] = &quot;default:cobble&quot;, [21] = &quot;&quot;,
                [22] = &quot;&quot;, [23] = &quot;&quot;, [24] = &quot;&quot;, [25] = &quot;&quot;, [26] = &quot;&quot;,
                [27] = &quot;&quot;, [28] = &quot;&quot;, [29] = &quot;&quot;, [30] = &quot;&quot;, [31] = &quot;&quot;,
                [32] = &quot;&quot;}
    },
    fields = {
        formspec = &quot;size[8,9]list[context;main;0,0;8,4;]list[current_player;main;0,5;8,4;]&quot;,
        infotext = &quot;Chest&quot;
    }
})
</code></pre><br><h2 id="gheader109"><p>Item Metadata</p></h2><br><p>Item stacks can store metadata too. See <code>ItemStackMetaRef</code>.</p><br><p>Item metadata only contains a key-value store.</p><br><p>Some of the values in the key-value store are handled specially:</p><br><ul><li><p><code>description</code>: Set the item stack&#x27;s description. Defaults to</p></li><p>  <code>idef.description</code>.</p><li><p><code>color</code>: A <code>ColorString</code>, which sets the stack&#x27;s color.</p></li><li><p><code>palette_index</code>: If the item has a palette, this is used to get the</p></li><p>  current color from the palette.</p></ul><br><p>Example stuff:</p><br><pre><code>local meta = stack:get_meta()
meta:set_string(&quot;key&quot;, &quot;value&quot;)
print(dump(meta:to_table()))
</code></pre><br><h2 id="gheader110"><p>Formspec</p></h2><br><p>Formspec defines a menu. Currently not much else than inventories are</p><p>supported. It is a string, with a somewhat strange format.</p><br><p>Spaces and newlines can be inserted between the blocks, as is used in the</p><p>examples.</p><br><p>WARNING: Minetest allows you to add elements to every single formspec instance</p><p>using player:set_formspec_prepend(), which may be the reason backgrounds are</p><p>appearing when you don&#x27;t expect them to. See <code>no_prepend[]</code></p><br><h3 id="gheader111"><p>Examples</p></h3><br><h4 id="gheader112"><p>Chest</p></h4><br><pre><code>size[8,9]
list[context;main;0,0;8,4;]
list[current_player;main;0,5;8,4;]
</code></pre><br><h4 id="gheader113"><p>Furnace</p></h4><br><pre><code>size[8,9]
list[context;fuel;2,3;1,1;]
list[context;src;2,1;1,1;]
list[context;dst;5,1;2,2;]
list[current_player;main;0,5;8,4;]
</code></pre><br><h4 id="gheader114"><p>Minecraft-like player inventory</p></h4><br><pre><code>size[8,7.5]
image[1,0.6;1,2;player.png]
list[current_player;main;0,3.5;8,4;]
list[current_player;craft;3,0;3,3;]
list[current_player;craftpreview;7,1;1,1;]
</code></pre><br><h3 id="gheader115"><p>Elements</p></h3><br><h4 id="gheader116"><p><code>size[&lt;W&gt;,&lt;H&gt;,&lt;fixed_size&gt;]</code></p></h4><ul><li><p>Define the size of the menu in inventory slots</p></li><li><p><code>fixed_size</code>: <code>true</code>/<code>false</code> (optional)</p></li><li><p>deprecated: <code>invsize[&lt;W&gt;,&lt;H&gt;;]</code></p></li></ul><br><h4 id="gheader117"><p><code>position[&lt;X&gt;,&lt;Y&gt;]</code></p></h4><ul><li><p>Must be used after <code>size</code> element.</p></li><li><p>Defines the position on the game window of the formspec&#x27;s <code>anchor</code> point.</p></li><li><p>For X and Y, 0.0 and 1.0 represent opposite edges of the game window,</p></li><p>  for example:</p><ul><li><p>[0.0, 0.0] sets the position to the top left corner of the game window.</p></li><li><p>[1.0, 1.0] sets the position to the bottom right of the game window.</p></li></ul><li><p>Defaults to the center of the game window [0.5, 0.5].</p></li></ul><br><h4 id="gheader118"><p><code>anchor[&lt;X&gt;,&lt;Y&gt;]</code></p></h4><ul><li><p>Must be used after both <code>size</code> and <code>position</code> (if present) elements.</p></li><li><p>Defines the location of the anchor point within the formspec.</p></li><li><p>For X and Y, 0.0 and 1.0 represent opposite edges of the formspec,</p></li><p>  for example:</p><ul><li><p>[0.0, 1.0] sets the anchor to the bottom left corner of the formspec.</p></li><li><p>[1.0, 0.0] sets the anchor to the top right of the formspec.</p></li></ul><li><p>Defaults to the center of the formspec [0.5, 0.5].</p></li></ul><br><ul><li><p><code>position</code> and <code>anchor</code> elements need suitable values to avoid a formspec</p></li><p>  extending off the game window due to particular game window sizes.</p></ul><br><h4 id="gheader119"><p><code>no_prepend[]</code></p></h4><ul><li><p>Must be used after the <code>size</code>, <code>position</code>, and <code>anchor</code> elements (if present).</p></li><li><p>Disables player:set_formspec_prepend() from applying to this formspec.</p></li></ul><br><h4 id="gheader120"><p><code>container[&lt;X&gt;,&lt;Y&gt;]</code></p></h4><ul><li><p>Start of a container block, moves all physical elements in the container by</p></li><p>  (X, Y).</p><li><p>Must have matching <code>container_end</code></p></li><li><p>Containers can be nested, in which case the offsets are added</p></li><p>  (child containers are relative to parent containers)</p></ul><br><h4 id="gheader121"><p><code>container_end[]</code></p></h4><ul><li><p>End of a container, following elements are no longer relative to this</p></li><p>  container.</p></ul><br><h4 id="gheader122"><p><code>list[&lt;inventory location&gt;;&lt;list name&gt;;&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;]</code></p></h4><ul><li><p>Show an inventory list</p></li></ul><br><h4 id="gheader123"><p><code>list[&lt;inventory location&gt;;&lt;list name&gt;;&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;starting item index&gt;]</code></p></h4><ul><li><p>Show an inventory list</p></li></ul><br><h4 id="gheader124"><p><code>listring[&lt;inventory location&gt;;&lt;list name&gt;]</code></p></h4><ul><li><p>Allows to create a ring of inventory lists</p></li><li><p>Shift-clicking on items in one element of the ring</p></li><p>  will send them to the next inventory list inside the ring</p><li><p>The first occurrence of an element inside the ring will</p></li><p>  determine the inventory where items will be sent to</p></ul><br><h4 id="gheader125"><p><code>listring[]</code></p></h4><ul><li><p>Shorthand for doing <code>listring[&lt;inventory location&gt;;&lt;list name&gt;]</code></p></li><p>  for the last two inventory lists added by list[...]</p></ul><br><h4 id="gheader126"><p><code>listcolors[&lt;slot_bg_normal&gt;;&lt;slot_bg_hover&gt;]</code></p></h4><ul><li><p>Sets background color of slots as <code>ColorString</code></p></li><li><p>Sets background color of slots on mouse hovering</p></li></ul><br><h4 id="gheader127"><p><code>listcolors[&lt;slot_bg_normal&gt;;&lt;slot_bg_hover&gt;;&lt;slot_border&gt;]</code></p></h4><ul><li><p>Sets background color of slots as <code>ColorString</code></p></li><li><p>Sets background color of slots on mouse hovering</p></li><li><p>Sets color of slots border</p></li></ul><br><h4 id="gheader128"><p><code>listcolors[&lt;slot_bg_normal&gt;;&lt;slot_bg_hover&gt;;&lt;slot_border&gt;;&lt;tooltip_bgcolor&gt;;&lt;tooltip_fontcolor&gt;]</code></p></h4><ul><li><p>Sets background color of slots as <code>ColorString</code></p></li><li><p>Sets background color of slots on mouse hovering</p></li><li><p>Sets color of slots border</p></li><li><p>Sets default background color of tooltips</p></li><li><p>Sets default font color of tooltips</p></li></ul><br><h4 id="gheader129"><p><code>tooltip[&lt;gui_element_name&gt;;&lt;tooltip_text&gt;;&lt;bgcolor&gt;;&lt;fontcolor&gt;]</code></p></h4><ul><li><p>Adds tooltip for an element</p></li><li><p><code>&lt;bgcolor&gt;</code> tooltip background color as <code>ColorString</code> (optional)</p></li><li><p><code>&lt;fontcolor&gt;</code> tooltip font color as <code>ColorString</code> (optional)</p></li></ul><br><h4 id="gheader130"><p><code>image[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;texture name&gt;]</code></p></h4><ul><li><p>Show an image</p></li><li><p>Position and size units are inventory slots</p></li></ul><br><h4 id="gheader131"><p><code>item_image[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;item name&gt;]</code></p></h4><ul><li><p>Show an inventory image of registered item/node</p></li><li><p>Position and size units are inventory slots</p></li></ul><br><h4 id="gheader132"><p><code>bgcolor[&lt;color&gt;;&lt;fullscreen&gt;]</code></p></h4><ul><li><p>Sets background color of formspec as <code>ColorString</code></p></li><li><p>If <code>true</code>, the background color is drawn fullscreen (does not effect the size</p></li><p>  of the formspec).</p></ul><br><h4 id="gheader133"><p><code>background[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;texture name&gt;]</code></p></h4><ul><li><p>Use a background. Inventory rectangles are not drawn then.</p></li><li><p>Position and size units are inventory slots</p></li><li><p>Example for formspec 8x4 in 16x resolution: image shall be sized</p></li><p>  8 times 16px  times  4 times 16px.</p></ul><br><h4 id="gheader134"><p><code>background[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;texture name&gt;;&lt;auto_clip&gt;]</code></p></h4><ul><li><p>Use a background. Inventory rectangles are not drawn then.</p></li><li><p>Position and size units are inventory slots</p></li><li><p>Example for formspec 8x4 in 16x resolution:</p></li><p>  image shall be sized 8 times 16px  times  4 times 16px</p><li><p>If <code>true</code> the background is clipped to formspec size</p></li><p>  (<code>x</code> and <code>y</code> are used as offset values, <code>w</code> and <code>h</code> are ignored)</p></ul><br><h4 id="gheader135"><p><code>pwdfield[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;label&gt;]</code></p></h4><ul><li><p>Textual password style field; will be sent to server when a button is clicked</p></li><li><p>When enter is pressed in field, fields.key_enter_field will be sent with the</p></li><p>  name of this field.</p><li><p><code>x</code> and <code>y</code> position the field relative to the top left of the menu</p></li><li><p><code>w</code> and <code>h</code> are the size of the field</p></li><li><p>Fields are a set height, but will be vertically centred on <code>h</code></p></li><li><p>Position and size units are inventory slots</p></li><li><p><code>name</code> is the name of the field as returned in fields to <code>on_receive_fields</code></p></li><li><p><code>label</code>, if not blank, will be text printed on the top left above the field</p></li><li><p>See field_close_on_enter to stop enter closing the formspec</p></li></ul><br><h4 id="gheader136"><p><code>field[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;label&gt;;&lt;default&gt;]</code></p></h4><ul><li><p>Textual field; will be sent to server when a button is clicked</p></li><li><p>When enter is pressed in field, <code>fields.key_enter_field</code> will be sent with</p></li><p>  the name of this field.</p><li><p><code>x</code> and <code>y</code> position the field relative to the top left of the menu</p></li><li><p><code>w</code> and <code>h</code> are the size of the field</p></li><li><p>Fields are a set height, but will be vertically centred on <code>h</code></p></li><li><p>Position and size units are inventory slots</p></li><li><p><code>name</code> is the name of the field as returned in fields to <code>on_receive_fields</code></p></li><li><p><code>label</code>, if not blank, will be text printed on the top left above the field</p></li><li><p><code>default</code> is the default value of the field</p></li><ul><li><p><code>default</code> may contain variable references such as <code>${text}&#x27;</code> which</p></li><p>      will fill the value from the metadata value <code>text</code></p><li><p><b>Note</b>: no extra text or more than a single variable is supported ATM.</p></li></ul><li><p>See <code>field_close_on_enter</code> to stop enter closing the formspec</p></li></ul><br><h4 id="gheader137"><p><code>field[&lt;name&gt;;&lt;label&gt;;&lt;default&gt;]</code></p></h4><ul><li><p>As above, but without position/size units</p></li><li><p>When enter is pressed in field, <code>fields.key_enter_field</code> will be sent with</p></li><p>  the name of this field.</p><li><p>Special field for creating simple forms, such as sign text input</p></li><li><p>Must be used without a <code>size[]</code> element</p></li><li><p>A &quot;Proceed&quot; button will be added automatically</p></li><li><p>See <code>field_close_on_enter</code> to stop enter closing the formspec</p></li></ul><br><h4 id="gheader138"><p><code>field_close_on_enter[&lt;name&gt;;&lt;close_on_enter&gt;]</code></p></h4><ul><li><p>name is the name of the field</p></li><li><p>if close_on_enter is false, pressing enter in the field will submit the</p></li><p>  form but not close it.</p><li><p>defaults to true when not specified (ie: no tag for a field)</p></li></ul><br><h4 id="gheader139"><p><code>textarea[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;label&gt;;&lt;default&gt;]</code></p></h4><ul><li><p>Same as fields above, but with multi-line input</p></li><li><p>if the text overflows a vertical scrollbar is added</p></li><li><p>if the name is empty the textarea is readonly, the label is not displayed.</p></li></ul><br><h4 id="gheader140"><p><code>label[&lt;X&gt;,&lt;Y&gt;;&lt;label&gt;]</code></p></h4><ul><li><p><code>x</code> and <code>y</code> work as per field</p></li><li><p><code>label</code> is the text on the label</p></li><li><p>Position and size units are inventory slots</p></li></ul><br><h4 id="gheader141"><p><code>vertlabel[&lt;X&gt;,&lt;Y&gt;;&lt;label&gt;]</code></p></h4><ul><li><p>Textual label drawn vertically</p></li><li><p><code>x</code> and <code>y</code> work as per field</p></li><li><p><code>label</code> is the text on the label</p></li><li><p>Position and size units are inventory slots</p></li></ul><br><h4 id="gheader142"><p><code>button[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;label&gt;]</code></p></h4><ul><li><p>Clickable button. When clicked, fields will be sent.</p></li><li><p><code>x</code>, <code>y</code> and <code>name</code> work as per field</p></li><li><p><code>w</code> and <code>h</code> are the size of the button</p></li><li><p>Fixed button height. It will be vertically centred on <code>h</code></p></li><li><p><code>label</code> is the text on the button</p></li><li><p>Position and size units are inventory slots</p></li></ul><br><h4 id="gheader143"><p><code>image_button[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;texture name&gt;;&lt;name&gt;;&lt;label&gt;]</code></p></h4><ul><li><p><code>x</code>, <code>y</code>, <code>w</code>, <code>h</code>, and <code>name</code> work as per button</p></li><li><p><code>texture name</code> is the filename of an image</p></li><li><p>Position and size units are inventory slots</p></li></ul><br><h4 id="gheader144"><p><code>image_button[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;texture name&gt;;&lt;name&gt;;&lt;label&gt;;&lt;noclip&gt;;&lt;drawborder&gt;;&lt;pressed texture name&gt;]</code></p></h4><ul><li><p><code>x</code>, <code>y</code>, <code>w</code>, <code>h</code>, and <code>name</code> work as per button</p></li><li><p><code>texture name</code> is the filename of an image</p></li><li><p>Position and size units are inventory slots</p></li><li><p><code>noclip=true</code> means the image button doesn&#x27;t need to be within specified</p></li><p>  formsize.</p><li><p><code>drawborder</code>: draw button border or not</p></li><li><p><code>pressed texture name</code> is the filename of an image on pressed state</p></li></ul><br><h4 id="gheader145"><p><code>item_image_button[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;item name&gt;;&lt;name&gt;;&lt;label&gt;]</code></p></h4><ul><li><p><code>x</code>, <code>y</code>, <code>w</code>, <code>h</code>, <code>name</code> and <code>label</code> work as per button</p></li><li><p><code>item name</code> is the registered name of an item/node,</p></li><p>  tooltip will be made out of its description</p><p>  to override it use tooltip element</p><li><p>Position and size units are inventory slots</p></li></ul><br><h4 id="gheader146"><p><code>button_exit[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;label&gt;]</code></p></h4><ul><li><p>When clicked, fields will be sent and the form will quit.</p></li></ul><br><h4 id="gheader147"><p><code>image_button_exit[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;texture name&gt;;&lt;name&gt;;&lt;label&gt;]</code></p></h4><ul><li><p>When clicked, fields will be sent and the form will quit.</p></li></ul><br><h4 id="gheader148"><p><code>textlist[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;listelem 1&gt;,&lt;listelem 2&gt;,...,&lt;listelem n&gt;]</code></p></h4><ul><li><p>Scrollable item list showing arbitrary text elements</p></li><li><p><code>x</code> and <code>y</code> position the itemlist relative to the top left of the menu</p></li><li><p><code>w</code> and <code>h</code> are the size of the itemlist</p></li><li><p><code>name</code> fieldname sent to server on doubleclick value is current selected</p></li><p>  element.</p><li><p><code>listelements</code> can be prepended by #color in hexadecimal format RRGGBB</p></li><p>  (only).</p><ul><li><p>if you want a listelement to start with &quot;#&quot; write &quot;##&quot;.</p></li></ul></ul><br><h4 id="gheader149"><p><code>textlist[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;listelem 1&gt;,&lt;listelem 2&gt;,...,&lt;listelem n&gt;;&lt;selected idx&gt;;&lt;transparent&gt;]</code></p></h4><ul><li><p>Scrollable itemlist showing arbitrary text elements</p></li><li><p><code>x</code> and <code>y</code> position the item list relative to the top left of the menu</p></li><li><p><code>w</code> and <code>h</code> are the size of the item list</p></li><li><p><code>name</code> fieldname sent to server on doubleclick value is current selected</p></li><p>  element.</p><li><p><code>listelements</code> can be prepended by #RRGGBB (only) in hexadecimal format</p></li><ul><li><p>if you want a listelement to start with &quot;#&quot; write &quot;##&quot;</p></li></ul><li><p>Index to be selected within textlist</p></li><li><p><code>true</code>/<code>false</code>: draw transparent background</p></li><li><p>See also <code>minetest.explode_textlist_event</code></p></li><p>  (main menu: <code>core.explode_textlist_event</code>).</p></ul><br><h4 id="gheader150"><p><code>tabheader[&lt;X&gt;,&lt;Y&gt;;&lt;name&gt;;&lt;caption 1&gt;,&lt;caption 2&gt;,...,&lt;caption n&gt;;&lt;current_tab&gt;;&lt;transparent&gt;;&lt;draw_border&gt;]</code></p></h4><ul><li><p>Show a tab<b>header</b> at specific position (ignores formsize)</p></li><li><p><code>x</code> and <code>y</code> position the itemlist relative to the top left of the menu</p></li><li><p><code>name</code> fieldname data is transferred to Lua</p></li><li><p><code>caption 1</code>...: name shown on top of tab</p></li><li><p><code>current_tab</code>: index of selected tab 1...</p></li><li><p><code>transparent</code> (optional): show transparent</p></li><li><p><code>draw_border</code> (optional): draw border</p></li></ul><br><h4 id="gheader151"><p><code>box[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;color&gt;]</code></p></h4><ul><li><p>Simple colored box</p></li><li><p><code>x</code> and <code>y</code> position the box relative to the top left of the menu</p></li><li><p><code>w</code> and <code>h</code> are the size of box</p></li><li><p><code>color</code> is color specified as a <code>ColorString</code>.</p></li><p>  If the alpha component is left blank, the box will be semitransparent.</p></ul><br><h4 id="gheader152"><p><code>dropdown[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;;&lt;name&gt;;&lt;item 1&gt;,&lt;item 2&gt;, ...,&lt;item n&gt;;&lt;selected idx&gt;]</code></p></h4><ul><li><p>Show a dropdown field</p></li><li><p><b>Important note</b>: There are two different operation modes:</p></li><p>    1. handle directly on change (only changed dropdown is submitted)</p><p>    2. read the value on pressing a button (all dropdown values are available)</p><li><p><code>x</code> and <code>y</code> position of dropdown</p></li><li><p>Width of dropdown</p></li><li><p>Fieldname data is transferred to Lua</p></li><li><p>Items to be shown in dropdown</p></li><li><p>Index of currently selected dropdown item</p></li></ul><br><h4 id="gheader153"><p><code>checkbox[&lt;X&gt;,&lt;Y&gt;;&lt;name&gt;;&lt;label&gt;;&lt;selected&gt;]</code></p></h4><ul><li><p>Show a checkbox</p></li><li><p><code>x</code> and <code>y</code>: position of checkbox</p></li><li><p><code>name</code> fieldname data is transferred to Lua</p></li><li><p><code>label</code> to be shown left of checkbox</p></li><li><p><code>selected</code> (optional): <code>true</code>/<code>false</code></p></li></ul><br><h4 id="gheader154"><p><code>scrollbar[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;orientation&gt;;&lt;name&gt;;&lt;value&gt;]</code></p></h4><ul><li><p>Show a scrollbar</p></li><li><p>There are two ways to use it:</p></li><p>    1. handle the changed event (only changed scrollbar is available)</p><p>    2. read the value on pressing a button (all scrollbars are available)</p><li><p><code>x</code> and <code>y</code>: position of trackbar</p></li><li><p><code>w</code> and <code>h</code>: width and height</p></li><li><p><code>orientation</code>:  <code>vertical</code>/<code>horizontal</code></p></li><li><p>Fieldname data is transferred to Lua</p></li><li><p>Value this trackbar is set to (<code>0</code>-<code>1000</code>)</p></li><li><p>See also <code>minetest.explode_scrollbar_event</code></p></li><p>  (main menu: <code>core.explode_scrollbar_event</code>).</p></ul><br><h4 id="gheader155"><p><code>table[&lt;X&gt;,&lt;Y&gt;;&lt;W&gt;,&lt;H&gt;;&lt;name&gt;;&lt;cell 1&gt;,&lt;cell 2&gt;,...,&lt;cell n&gt;;&lt;selected idx&gt;]</code></p></h4><ul><li><p>Show scrollable table using options defined by the previous <code>tableoptions[]</code></p></li><li><p>Displays cells as defined by the previous <code>tablecolumns[]</code></p></li><li><p><code>x</code> and <code>y</code>: position the itemlist relative to the top left of the menu</p></li><li><p><code>w</code> and <code>h</code> are the size of the itemlist</p></li><li><p><code>name</code>: fieldname sent to server on row select or doubleclick</p></li><li><p><code>cell 1</code>...<code>cell n</code>: cell contents given in row-major order</p></li><li><p><code>selected idx</code>: index of row to be selected within table (first row = <code>1</code>)</p></li><li><p>See also <code>minetest.explode_table_event</code></p></li><p>  (main menu: <code>core.explode_table_event</code>).</p></ul><br><h4 id="gheader156"><p><code>tableoptions[&lt;opt 1&gt;;&lt;opt 2&gt;;...]</code></p></h4><ul><li><p>Sets options for <code>table[]</code></p></li><li><p><code>color=#RRGGBB</code></p></li><ul><li><p>default text color (<code>ColorString</code>), defaults to <code>#FFFFFF</code></p></li></ul><li><p><code>background=#RRGGBB</code></p></li><ul><li><p>table background color (<code>ColorString</code>), defaults to <code>#000000</code></p></li></ul><li><p><code>border=&lt;true/false&gt;</code></p></li><ul><li><p>should the table be drawn with a border? (default: <code>true</code>)</p></li></ul><li><p><code>highlight=#RRGGBB</code></p></li><ul><li><p>highlight background color (<code>ColorString</code>), defaults to <code>#466432</code></p></li></ul><li><p><code>highlight_text=#RRGGBB</code></p></li><ul><li><p>highlight text color (<code>ColorString</code>), defaults to <code>#FFFFFF</code></p></li></ul><li><p><code>opendepth=&lt;value&gt;</code></p></li><ul><li><p>all subtrees up to <code>depth &lt; value</code> are open (default value = <code>0</code>)</p></li><li><p>only useful when there is a column of type &quot;tree&quot;</p></li></ul></ul><br><h4 id="gheader157"><p><code>tablecolumns[&lt;type 1&gt;,&lt;opt 1a&gt;,&lt;opt 1b&gt;,...;&lt;type 2&gt;,&lt;opt 2a&gt;,&lt;opt 2b&gt;;...]</code></p></h4><ul><li><p>Sets columns for <code>table[]</code></p></li><li><p>Types: <code>text</code>, <code>image</code>, <code>color</code>, <code>indent</code>, <code>tree</code></p></li><ul><li><p><code>text</code>:   show cell contents as text</p></li><li><p><code>image</code>:  cell contents are an image index, use column options to define</p></li><p>                images.</p><li><p><code>color</code>:  cell contents are a ColorString and define color of following</p></li><p>                cell.</p><li><p><code>indent</code>: cell contents are a number and define indentation of following</p></li><p>                cell.</p><li><p><code>tree</code>:   same as indent, but user can open and close subtrees</p></li><p>                (treeview-like).</p></ul><li><p>Column options:</p></li><ul><li><p><code>align=&lt;value&gt;</code></p></li><ul><li><p>for <code>text</code> and <code>image</code>: content alignment within cells.</p></li><p>          Available values: <code>left</code> (default), <code>center</code>, <code>right</code>, <code>inline</code></p></ul><li><p><code>width=&lt;value&gt;</code></p></li><ul><li><p>for <code>text</code> and <code>image</code>: minimum width in em (default: <code>0</code>)</p></li><li><p>for <code>indent</code> and <code>tree</code>: indent width in em (default: <code>1.5</code>)</p></li></ul><li><p><code>padding=&lt;value&gt;</code>: padding left of the column, in em (default <code>0.5</code>).</p></li><p>      Exception: defaults to 0 for indent columns</p><li><p><code>tooltip=&lt;value&gt;</code>: tooltip text (default: empty)</p></li><li><p><code>image</code> column options:</p></li><ul><li><p><code>0=&lt;value&gt;</code> sets image for image index 0</p></li><li><p><code>1=&lt;value&gt;</code> sets image for image index 1</p></li><li><p><code>2=&lt;value&gt;</code> sets image for image index 2</p></li><li><p>and so on; defined indices need not be contiguous empty or</p></li><p>          non-numeric cells are treated as <code>0</code>.</p></ul><li><p><code>color</code> column options:</p></li><ul><li><p><code>span=&lt;value&gt;</code>: number of following columns to affect</p></li><p>          (default: infinite).</p></ul></ul></ul><br><p><b>Note</b>: do _not_ use a element name starting with <code>key_</code>; those names are</p><p>reserved to pass key press events to formspec!</p><br><h2 id="gheader158"><p>Inventory locations</p></h2><br><ul><li><p><code>&quot;context&quot;</code>: Selected node metadata (deprecated: <code>&quot;current_name&quot;</code>)</p></li><li><p><code>&quot;current_player&quot;</code>: Player to whom the menu is shown</p></li><li><p><code>&quot;player:&lt;name&gt;&quot;</code>: Any player</p></li><li><p><code>&quot;nodemeta:&lt;X&gt;,&lt;Y&gt;,&lt;Z&gt;&quot;</code>: Any node metadata</p></li><li><p><code>&quot;detached:&lt;name&gt;&quot;</code>: A detached inventory</p></li></ul><br><h2 id="gheader159"><p>Player Inventory lists</p></h2><br><ul><li><p><code>main</code>: list containing the default inventory</p></li><li><p><code>craft</code>: list containing the craft input</p></li><li><p><code>craftpreview</code>: list containing the craft output</p></li><li><p><code>hand</code>: list containing an override for the empty hand</p></li></ul><br><h2 id="gheader160"><p><code>ColorString</code></p></h2><br><p><code>#RGB</code> defines a color in hexadecimal format.</p><br><p><code>#RGBA</code> defines a color in hexadecimal format and alpha channel.</p><br><p><code>#RRGGBB</code> defines a color in hexadecimal format.</p><br><p><code>#RRGGBBAA</code> defines a color in hexadecimal format and alpha channel.</p><br><p>Named colors are also supported and are equivalent to</p><p><a href="http://dev.w3.org/csswg/css-color/#named-colors">CSS Color Module Level 4</a></p><p>To specify the value of the alpha channel, append <code>#AA</code> to the end of the color</p><p>name (e.g. <code>colorname#08</code>). For named colors the hexadecimal string</p><p>representing the alpha value must (always) be two hexadecimal digits.</p><br><h2 id="gheader161"><p><code>ColorSpec</code></p></h2><br><p>A ColorSpec specifies a 32-bit color.  It can be written in either:</p><p>table form, each element ranging from 0..255 (a, if absent, defaults to 255):</p><pre><code>`colorspec = {a=255, r=0, g=255, b=0}`
</code></pre><p>numerical form, the raw integer value of an ARGB8 quad:</p><pre><code>`colorspec = 0xFF00FF00`
</code></pre><p>or string form, a ColorString (defined above):</p><pre><code>`colorspec = &quot;green&quot;`
</code></pre><br><h2 id="gheader162"><p>Escape sequences</p></h2><br><p>Most text can contain escape sequences, that can for example color the text.</p><p>There are a few exceptions: tab headers, dropdowns and vertical labels can&#x27;t.</p><p>The following functions provide escape sequences:</p><br><ul><li><p><code>minetest.get_color_escape_sequence(color)</code>:</p></li><ul><li><p><code>color</code> is a ColorString</p></li><li><p>The escape sequence sets the text color to <code>color</code></p></li></ul><li><p><code>minetest.colorize(color, message)</code>:</p></li><ul><li><p>Equivalent to:</p></li><p>      </p><p>      message ..</p><p>      minetest.get_color_escape_sequence(&quot;#ffffff&quot;)</p></ul><li><p><code>minetest.get_background_escape_sequence(color)</code></p></li><ul><li><p><code>color</code> is a ColorString</p></li><li><p>The escape sequence sets the background of the whole text element to</p></li><p>      <code>color</code>. Only defined for item descriptions and tooltips.</p></ul><li><p><code>minetest.strip_foreground_colors(str)</code></p></li><ul><li><p>Removes foreground colors added by <code>get_color_escape_sequence</code>.</p></li></ul><li><p><code>minetest.strip_background_colors(str)</code></p></li><ul><li><p>Removes background colors added by <code>get_background_escape_sequence</code>.</p></li></ul><li><p><code>minetest.strip_colors(str)</code></p></li><ul><li><p>Removes all color escape sequences.</p></li></ul></ul><br><h2 id="gheader163"><p>Spatial Vectors</p></h2><br><p>For the following functions, <code>v</code>, <code>v1</code>, <code>v2</code> are vectors,</p><p><code>p1</code>, <code>p2</code> are positions:</p><br><ul><li><p><code>vector.new(a[, b, c])</code>:</p></li><ul><li><p>Returns a vector.</p></li><li><p>A copy of <code>a</code> if <code>a</code> is a vector.</p></li><li><p><code>{x = a, y = b, z = c}</code>, if all of <code>a</code>, <code>b</code>, <code>c</code> are defined numbers.</p></li></ul><li><p><code>vector.direction(p1, p2)</code>:</p></li><ul><li><p>Returns a vector of length 1 with direction <code>p1</code> to <code>p2</code>.</p></li><li><p>If <code>p1</code> and <code>p2</code> are identical, returns <code>{x = 0, y = 0, z = 0}</code>.</p></li></ul><li><p><code>vector.distance(p1, p2)</code>:</p></li><ul><li><p>Returns zero or a positive number, the distance between <code>p1</code> and <code>p2</code>.</p></li></ul><li><p><code>vector.length(v)</code>:</p></li><ul><li><p>Returns zero or a positive number, the length of vector <code>v</code>.</p></li></ul><li><p><code>vector.normalize(v)</code>:</p></li><ul><li><p>Returns a vector of length 1 with direction of vector <code>v</code>.</p></li><li><p>If <code>v</code> has zero length, returns <code>{x = 0, y = 0, z = 0}</code>.</p></li></ul><li><p><code>vector.floor(v)</code>:</p></li><ul><li><p>Returns a vector, each dimension rounded down.</p></li></ul><li><p><code>vector.round(v)</code>:</p></li><ul><li><p>Returns a vector, each dimension rounded to nearest integer.</p></li></ul><li><p><code>vector.apply(v, func)</code>:</p></li><ul><li><p>Returns a vector where the function <code>func</code> has been applied to each</p></li><p>      component.</p></ul><li><p><code>vector.equals(v1, v2)</code>:</p></li><ul><li><p>Returns a boolean, <code>true</code> if the vectors are identical.</p></li></ul><li><p><code>vector.sort(v1, v2)</code>:</p></li><ul><li><p>Returns in order minp, maxp vectors of the cuboid defined by <code>v1</code>, <code>v2</code>.</p></li></ul></ul><br><p>For the following functions <code>x</code> can be either a vector or a number:</p><br><ul><li><p><code>vector.add(v, x)</code>:</p></li><ul><li><p>Returns a vector.</p></li></ul><li><p><code>vector.subtract(v, x)</code>:</p></li><ul><li><p>Returns a vector.</p></li></ul><li><p><code>vector.multiply(v, x)</code>:</p></li><ul><li><p>Returns a scaled vector or Schur product.</p></li></ul><li><p><code>vector.divide(v, x)</code>:</p></li><ul><li><p>Returns a scaled vector or Schur quotient.</p></li></ul></ul><br><h2 id="gheader164"><p>Helper functions</p></h2><br><ul><li><p><code>dump2(obj, name, dumped)</code>: returns a string which makes <code>obj</code></p></li><p>  human-readable, handles reference loops.</p><ul><li><p><code>obj</code>: arbitrary variable</p></li><li><p><code>name</code>: string, default: <code>&quot;_&quot;</code></p></li><li><p><code>dumped</code>: table, default: <code>{}</code></p></li></ul><li><p><code>dump(obj, dumped)</code>: returns a string which makes <code>obj</code> human-readable</p></li><ul><li><p><code>obj</code>: arbitrary variable</p></li><li><p><code>dumped</code>: table, default: <code>{}</code></p></li></ul><li><p><code>math.hypot(x, y)</code></p></li><ul><li><p>Get the hypotenuse of a triangle with legs x and y.</p></li><p>      Useful for distance calculation.</p></ul><li><p><code>math.sign(x, tolerance)</code>: returns <code>-1</code>, <code>0</code> or <code>1</code></p></li><ul><li><p>Get the sign of a number.</p></li><li><p>tolerance: number, default: <code>0.0</code></p></li><li><p>If the absolute value of <code>x</code> is within the <code>tolerance</code> or <code>x</code> is NaN,</p></li><p>      <code>0</code> is returned.</p></ul><li><p><code>string.split(str, separator, include_empty, max_splits, sep_is_pattern)</code></p></li><ul><li><p><code>separator</code>: string, default: <code>&quot;,&quot;</code></p></li><li><p><code>include_empty</code>: boolean, default: <code>false</code></p></li><li><p><code>max_splits</code>: number, if it&#x27;s positive, splits aren&#x27;t limited,</p></li><p>      default: <code>-1</code></p><li><p><code>sep_is_pattern</code>: boolean, it specifies whether separator is a plain</p></li><p>      string or a pattern (regex), default: <code>false</code></p><li><p>e.g. <code>&quot;a,b&quot;:split&quot;,&quot;</code> returns <code>{&quot;a&quot;,&quot;b&quot;}</code></p></li></ul><li><p><code>string:trim()</code>: returns the string without whitespace pre- and suffixes</p></li><ul><li><p>e.g. <code>&quot;\n \t\tfoo bar\t &quot;:trim()</code> returns <code>&quot;foo bar&quot;</code></p></li></ul><li><p><code>minetest.wrap_text(str, limit, as_table)</code>: returns a string or table</p></li><ul><li><p>Adds newlines to the string to keep it within the specified character</p></li><p>      limit</p><li><p>Note that the returned lines may be longer than the limit since it only</p></li><p>      splits at word borders.</p><li><p><code>limit</code>: number, maximal amount of characters in one line</p></li><li><p><code>as_table</code>: boolean, if set to true, a table of lines instead of a string</p></li><p>      is returned, default: <code>false</code></p></ul><li><p><code>minetest.pos_to_string(pos, decimal_places)</code>: returns string <code>&quot;(X,Y,Z)&quot;</code></p></li><ul><li><p><code>pos</code>: table {x=X, y=Y, z=Z}</p></li><li><p>Converts the position <code>pos</code> to a human-readable, printable string</p></li><li><p><code>decimal_places</code>: number, if specified, the x, y and z values of</p></li><p>      the position are rounded to the given decimal place.</p></ul><li><p><code>minetest.string_to_pos(string)</code>: returns a position or <code>nil</code></p></li><ul><li><p>Same but in reverse.</p></li><li><p>If the string can&#x27;t be parsed to a position, nothing is returned.</p></li></ul><li><p><code>minetest.string_to_area(&quot;(X1, Y1, Z1) (X2, Y2, Z2)&quot;)</code>: returns two positions</p></li><ul><li><p>Converts a string representing an area box into two positions</p></li></ul><li><p><code>minetest.formspec_escape(string)</code>: returns a string</p></li><ul><li><p>escapes the characters &quot;[&quot;, &quot;]&quot;, &quot;\&quot;, &quot;,&quot; and &quot;;&quot;, which can not be used</p></li><p>      in formspecs.</p></ul><li><p><code>minetest.is_yes(arg)</code></p></li><ul><li><p>returns true if passed &#x27;y&#x27;, &#x27;yes&#x27;, &#x27;true&#x27; or a number that isn&#x27;t zero.</p></li></ul><li><p><code>minetest.is_nan(arg)</code></p></li><ul><li><p>returns true when the passed number represents NaN.</p></li></ul><li><p><code>minetest.get_us_time()</code></p></li><ul><li><p>returns time with microsecond precision. May not return wall time.</p></li></ul><li><p><code>table.copy(table)</code>: returns a table</p></li><ul><li><p>returns a deep copy of <code>table</code></p></li></ul><li><p><code>table.insert_all(table, other_table)</code>:</p></li><ul><li><p>Appends all values in <code>other_table</code> to <code>table</code> - uses <code>#table + 1</code> to</p></li><p>      find new indices.</p></ul><li><p><code>minetest.pointed_thing_to_face_pos(placer, pointed_thing)</code>: returns a</p></li><p>  position.</p><ul><li><p>returns the exact position on the surface of a pointed node</p></li></ul></ul><br><h2 id="gheader165"><p>Translations</p></h2><br><br><p>Texts can be translated client-side with the help of <code>minetest.translate</code> and</p><p>translation files.</p><br><h3 id="gheader166"><p>Translating a string</p></h3><p>Two functions are provided to translate strings: <code>minetest.translate</code> and</p><p><code>minetest.get_translator</code>.</p><br><ul><li><p><code>minetest.get_translator(textdomain)</code> is a simple wrapper around</p></li><p>  <code>minetest.translate</code>, and <code>minetest.get_translator(textdomain)(str, ...)</code> is</p><p>  equivalent to <code>minetest.translate(textdomain, str, ...)</code>.</p><p>  It is intended to be used in the following way, so that it avoids verbose</p><p>  repetitions of <code>minetest.translate</code>:</p></ul><br><pre><code>local S = minetest.get_translator(textdomain)
S(str, ...)
</code></pre><br><p>  As an extra commodity, if <code>textdomain</code> is nil, it is assumed to be &quot;&quot; instead.</p><br><ul><li><p><code>minetest.translate(textdomain, str, ...)</code> translates the string <code>str</code> with</p></li><p>  the given <code>textdomain</code> for disambiguation. The textdomain must match the</p><p>  textdomain specified in the translation file in order to get the string</p><p>  translated. This can be used so that a string is translated differently in</p><p>  different contexts.</p><p>  It is advised to use the name of the mod as textdomain whenever possible, to</p><p>  avoid clashes with other mods.</p><p>  This function must be given a number of arguments equal to the number of</p><p>  arguments the translated string expects.</p><p>  Arguments are literal strings -- they will not be translated, so if you want</p><p>  them to be, they need to come as outputs of <code>minetest.translate</code> as well.</p></ul><br><p>  For instance, suppose we want to translate &quot;@1 Wool&quot; with &quot;@1&quot; being replaced</p><p>  by the translation of &quot;Red&quot;. We can do the following:</p><br><pre><code>local S = minetest.get_translator()
S(&quot;@1 Wool&quot;, S(&quot;Red&quot;))
</code></pre><br><p>  This will be displayed as &quot;Red Wool&quot; on old clients and on clients that do</p><p>  not have localization enabled. However, if we have for instance a translation</p><p>  file named <code>wool.fr.tr</code> containing the following:</p><br><pre><code>@1 Wool=Laine @1
Red=Rouge
</code></pre><br><p>  this will be displayed as &quot;Laine Rouge&quot; on clients with a French locale.</p><br><h3 id="gheader167"><p>Operations on translated strings</p></h3><br><p>The output of <code>minetest.translate</code> is a string, with escape sequences adding</p><p>additional information to that string so that it can be translated on the</p><p>different clients. In particular, you can&#x27;t expect operations like string.length</p><p>to work on them like you would expect them to, or string.gsub to work in the</p><p>expected manner. However, string concatenation will still work as expected</p><p>(note that you should only use this for things like formspecs; do not translate</p><p>sentences by breaking them into parts; arguments should be used instead), and</p><p>operations such as <code>minetest.colorize</code> which are also concatenation.</p><br><h3 id="gheader168"><p>Translation file format</p></h3><p>A translation file has the suffix <code>.[lang].tr</code>, where <code>[lang]</code> is the language</p><p>it corresponds to. It must be put into the <code>locale</code> subdirectory of the mod.</p><p>The file should be a text file, with the following format:</p><br><ul><li><p>Lines beginning with <code># textdomain:</code> (the space is significant) can be used</p></li><p>  to specify the text domain of all following translations in the file.</p><li><p>All other empty lines or lines beginning with <code>#</code> are ignored.</p></li><li><p>Other lines should be in the format <code>original=translated</code>. Both <code>original</code></p></li><p>  and <code>translated</code> can contain escape sequences beginning with <code>@</code> to insert</p><p>  arguments, literal <code>@</code>, <code>=</code> or newline (See ### Escapes below).</p><p>  There must be no extraneous whitespace around the <code>=</code> or at the beginning or</p><p>  the end of the line.</p></ul><br><h3 id="gheader169"><p>Escapes</p></h3><p>Strings that need to be translated can contain several escapes, preceded by <code>@</code>.</p><br><ul><li><p><code>@@</code> acts as a literal <code>@</code>.</p></li><li><p><code>@n</code>, where <code>n</code> is a digit between 1 and 9, is an argument for the translated</p></li><p>  string that will be inlined when translation. Due to how translations are</p><p>  implemented, the original translation string <b>must</b> have its arguments in</p><p>  increasing order, without gaps or repetitions, starting from 1.</p><li><p><code>@=</code> acts as a literal <code>=</code>. It is not required in strings given to</p></li><p>  <code>minetest.translate</code>, but is in translation files to avoid being confused</p><p>  with the <code>=</code> separating the original from the translation.</p><li><p><code>@\n</code> (where the <code>\n</code> is a literal newline) acts as a literal newline.</p></li><p>  As with <code>@=</code>, this escape is not required in strings given to</p><p>  <code>minetest.translate</code>, but is in translation files.</p><li><p><code>@n</code> acts as a literal newline as well.</p></li></ul><br><h2 id="gheader170"><p>Perlin noise</p></h2><br><p>Perlin noise creates a continuously-varying value depending on the input values.</p><p>Usually in Minetest the input values are either 2D or 3D co-ordinates in nodes.</p><p>The result is used during map generation to create the terrain shape, vary heat</p><p>and humidity to distribute biomes, vary the density of decorations or vary the</p><p>structure of ores.</p><br><h3 id="gheader171"><p>Structure of perlin noise</p></h3><p>An &#x27;octave&#x27; is a simple noise generator that outputs a value between -1 and 1.</p><p>The smooth wavy noise it generates has a single characteristic scale, almost</p><p>like a &#x27;wavelength&#x27;, so on its own does not create fine detail.</p><p>Due to this perlin noise combines several octaves to create variation on</p><p>multiple scales. Each additional octave has a smaller &#x27;wavelength&#x27; than the</p><p>previous.</p><br><p>This combination results in noise varying very roughly between -2.0 and 2.0 and</p><p>with an average value of 0.0, so <code>scale</code> and <code>offset</code> are then used to multiply</p><p>and offset the noise variation.</p><br><p>The final perlin noise variation is created as follows:</p><br><p>noise = offset + scale * (octave1 +</p><pre><code>                      octave2 * persistence +
                      octave3 * persistence ^ 2 +
                      octave4 * persistence ^ 3 +
                      ...)
</code></pre><br><h2 id="gheader172"><p>Noise Parameters</p></h2><br><p>Noise Parameters are commonly called <code>NoiseParams</code>.</p><br><h3 id="gheader173"><p><code>offset</code></p></h3><p>After the multiplication by <code>scale</code> this is added to the result and is the final</p><p>step in creating the noise value.</p><p>Can be positive or negative.</p><br><h3 id="gheader174"><p><code>scale</code></p></h3><p>Once all octaves have been combined, the result is multiplied by this.</p><p>Can be positive or negative.</p><br><h3 id="gheader175"><p><code>spread</code></p></h3><p>For octave1, this is roughly the change of input value needed for a very large</p><p>variation in the noise value generated by octave1. It is almost like a</p><p>&#x27;wavelength&#x27; for the wavy noise variation.</p><p>Each additional octave has a &#x27;wavelength&#x27; that is smaller than the previous</p><p>octave, to create finer detail. <code>spread</code> will therefore roughly be the typical</p><p>size of the largest structures in the final noise variation.</p><br><p><code>spread</code> is a vector with values for x, y, z to allow the noise variation to be</p><p>stretched or compressed in the desired axes.</p><p>Values are positive numbers.</p><br><h3 id="gheader176"><p><code>seed</code></p></h3><p>This is a whole number that determines the entire pattern of the noise</p><p>variation. Altering it enables different noise patterns to be created.</p><p>With other parameters equal, different seeds produce different noise patterns</p><p>and identical seeds produce identical noise patterns.</p><br><p>For this parameter you can randomly choose any whole number. Usually it is</p><p>preferable for this to be different from other seeds, but sometimes it is useful</p><p>to be able to create identical noise patterns.</p><br><p>When used in mapgen this is actually a &#x27;seed offset&#x27;, it is added to the</p><p>&#x27;world seed&#x27; to create the seed used by the noise, to ensure the noise has a</p><p>different pattern in different worlds.</p><br><h3 id="gheader177"><p><code>octaves</code></p></h3><p>The number of simple noise generators that are combined.</p><p>A whole number, 1 or more.</p><p>Each additional octave adds finer detail to the noise but also increases the</p><p>noise calculation load.</p><p>3 is a typical minimum for a high quality, complex and natural-looking noise</p><p>variation. 1 octave has a slight &#x27;gridlike&#x27; appearence.</p><br><p>Choose the number of octaves according to the <code>spread</code> and <code>lacunarity</code>, and the</p><p>size of the finest detail you require. For example:</p><p>if <code>spread</code> is 512 nodes, <code>lacunarity</code> is 2.0 and finest detail required is 16</p><p>nodes, octaves will be 6 because the &#x27;wavelengths&#x27; of the octaves will be</p><p>512, 256, 128, 64, 32, 16 nodes.</p><p>Warning: If the &#x27;wavelength&#x27; of any octave falls below 1 an error will occur.</p><br><h3 id="gheader178"><p><code>persistence</code></p></h3><p>Each additional octave has an amplitude that is the amplitude of the previous</p><p>octave multiplied by <code>persistence</code>, to reduce the amplitude of finer details,</p><p>as is often helpful and natural to do so.</p><p>Since this controls the balance of fine detail to large-scale detail</p><p><code>persistence</code> can be thought of as the &#x27;roughness&#x27; of the noise.</p><br><p>A positive or negative non-zero number, often between 0.3 and 1.0.</p><p>A common medium value is 0.5, such that each octave has half the amplitude of</p><p>the previous octave.</p><p>This may need to be tuned when altering <code>lacunarity</code>; when doing so consider</p><p>that a common medium value is 1 / lacunarity.</p><br><h3 id="gheader179"><p><code>lacunarity</code></p></h3><p>Each additional octave has a &#x27;wavelength&#x27; that is the &#x27;wavelength&#x27; of the</p><p>previous octave multiplied by 1 / lacunarity, to create finer detail.</p><p>&#x27;lacunarity&#x27; is often 2.0 so &#x27;wavelength&#x27; often halves per octave.</p><br><p>A positive number no smaller than 1.0.</p><p>Values below 2.0 create higher quality noise at the expense of requiring more</p><p>octaves to cover a paticular range of &#x27;wavelengths&#x27;.</p><br><h3 id="gheader180"><p><code>flags</code></p></h3><p>Leave this field unset for no special handling.</p><p>Currently supported are <code>defaults</code>, <code>eased</code> and <code>absvalue</code>:</p><br><h4 id="gheader181"><p><code>defaults</code></p></h4><p>Specify this if you would like to keep auto-selection of eased/not-eased while</p><p>specifying some other flags.</p><br><h4 id="gheader182"><p><code>eased</code></p></h4><p>Maps noise gradient values onto a quintic S-curve before performing</p><p>interpolation. This results in smooth, rolling noise.</p><p>Disable this (<code>noeased</code>) for sharp-looking noise with a slightly gridded</p><p>appearence.</p><p>If no flags are specified (or defaults is), 2D noise is eased and 3D noise is</p><p>not eased.</p><p>Easing a 3D noise significantly increases the noise calculation load, so use</p><p>with restraint.</p><br><h4 id="gheader183"><p><code>absvalue</code></p></h4><p>The absolute value of each octave&#x27;s noise variation is used when combining the</p><p>octaves. The final perlin noise variation is created as follows:</p><br><p>noise = offset + scale * (abs(octave1) +</p><pre><code>                      abs(octave2) * persistence +
                      abs(octave3) * persistence ^ 2 +
                      abs(octave4) * persistence ^ 3 +
                      ...)
</code></pre><br><h3 id="gheader184"><p>Format example</p></h3><p>For 2D or 3D perlin noise or perlin noise maps:</p><br><pre><code>np_terrain = {
    offset = 0,
    scale = 1,
    spread = {x = 500, y = 500, z = 500},
    seed = 571347,
    octaves = 5,
    persist = 0.63,
    lacunarity = 2.0,
    flags = &quot;defaults, absvalue&quot;,
}
</code></pre><br><p>For 2D noise the Z component of <code>spread</code> is still defined but is ignored.</p><p>A single noise parameter table can be used for 2D or 3D noise.</p><br><h2 id="gheader185"><p>Ore types</p></h2><br><p>These tell in what manner the ore is generated.</p><br><p>All default ores are of the uniformly-distributed scatter type.</p><br><h3 id="gheader186"><p><code>scatter</code></p></h3><p>Randomly chooses a location and generates a cluster of ore.</p><br><p>If <code>noise_params</code> is specified, the ore will be placed if the 3D perlin noise</p><p>at that point is greater than the <code>noise_threshold</code>, giving the ability to</p><p>create a non-equal distribution of ore.</p><br><h3 id="gheader187"><p><code>sheet</code></p></h3><p>Creates a sheet of ore in a blob shape according to the 2D perlin noise</p><p>described by <code>noise_params</code> and <code>noise_threshold</code>. This is essentially an</p><p>improved version of the so-called &quot;stratus&quot; ore seen in some unofficial mods.</p><br><p>This sheet consists of vertical columns of uniform randomly distributed height,</p><p>varying between the inclusive range <code>column_height_min</code> and <code>column_height_max</code>.</p><p>If <code>column_height_min</code> is not specified, this parameter defaults to 1.</p><p>If <code>column_height_max</code> is not specified, this parameter defaults to <code>clust_size</code></p><p>for reverse compatibility. New code should prefer <code>column_height_max</code>.</p><br><p>The <code>column_midpoint_factor</code> parameter controls the position of the column at</p><p>which ore emanates from.</p><p>If 1, columns grow upward. If 0, columns grow downward. If 0.5, columns grow</p><p>equally starting from each direction.</p><p><code>column_midpoint_factor</code> is a decimal number ranging in value from 0 to 1. If</p><p>this parameter is not specified, the default is 0.5.</p><br><p>The ore parameters <code>clust_scarcity</code> and <code>clust_num_ores</code> are ignored for this</p><p>ore type.</p><br><h3 id="gheader188"><p><code>puff</code></p></h3><p>Creates a sheet of ore in a cloud-like puff shape.</p><br><p>As with the <code>sheet</code> ore type, the size and shape of puffs are described by</p><p><code>noise_params</code> and <code>noise_threshold</code> and are placed at random vertical</p><p>positions within the currently generated chunk.</p><br><p>The vertical top and bottom displacement of each puff are determined by the</p><p>noise parameters <code>np_puff_top</code> and <code>np_puff_bottom</code>, respectively.</p><br><h3 id="gheader189"><p><code>blob</code></p></h3><p>Creates a deformed sphere of ore according to 3d perlin noise described by</p><p><code>noise_params</code>. The maximum size of the blob is <code>clust_size</code>, and</p><p><code>clust_scarcity</code> has the same meaning as with the <code>scatter</code> type.</p><br><h3 id="gheader190"><p><code>vein</code></p></h3><p>Creates veins of ore varying in density by according to the intersection of two</p><p>instances of 3d perlin noise with different seeds, both described by</p><p><code>noise_params</code>.</p><br><p><code>random_factor</code> varies the influence random chance has on placement of an ore</p><p>inside the vein, which is <code>1</code> by default. Note that modifying this parameter</p><p>may require adjusting <code>noise_threshold</code>.</p><br><p>The parameters <code>clust_scarcity</code>, <code>clust_num_ores</code>, and <code>clust_size</code> are ignored</p><p>by this ore type.</p><br><p>This ore type is difficult to control since it is sensitive to small changes.</p><p>The following is a decent set of parameters to work from:</p><br><pre><code>noise_params = {
    offset  = 0,
    scale   = 3,
    spread  = {x=200, y=200, z=200},
    seed    = 5390,
    octaves = 4,
    persist = 0.5,
    lacunarity = 2.0,
    flags = &quot;eased&quot;,
},
noise_threshold = 1.6
</code></pre><br><p><b>WARNING</b>: Use this ore type *very* sparingly since it is ~200x more</p><p>computationally expensive than any other ore.</p><br><h3 id="gheader191"><p><code>stratum</code></p></h3><p>Creates a single undulating ore stratum that is continuous across mapchunk</p><p>borders and horizontally spans the world.</p><br><p>The 2D perlin noise described by <code>noise_params</code> defines the Y co-ordinate of</p><p>the stratum midpoint. The 2D perlin noise described by <code>np_stratum_thickness</code></p><p>defines the stratum&#x27;s vertical thickness (in units of nodes). Due to being</p><p>continuous across mapchunk borders the stratum&#x27;s vertical thickness is</p><p>unlimited.</p><br><p>If the noise parameter <code>noise_params</code> is omitted the ore will occur from y_min</p><p>to y_max in a simple horizontal stratum.</p><br><p>A parameter <code>stratum_thickness</code> can be provided instead of the noise parameter</p><p><code>np_stratum_thickness</code>, to create a constant thickness.</p><br><p>Leaving out one or both noise parameters makes the ore generation less</p><p>intensive, useful when adding multiple strata.</p><br><p><code>y_min</code> and <code>y_max</code> define the limits of the ore generation and for performance</p><p>reasons should be set as close together as possible but without clipping the</p><p>stratum&#x27;s Y variation.</p><br><p>Each node in the stratum has a 1-in-<code>clust_scarcity</code> chance of being ore, so a</p><p>solid-ore stratum would require a <code>clust_scarcity</code> of 1.</p><br><p>The parameters <code>clust_num_ores</code>, <code>clust_size</code>, <code>noise_threshold</code> and</p><p><code>random_factor</code> are ignored by this ore type.</p><br><h2 id="gheader192"><p>Ore attributes</p></h2><br><p>See section &quot;Flag Specifier Format&quot;.</p><br><p>Currently supported flags:</p><p><code>puff_cliffs</code>, <code>puff_additive_composition</code>.</p><br><h3 id="gheader193"><p><code>puff_cliffs</code></p></h3><p>If set, puff ore generation will not taper down large differences in</p><p>displacement when approaching the edge of a puff. This flag has no effect for</p><p>ore types other than <code>puff</code>.</p><br><h3 id="gheader194"><p><code>puff_additive_composition</code></p></h3><p>By default, when noise described by <code>np_puff_top</code> or <code>np_puff_bottom</code> results</p><p>in a negative displacement, the sub-column at that point is not generated. With</p><p>this attribute set, puff ore generation will instead generate the absolute</p><p>difference in noise displacement values. This flag has no effect for ore types</p><p>other than <code>puff</code>.</p><br><h2 id="gheader195"><p>Decoration types</p></h2><br><p>The varying types of decorations that can be placed.</p><br><h3 id="gheader196"><p><code>simple</code></p></h3><p>Creates a 1 times <code>H</code> times 1 column of a specified node (or a random node from</p><p>a list, if a decoration list is specified). Can specify a certain node it must</p><p>spawn next to, such as water or lava, for example. Can also generate a</p><p>decoration of random height between a specified lower and upper bound.</p><p>This type of decoration is intended for placement of grass, flowers, cacti,</p><p>papyri, waterlilies and so on.</p><br><h3 id="gheader197"><p><code>schematic</code></p></h3><p>Copies a box of <code>MapNodes</code> from a specified schematic file (or raw description).</p><p>Can specify a probability of a node randomly appearing when placed.</p><p>This decoration type is intended to be used for multi-node sized discrete</p><p>structures, such as trees, cave spikes, rocks, and so on.</p><br><h2 id="gheader198"><p>Schematic specifier</p></h2><br><p>A schematic specifier identifies a schematic by either a filename to a</p><p>Minetest Schematic file (<code>.mts</code>) or through raw data supplied through Lua,</p><p>in the form of a table.  This table specifies the following fields:</p><br><ul><li><p>The <code>size</code> field is a 3D vector containing the dimensions of the provided</p></li><p>  schematic. (required)</p><li><p>The <code>yslice_prob</code> field is a table of {ypos, prob} which sets the <code>ypos</code>th</p></li><p>  vertical slice of the schematic to have a <code>prob / 256 * 100</code> chance of</p><p>  occurring. (default: 255)</p><li><p>The <code>data</code> field is a flat table of MapNode tables making up the schematic,</p></li><p>  in the order of <code>[z [y [x]]]</code>. (required)</p><p>  Each MapNode table contains:</p><ul><li><p><code>name</code>: the name of the map node to place (required)</p></li><li><p><code>prob</code> (alias <code>param1</code>): the probability of this node being placed</p></li><p>      (default: 255)</p><li><p><code>param2</code>: the raw param2 value of the node being placed onto the map</p></li><p>      (default: 0)</p><li><p><code>force_place</code>: boolean representing if the node should forcibly overwrite</p></li><p>      any previous contents (default: false)</p></ul></ul><br><p>About probability values:</p><br><ul><li><p>A probability value of <code>0</code> or <code>1</code> means that node will never appear</p></li><p>  (0% chance).</p><li><p>A probability value of <code>254</code> or <code>255</code> means the node will always appear</p></li><p>  (100% chance).</p><li><p>If the probability value <code>p</code> is greater than <code>1</code>, then there is a</p></li><p>  <code>(p / 256 * 100)</code> percent chance that node will appear when the schematic is</p><p>  placed on the map.</p></ul><br><h2 id="gheader199"><p>Schematic attributes</p></h2><br><p>See section &quot;Flag Specifier Format&quot;.</p><br><p>Currently supported flags: <code>place_center_x</code>, <code>place_center_y</code>, <code>place_center_z</code>,</p><pre><code>                       `force_placement`.
</code></pre><br><ul><li><p><code>place_center_x</code>: Placement of this decoration is centered along the X axis.</p></li><li><p><code>place_center_y</code>: Placement of this decoration is centered along the Y axis.</p></li><li><p><code>place_center_z</code>: Placement of this decoration is centered along the Z axis.</p></li><li><p><code>force_placement</code>: Schematic nodes other than &quot;ignore&quot; will replace existing</p></li><p>  nodes.</p></ul><br><h2 id="gheader200"><p>Lua Voxel Manipulator</p></h2><br><h3 id="gheader201"><p>About VoxelManip</p></h3><p>VoxelManip is a scripting interface to the internal &#x27;Map Voxel Manipulator&#x27;</p><p>facility. The purpose of this object is for fast, low-level, bulk access to</p><p>reading and writing Map content. As such, setting map nodes through VoxelManip</p><p>will lack many of the higher level features and concepts you may be used to</p><p>with other methods of setting nodes. For example, nodes will not have their</p><p>construction and destruction callbacks run, and no rollback information is</p><p>logged.</p><br><p>It is important to note that VoxelManip is designed for speed, and *not* ease</p><p>of use or flexibility. If your mod requires a map manipulation facility that</p><p>will handle 100% of all edge cases, or the use of high level node placement</p><p>features, perhaps <code>minetest.set_node()</code> is better suited for the job.</p><br><p>In addition, VoxelManip might not be faster, or could even be slower, for your</p><p>specific use case. VoxelManip is most effective when setting large areas of map</p><p>at once - for example, if only setting a 3x3x3 node area, a</p><p><code>minetest.set_node()</code> loop may be more optimal. Always profile code using both</p><p>methods of map manipulation to determine which is most appropriate for your</p><p>usage.</p><br><p>A recent simple test of setting cubic areas showed that <code>minetest.set_node()</code></p><p>is faster than a VoxelManip for a 3x3x3 node cube or smaller.</p><br><h3 id="gheader202"><p>Using VoxelManip</p></h3><p>A VoxelManip object can be created any time using either:</p><p><code>VoxelManip([p1, p2])</code>, or <code>minetest.get_voxel_manip([p1, p2])</code>.</p><br><p>If the optional position parameters are present for either of these routines,</p><p>the specified region will be pre-loaded into the VoxelManip object on creation.</p><p>Otherwise, the area of map you wish to manipulate must first be loaded into the</p><p>VoxelManip object using <code>VoxelManip:read_from_map()</code>.</p><br><p>Note that <code>VoxelManip:read_from_map()</code> returns two position vectors. The region</p><p>formed by these positions indicate the minimum and maximum (respectively)</p><p>positions of the area actually loaded in the VoxelManip, which may be larger</p><p>than the area requested. For convenience, the loaded area coordinates can also</p><p>be queried any time after loading map data with <code>VoxelManip:get_emerged_area()</code>.</p><br><p>Now that the VoxelManip object is populated with map data, your mod can fetch a</p><p>copy of this data using either of two methods. <code>VoxelManip:get_node_at()</code>,</p><p>which retrieves an individual node in a MapNode formatted table at the position</p><p>requested is the simplest method to use, but also the slowest.</p><br><p>Nodes in a VoxelManip object may also be read in bulk to a flat array table</p><p>using:</p><br><ul><li><p><code>VoxelManip:get_data()</code> for node content (in Content ID form, see section</p></li><p>  &#x27;Content IDs&#x27;),</p><li><p><code>VoxelManip:get_light_data()</code> for node light levels, and</p></li><li><p><code>VoxelManip:get_param2_data()</code> for the node type-dependent &quot;param2&quot; values.</p></li></ul><br><p>See section &#x27;Flat array format&#x27; for more details.</p><br><p>It is very important to understand that the tables returned by any of the above</p><p>three functions represent a snapshot of the VoxelManip&#x27;s internal state at the</p><p>time of the call. This copy of the data will not magically update itself if</p><p>another function modifies the internal VoxelManip state.</p><p>Any functions that modify a VoxelManip&#x27;s contents work on the VoxelManip&#x27;s</p><p>internal state unless otherwise explicitly stated.</p><br><p>Once the bulk data has been edited to your liking, the internal VoxelManip</p><p>state can be set using:</p><br><ul><li><p><code>VoxelManip:set_data()</code> for node content (in Content ID form, see section</p></li><p>  &#x27;Content IDs&#x27;),</p><li><p><code>VoxelManip:set_light_data()</code> for node light levels, and</p></li><li><p><code>VoxelManip:set_param2_data()</code> for the node type-dependent <code>param2</code> values.</p></li></ul><br><p>The parameter to each of the above three functions can use any table at all in</p><p>the same flat array format as produced by <code>get_data()</code> etc. and is not required</p><p>to be a table retrieved from <code>get_data()</code>.</p><br><p>Once the internal VoxelManip state has been modified to your liking, the</p><p>changes can be committed back to the map by calling <code>VoxelManip:write_to_map()</code></p><h1 id="gheader203"><br></h1><br><h4 id="gheader204"><p>Flat array format</p></h4><p>Let</p><pre><code>`Nx = p2.X - p1.X + 1`,
`Ny = p2.Y - p1.Y + 1`, and
`Nz = p2.Z - p1.Z + 1`.
</code></pre><br><p>Then, for a loaded region of p1..p2, this array ranges from <code>1</code> up to and</p><p>including the value of the expression <code>Nx * Ny * Nz</code>.</p><br><p>Positions offset from p1 are present in the array with the format of:</p><h1 id="gheader205"><br></h1><br><pre><code>
[
    (0, 0, 0),   (1, 0, 0),   (2, 0, 0),   ... (Nx, 0, 0),
    (0, 1, 0),   (1, 1, 0),   (2, 1, 0),   ... (Nx, 1, 0),
    ...
    (0, Ny, 0),  (1, Ny, 0),  (2, Ny, 0),  ... (Nx, Ny, 0),
    (0, 0, 1),   (1, 0, 1),   (2, 0, 1),   ... (Nx, 0, 1),
    ...
    (0, Ny, 2),  (1, Ny, 2),  (2, Ny, 2),  ... (Nx, Ny, 2),
    ...
    (0, Ny, Nz), (1, Ny, Nz), (2, Ny, Nz), ... (Nx, Ny, Nz)
]
</code></pre><h1 id="gheader206"><br></h1><br><p>and the array index for a position p contained completely in p1..p2 is:</p><br><p><code>(p.Z - p1.Z) * Ny * Nx + (p.Y - p1.Y) * Nx + (p.X - p1.X) + 1</code></p><br><p>Note that this is the same &quot;flat 3D array&quot; format as</p><p><code>PerlinNoiseMap:get3dMap_flat()</code>.</p><p>VoxelArea objects (see section &#x27;VoxelArea&#x27;) can be used to simplify calculation</p><p>of the index for a single point in a flat VoxelManip array.</p><br><h4 id="gheader207"><p>Content IDs</p></h4><p>A Content ID is a unique integer identifier for a specific node type.</p><p>These IDs are used by VoxelManip in place of the node name string for</p><p><code>VoxelManip:get_data()</code> and <code>VoxelManip:set_data()</code>. You can use</p><p><code>minetest.get_content_id()</code> to look up the Content ID for the specified node</p><p>name, and <code>minetest.get_name_from_content_id()</code> to look up the node name string</p><p>for a given Content ID.</p><p>After registration of a node, its Content ID will remain the same throughout</p><p>execution of the mod.</p><p>Note that the node being queried needs to have already been been registered.</p><br><p>The following builtin node types have their Content IDs defined as constants:</p><br><ul><li><p><code>minetest.CONTENT_UNKNOWN</code>: ID for &quot;unknown&quot; nodes</p></li><li><p><code>minetest.CONTENT_AIR</code>:     ID for &quot;air&quot; nodes</p></li><li><p><code>minetest.CONTENT_IGNORE</code>:  ID for &quot;ignore&quot; nodes</p></li></ul><br><h4 id="gheader208"><p>Mapgen VoxelManip objects</p></h4><p>Inside of <code>on_generated()</code> callbacks, it is possible to retrieve the same</p><p>VoxelManip object used by the core&#x27;s Map Generator (commonly abbreviated</p><p>Mapgen). Most of the rules previously described still apply but with a few</p><p>differences:</p><br><ul><li><p>The Mapgen VoxelManip object is retrieved using:</p></li><p>  <code>minetest.get_mapgen_object(&quot;voxelmanip&quot;)</code></p><li><p>This VoxelManip object already has the region of map just generated loaded</p></li><p>  into it; it&#x27;s not necessary to call <code>VoxelManip:read_from_map()</code> before using</p><p>  a Mapgen VoxelManip.</p><li><p>The <code>on_generated()</code> callbacks of some mods may place individual nodes in the</p></li><p>  generated area using non-VoxelManip map modification methods. Because the</p><p>  same Mapgen VoxelManip object is passed through each <code>on_generated()</code></p><p>  callback, it becomes necessary for the Mapgen VoxelManip object to maintain</p><p>  consistency with the current map state. For this reason, calling any of the</p><p>  following functions:</p><p>  <code>minetest.add_node()</code>, <code>minetest.set_node()</code>, or <code>minetest.swap_node()</code></p><p>  will also update the Mapgen VoxelManip object&#x27;s internal state active on the</p><p>  current thread.</p><li><p>After modifying the Mapgen VoxelManip object&#x27;s internal buffer, it may be</p></li><p>  necessary to update lighting information using either:</p><p>  <code>VoxelManip:calc_lighting()</code> or <code>VoxelManip:set_lighting()</code>.</p></ul><br><h4 id="gheader209"><p>Other API functions operating on a VoxelManip</p></h4><p>If any VoxelManip contents were set to a liquid node,</p><p><code>VoxelManip:update_liquids()</code> must be called for these liquid nodes to begin</p><p>flowing. It is recommended to call this function only after having written all</p><p>buffered data back to the VoxelManip object, save for special situations where</p><p>the modder desires to only have certain liquid nodes begin flowing.</p><br><p>The functions <code>minetest.generate_ores()</code> and <code>minetest.generate_decorations()</code></p><p>will generate all registered decorations and ores throughout the full area</p><p>inside of the specified VoxelManip object.</p><br><p><code>minetest.place_schematic_on_vmanip()</code> is otherwise identical to</p><p><code>minetest.place_schematic()</code>, except instead of placing the specified schematic</p><p>directly on the map at the specified position, it will place the schematic</p><p>inside the VoxelManip.</p><br><h4 id="gheader210"><p>Notes</p></h4><ul><li><p>Attempting to read data from a VoxelManip object before map is read will</p></li><p>  result in a zero-length array table for <code>VoxelManip:get_data()</code>, and an</p><p>  &quot;ignore&quot; node at any position for <code>VoxelManip:get_node_at()</code>.</p><li><p>If either a region of map has not yet been generated or is out-of-bounds of</p></li><p>  the map, that region is filled with &quot;ignore&quot; nodes.</p><li><p>Other mods, or the core itself, could possibly modify the area of map</p></li><p>  currently loaded into a VoxelManip object. With the exception of Mapgen</p><p>  VoxelManips (see above section), the internal buffers are not updated. For</p><p>  this reason, it is strongly encouraged to complete the usage of a particular</p><p>  VoxelManip object in the same callback it had been created.</p><li><p>If a VoxelManip object will be used often, such as in an <code>on_generated()</code></p></li><p>  callback, consider passing a file-scoped table as the optional parameter to</p><p>  <code>VoxelManip:get_data()</code>, which serves as a static buffer the function can use</p><p>  to write map data to instead of returning a new table each call. This greatly</p><p>  enhances performance by avoiding unnecessary memory allocations.</p></ul><br><h3 id="gheader211"><p>Methods</p></h3><ul><li><p><code>read_from_map(p1, p2)</code>:  Loads a chunk of map into the VoxelManip object</p></li><p>  containing the region formed by <code>p1</code> and <code>p2</code>.</p><ul><li><p>returns actual emerged <code>pmin</code>, actual emerged <code>pmax</code></p></li></ul><li><p><code>write_to_map([light])</code>: Writes the data loaded from the <code>VoxelManip</code> back to</p></li><p>  the map.</p><ul><li><p><b>important</b>: data must be set using <code>VoxelManip:set_data()</code> before</p></li><p>      calling this.</p><li><p>if <code>light</code> is true, then lighting is automatically recalculated.</p></li><p>      The default value is true.</p><p>      If <code>light</code> is false, no light calculations happen, and you should correct</p><p>      all modified blocks with <code>minetest.fix_light()</code> as soon as possible.</p><p>      Keep in mind that modifying the map where light is incorrect can cause</p><p>      more lighting bugs.</p></ul><li><p><code>get_node_at(pos)</code>: Returns a <code>MapNode</code> table of the node currently loaded in</p></li><p>  the <code>VoxelManip</code> at that position</p><li><p><code>set_node_at(pos, node)</code>: Sets a specific <code>MapNode</code> in the <code>VoxelManip</code> at</p></li><p>  that position.</p><li><p><code>get_data([buffer])</code>: Retrieves the node content data loaded into the</p></li><p>  <code>VoxelManip</code> object.</p><ul><li><p>returns raw node data in the form of an array of node content IDs</p></li><li><p>if the param <code>buffer</code> is present, this table will be used to store the</p></li><p>      result instead.</p></ul><li><p><code>set_data(data)</code>: Sets the data contents of the <code>VoxelManip</code> object</p></li><li><p><code>update_map()</code>: Does nothing, kept for compatibility.</p></li><li><p><code>set_lighting(light, [p1, p2])</code>: Set the lighting within the <code>VoxelManip</code> to</p></li><p>  a uniform value.</p><ul><li><p><code>light</code> is a table, <code>{day=&lt;0...15&gt;, night=&lt;0...15&gt;}</code></p></li><li><p>To be used only by a <code>VoxelManip</code> object from</p></li><p>      <code>minetest.get_mapgen_object</code>.</p><li><p>(<code>p1</code>, <code>p2</code>) is the area in which lighting is set, defaults to the whole</p></li><p>      area if left out.</p></ul><li><p><code>get_light_data()</code>: Gets the light data read into the <code>VoxelManip</code> object</p></li><ul><li><p>Returns an array (indices 1 to volume) of integers ranging from <code>0</code> to</p></li><p>      <code>255</code>.</p><li><p>Each value is the bitwise combination of day and night light values</p></li><p>      (<code>0</code> to <code>15</code> each).</p><li><p><code>light = day + (night * 16)</code></p></li></ul><li><p><code>set_light_data(light_data)</code>: Sets the <code>param1</code> (light) contents of each node</p></li><p>  in the <code>VoxelManip</code>.</p><ul><li><p>expects lighting data in the same format that <code>get_light_data()</code> returns</p></li></ul><li><p><code>get_param2_data([buffer])</code>: Gets the raw <code>param2</code> data read into the</p></li><p>  <code>VoxelManip</code> object.</p><ul><li><p>Returns an array (indices 1 to volume) of integers ranging from <code>0</code> to</p></li><p>      <code>255</code>.</p><li><p>If the param <code>buffer</code> is present, this table will be used to store the</p></li><p>      result instead.</p></ul><li><p><code>set_param2_data(param2_data)</code>: Sets the <code>param2</code> contents of each node in</p></li><p>  the <code>VoxelManip</code>.</p><li><p><code>calc_lighting([p1, p2], [propagate_shadow])</code>:  Calculate lighting within the</p></li><p>  <code>VoxelManip</code>.</p><ul><li><p>To be used only by a <code>VoxelManip</code> object from</p></li><p>      <code>minetest.get_mapgen_object</code>.</p><li><p>(<code>p1</code>, <code>p2</code>) is the area in which lighting is set, defaults to the whole</p></li><p>      area if left out or nil.</p><li><p><code>propagate_shadow</code> is an optional boolean deciding whether shadows in a</p></li><p>      generated mapchunk above are propagated down into the mapchunk, defaults</p><p>      to <code>true</code> if left out.</p></ul><li><p><code>update_liquids()</code>: Update liquid flow</p></li><li><p><code>was_modified()</code>: Returns <code>true</code> or <code>false</code> if the data in the voxel</p></li><p>  manipulator had been modified since the last read from map, due to a call to</p><p>  <code>minetest.set_data()</code> on the loaded area elsewhere.</p><li><p><code>get_emerged_area()</code>: Returns actual emerged minimum and maximum positions.</p></li></ul><br><h3 id="gheader212"><p><code>VoxelArea</code></p></h3><p>A helper class for voxel areas.</p><p>It can be created via <code>VoxelArea:new{MinEdge=pmin, MaxEdge=pmax}</code>.</p><p>The coordinates are *inclusive*, like most other things in Minetest.</p><br><h4 id="gheader213"><p>Methods</p></h4><ul><li><p><code>getExtent()</code>: returns a 3D vector containing the size of the area formed by</p></li><p>  <code>MinEdge</code> and <code>MaxEdge</code>.</p><li><p><code>getVolume()</code>: returns the volume of the area formed by <code>MinEdge</code> and</p></li><p>  <code>MaxEdge</code>.</p><li><p><code>index(x, y, z)</code>: returns the index of an absolute position in a flat array</p></li><p>  starting at <code>1</code>.</p><ul><li><p><code>x</code>, <code>y</code> and <code>z</code> must be integers to avoid an incorrect index result.</p></li><li><p>The position (x, y, z) is not checked for being inside the area volume,</p></li><p>      being outside can cause an incorrect index result.</p><li><p>Useful for things like <code>VoxelManip</code>, raw Schematic specifiers,</p></li><p>      <code>PerlinNoiseMap:get2d</code>/<code>3dMap</code>, and so on.</p></ul><li><p><code>indexp(p)</code>: same functionality as <code>index(x, y, z)</code> but takes a vector.</p></li><ul><li><p>As with <code>index(x, y, z)</code>, the components of <code>p</code> must be integers, and <code>p</code></p></li><p>      is not checked for being inside the area volume.</p></ul><li><p><code>position(i)</code>: returns the absolute position vector corresponding to index</p></li><p>  <code>i</code>.</p><li><p><code>contains(x, y, z)</code>: check if (<code>x</code>,<code>y</code>,<code>z</code>) is inside area formed by</p></li><p>  <code>MinEdge</code> and <code>MaxEdge</code>.</p><li><p><code>containsp(p)</code>: same as above, except takes a vector</p></li><li><p><code>containsi(i)</code>: same as above, except takes an index <code>i</code></p></li><li><p><code>iter(minx, miny, minz, maxx, maxy, maxz)</code>: returns an iterator that returns</p></li><p>  indices.</p><ul><li><p>from (<code>minx</code>,<code>miny</code>,<code>minz</code>) to (<code>maxx</code>,<code>maxy</code>,<code>maxz</code>) in the order of</p></li><p>      <code>[z [y [x]]]</code>.</p></ul><li><p><code>iterp(minp, maxp)</code>: same as above, except takes a vector</p></li></ul><br><h2 id="gheader214"><p>Mapgen objects</p></h2><br><p>A mapgen object is a construct used in map generation. Mapgen objects can be</p><p>used by an <code>on_generate</code> callback to speed up operations by avoiding</p><p>unnecessary recalculations, these can be retrieved using the</p><p><code>minetest.get_mapgen_object()</code> function. If the requested Mapgen object is</p><p>unavailable, or <code>get_mapgen_object()</code> was called outside of an <code>on_generate()</code></p><p>callback, <code>nil</code> is returned.</p><br><p>The following Mapgen objects are currently available:</p><br><h3 id="gheader215"><p><code>voxelmanip</code></p></h3><p>This returns three values; the <code>VoxelManip</code> object to be used, minimum and</p><p>maximum emerged position, in that order. All mapgens support this object.</p><br><h3 id="gheader216"><p><code>heightmap</code></p></h3><p>Returns an array containing the y coordinates of the ground levels of nodes in</p><p>the most recently generated chunk by the current mapgen.</p><br><h3 id="gheader217"><p><code>biomemap</code></p></h3><p>Returns an array containing the biome IDs of nodes in the most recently</p><p>generated chunk by the current mapgen.</p><br><h3 id="gheader218"><p><code>heatmap</code></p></h3><p>Returns an array containing the temperature values of nodes in the most</p><p>recently generated chunk by the current mapgen.</p><br><h3 id="gheader219"><p><code>humiditymap</code></p></h3><p>Returns an array containing the humidity values of nodes in the most recently</p><p>generated chunk by the current mapgen.</p><br><h3 id="gheader220"><p><code>gennotify</code></p></h3><p>Returns a table mapping requested generation notification types to arrays of</p><p>positions at which the corresponding generated structures are located within</p><p>the current chunk. To set the capture of positions of interest to be recorded</p><p>on generate, use <code>minetest.set_gen_notify()</code>.</p><p>For decorations, the returned positions are the ground surface &#x27;place_on&#x27;</p><p>nodes, not the decorations themselves. A &#x27;simple&#x27; type decoration is often 1</p><p>node above the returned position and possibly displaced by &#x27;place_offset_y&#x27;.</p><br><p>Possible fields of the table returned are:</p><br><ul><li><p><code>dungeon</code></p></li><li><p><code>temple</code></p></li><li><p><code>cave_begin</code></p></li><li><p><code>cave_end</code></p></li><li><p><code>large_cave_begin</code></p></li><li><p><code>large_cave_end</code></p></li><li><p><code>decoration</code></p></li></ul><br><p>Decorations have a key in the format of <code>&quot;decoration#id&quot;</code>, where <code>id</code> is the</p><p>numeric unique decoration ID.</p><br><h2 id="gheader221"><p>Registered entities</p></h2><br><ul><li><p>Functions receive a &quot;luaentity&quot; as <code>self</code>:</p></li><ul><li><p>It has the member <code>.name</code>, which is the registered name <code>(&quot;mod:thing&quot;)</code></p></li><li><p>It has the member <code>.object</code>, which is an <code>ObjectRef</code> pointing to the</p></li><p>      object.</p><li><p>The original prototype stuff is visible directly via a metatable</p></li></ul><li><p>Callbacks:</p></li><ul><li><p><code>on_activate(self, staticdata, dtime_s)</code></p></li><ul><li><p>Called when the object is instantiated.</p></li><li><p><code>dtime_s</code> is the time passed since the object was unloaded, which can</p></li><p>          be used for updating the entity state.</p></ul><li><p><code>on_step(self, dtime)</code></p></li><ul><li><p>Called on every server tick, after movement and collision processing.</p></li><p>          <code>dtime</code> is usually 0.1 seconds, as per the <code>dedicated_server_step</code></p><p>          setting <code>in minetest.conf</code>.</p></ul><li><p><code>on_punch(self, puncher, time_from_last_punch, tool_capabilities, dir)</code></p></li><ul><li><p>Called when somebody punches the object.</p></li><li><p>Note that you probably want to handle most punches using the</p></li><p>          automatic armor group system.</p><li><p><code>puncher</code>: an <code>ObjectRef</code> (can be <code>nil</code>)</p></li><li><p><code>time_from_last_punch</code>: Meant for disallowing spamming of clicks</p></li><p>          (can be <code>nil</code>).</p><li><p><code>tool_capabilities</code>: capability table of used tool (can be <code>nil</code>)</p></li><li><p><code>dir</code>: unit vector of direction of punch. Always defined. Points from</p></li><p>          the puncher to the punched.</p></ul><li><p><code>on_death(self, killer)</code></p></li><ul><li><p>Called when the object dies.</p></li><li><p><code>killer</code>: an <code>ObjectRef</code> (can be <code>nil</code>)</p></li></ul><li><p><code>on_rightclick(self, clicker)</code></p></li><li><p><code>on_attach_child(self, child)</code></p></li><ul><li><p><code>child</code>: an <code>ObjectRef</code> of the child that attaches</p></li></ul><li><p><code>on_detach_child(self, child)</code></p></li><ul><li><p><code>child</code>: an <code>ObjectRef</code> of the child that detaches</p></li></ul><li><p><code>on_detach(self, parent)</code></p></li><ul><li><p><code>parent</code>: an <code>ObjectRef</code> (can be <code>nil</code>) from where it got detached</p></li><li><p>This happens before the parent object is removed from the world</p></li></ul><li><p><code>get_staticdata(self)</code></p></li><ul><li><p>Should return a string that will be passed to <code>on_activate</code> when</p></li><p>          the object is instantiated the next time.</p></ul></ul></ul><br><h2 id="gheader222"><p>L-system trees</p></h2><br><br><h3 id="gheader223"><p>Tree definition</p></h3><br><pre><code>treedef={
    axiom,         --string  initial tree axiom
    rules_a,       --string  rules set A
    rules_b,       --string  rules set B
    rules_c,       --string  rules set C
    rules_d,       --string  rules set D
    trunk,         --string  trunk node name
    leaves,        --string  leaves node name
    leaves2,       --string  secondary leaves node name
    leaves2_chance,--num     chance (0-100) to replace leaves with leaves2
    angle,         --num     angle in deg
    iterations,    --num     max # of iterations, usually 2 -5
    random_level,  --num     factor to lower nr of iterations, usually 0 - 3
    trunk_type,    --string  single/double/crossed) type of trunk: 1 node,
                   --        2x2 nodes or 3x3 in cross shape
    thin_branches, --boolean true -&gt; use thin (1 node) branches
    fruit,         --string  fruit node name
    fruit_chance,  --num     chance (0-100) to replace leaves with fruit node
    seed,          --num     random seed, if no seed is provided, the engine
                             will create one.
}
</code></pre><br><h3 id="gheader224"><p>Key for Special L-System Symbols used in Axioms</p></h3><br><ul><li><p><code>G</code>: move forward one unit with the pen up</p></li><li><p><code>F</code>: move forward one unit with the pen down drawing trunks and branches</p></li><li><p><code>f</code>: move forward one unit with the pen down drawing leaves (100% chance)</p></li><li><p><code>T</code>: move forward one unit with the pen down drawing trunks only</p></li><li><p><code>R</code>: move forward one unit with the pen down placing fruit</p></li><li><p><code>A</code>: replace with rules set A</p></li><li><p><code>B</code>: replace with rules set B</p></li><li><p><code>C</code>: replace with rules set C</p></li><li><p><code>D</code>: replace with rules set D</p></li><li><p><code>a</code>: replace with rules set A, chance 90%</p></li><li><p><code>b</code>: replace with rules set B, chance 80%</p></li><li><p><code>c</code>: replace with rules set C, chance 70%</p></li><li><p><code>d</code>: replace with rules set D, chance 60%</p></li><li><p><code>+</code>: yaw the turtle right by <code>angle</code> parameter</p></li><li><p><code>-</code>: yaw the turtle left by <code>angle</code> parameter</p></li><li><p><code>&amp;</code>: pitch the turtle down by <code>angle</code> parameter</p></li><li><p><code>^</code>: pitch the turtle up by <code>angle</code> parameter</p></li><li><p><code>/</code>: roll the turtle to the right by <code>angle</code> parameter</p></li><li><p><code>*</code>: roll the turtle to the left by <code>angle</code> parameter</p></li><li><p><code>[</code>: save in stack current state info</p></li><li><p><code>]</code>: recover from stack state info</p></li></ul><br><h3 id="gheader225"><p>Example</p></h3><p>Spawn a small apple tree:</p><br><pre><code>pos = {x=230,y=20,z=4}
apple_tree={
    axiom=&quot;FFFFFAFFBF&quot;,
    rules_a=&quot;[&amp;&amp;&amp;FFFFF&amp;&amp;FFFF][&amp;&amp;&amp;++++FFFFF&amp;&amp;FFFF][&amp;&amp;&amp;----FFFFF&amp;&amp;FFFF]&quot;,
    rules_b=&quot;[&amp;&amp;&amp;++FFFFF&amp;&amp;FFFF][&amp;&amp;&amp;--FFFFF&amp;&amp;FFFF][&amp;&amp;&amp;------FFFFF&amp;&amp;FFFF]&quot;,
    trunk=&quot;default:tree&quot;,
    leaves=&quot;default:leaves&quot;,
    angle=30,
    iterations=2,
    random_level=0,
    trunk_type=&quot;single&quot;,
    thin_branches=true,
    fruit_chance=10,
    fruit=&quot;default:apple&quot;
}
minetest.spawn_tree(pos,apple_tree)
</code></pre><h1 id="gheader226"><br></h1><br><h2 id="gheader227"><p><code>minetest</code> namespace reference</p></h2><br><br><h3 id="gheader228"><p>Utilities</p></h3><br><ul><li><p><code>minetest.get_current_modname()</code>: returns the currently loading mod&#x27;s name,</p></li><p>  when loading a mod.</p><li><p><code>minetest.get_modpath(modname)</code>: returns e.g.</p></li><p>  <code>&quot;/home/user/.minetest/usermods/modname&quot;</code>.</p><ul><li><p>Useful for loading additional <code>.lua</code> modules or static data from mod</p></li></ul><li><p><code>minetest.get_modnames()</code>: returns a list of installed mods</p></li><ul><li><p>Return a list of installed mods, sorted alphabetically</p></li></ul><li><p><code>minetest.get_worldpath()</code>: returns e.g. <code>&quot;/home/user/.minetest/world&quot;</code></p></li><ul><li><p>Useful for storing custom data</p></li></ul><li><p><code>minetest.is_singleplayer()</code></p></li><li><p><code>minetest.features</code>: Table containing API feature flags</p></li></ul><br><pre><code>    {
       glasslike_framed = true,
       nodebox_as_selectionbox = true,
       chat_send_player_param3 = true,
       get_all_craft_recipes_works = true,
       use_texture_alpha = true,
    -- ^ The transparency channel of textures can optionally be used on nodes
       no_legacy_abms = true,
    -- ^ Tree and grass ABMs are no longer done from C++
       texture_names_parens = true,
    -- ^ Texture grouping is possible using parentheses
       area_store_custom_ids = true,
    -- ^ Unique Area ID for AreaStore:insert_area
       add_entity_with_staticdata = true,
    -- ^ add_entity supports passing initial staticdata to on_activate
       no_chat_message_prediction = true,
    -- ^ Chat messages are no longer predicted
       object_use_texture_alpha = true
    -- ^ The transparency channel of textures can optionally be used on
    --   objects (ie: players and lua entities)
    }
</code></pre><ul><li><p><code>minetest.has_feature(arg)</code>: returns <code>boolean, missing_features</code></p></li><ul><li><p><code>arg</code>: string or table in format <code>{foo=true, bar=true}</code></p></li><li><p><code>missing_features</code>: <code>{foo=true, bar=true}</code></p></li></ul><li><p><code>minetest.get_player_information(player_name)</code>:</p></li><ul><li><p>Returns a table containing information about a player.</p></li><p>      Example return value:</p></ul></ul><br><pre><code>        {
            address = &quot;127.0.0.1&quot;,     -- IP address of client
            ip_version = 4,            -- IPv4 / IPv6
            min_rtt = 0.01,            -- minimum round trip time
            max_rtt = 0.2,             -- maximum round trip time
            avg_rtt = 0.02,            -- average round trip time
            min_jitter = 0.01,         -- minimum packet time jitter
            max_jitter = 0.5,          -- maximum packet time jitter
            avg_jitter = 0.03,         -- average packet time jitter
            connection_uptime = 200,   -- seconds since client connected
            protocol_version = 32,     -- protocol version used by client
            -- following information is available on debug build only!!!
            -- DO NOT USE IN MODS
            --ser_vers = 26,             -- serialization version used by client
            --major = 0,                 -- major version number
            --minor = 4,                 -- minor version number
            --patch = 10,                -- patch version number
            --vers_string = &quot;0.4.9-git&quot;, -- full version string
            --state = &quot;Active&quot;           -- current client state
        }
</code></pre><ul><li><p><code>minetest.mkdir(path)</code>: returns success.</p></li><ul><li><p>Creates a directory specified by <code>path</code>, creating parent directories</p></li><p>      if they don&#x27;t exist.</p></ul><li><p><code>minetest.get_dir_list(path, [is_dir])</code>: returns list of entry names</p></li><ul><li><p>is_dir is one of:</p></li><ul><li><p>nil: return all entries,</p></li><li><p>true: return only subdirectory names, or</p></li><li><p>false: return only file names.</p></li></ul></ul><li><p><code>minetest.safe_file_write(path, content)</code>: returns boolean indicating success</p></li><ul><li><p>Replaces contents of file at path with new contents in a safe (atomic)</p></li><p>      way. Use this instead of below code when writing e.g. database files:</p><p>      <code>local f = io.open(path, &quot;wb&quot;); f:write(content); f:close()</code></p></ul><li><p><code>minetest.get_version()</code>: returns a table containing components of the</p></li><p>   engine version.  Components:</p><ul><li><p><code>project</code>: Name of the project, eg, &quot;Minetest&quot;</p></li><li><p><code>string</code>: Simple version, eg, &quot;1.2.3-dev&quot;</p></li><li><p><code>hash</code>: Full git version (only set if available),</p></li><p>      eg, &quot;1.2.3-dev-01234567-dirty&quot;.</p><p>  Use this for informational purposes only. The information in the returned</p><p>  table does not represent the capabilities of the engine, nor is it</p><p>  reliable or verifiable. Compatible forks will have a different name and</p><p>  version entirely. To check for the presence of engine features, test</p><p>  whether the functions exported by the wanted features exist. For example:</p><p>  <code>if minetest.check_for_falling then ... end</code>.</p></ul><li><p><code>minetest.sha1(data, [raw])</code>: returns the sha1 hash of data</p></li><ul><li><p><code>data</code>: string of data to hash</p></li><li><p><code>raw</code>: return raw bytes instead of hex digits, default: false</p></li></ul></ul><br><h3 id="gheader229"><p>Logging</p></h3><ul><li><p><code>minetest.debug(...)</code></p></li><ul><li><p>Equivalent to <code>minetest.log(table.concat({...}, &quot;\t&quot;))</code></p></li></ul><li><p><code>minetest.log([level,] text)</code></p></li><ul><li><p><code>level</code> is one of <code>&quot;none&quot;</code>, <code>&quot;error&quot;</code>, <code>&quot;warning&quot;</code>, <code>&quot;action&quot;</code>,</p></li><p>      <code>&quot;info&quot;</code>, or <code>&quot;verbose&quot;</code>.  Default is <code>&quot;none&quot;</code>.</p></ul></ul><br><h3 id="gheader230"><p>Registration functions</p></h3><p>Call these functions only at load time!</p><br><ul><li><p><code>minetest.register_entity(name, prototype table)</code></p></li><li><p><code>minetest.register_abm(abm definition)</code></p></li><li><p><code>minetest.register_lbm(lbm definition)</code></p></li><li><p><code>minetest.register_node(name, node definition)</code></p></li><li><p><code>minetest.register_tool(name, item definition)</code></p></li><li><p><code>minetest.register_craftitem(name, item definition)</code></p></li><li><p><code>minetest.unregister_item(name)</code></p></li><li><p><code>minetest.register_alias(name, convert_to)</code></p></li><ul><li><p>Also use this to set the &#x27;mapgen aliases&#x27; needed in a game for the core</p></li><li><p>mapgens. See &#x27;Mapgen aliases&#x27; section above.</p></li></ul><li><p><code>minetest.register_alias_force(name, convert_to)</code></p></li><li><p><code>minetest.register_craft(recipe)</code></p></li><ul><li><p>Check recipe table syntax for different types below.</p></li></ul><li><p><code>minetest.clear_craft(recipe)</code></p></li><ul><li><p>Will erase existing craft based either on output item or on input recipe.</p></li><li><p>Specify either output or input only. If you specify both, input will be</p></li><p>      ignored. For input use the same recipe table syntax as for</p><p>      <code>minetest.register_craft(recipe)</code>. For output specify only the item,</p><p>      without a quantity.</p><li><p>If no erase candidate could be found, Lua exception will be thrown.</p></li><li><p><b>Warning</b>! The type field (&quot;shaped&quot;,&quot;cooking&quot; or any other) will be</p></li><p>      ignored if the recipe contains output. Erasing is then done independently</p><p>      from the crafting method.</p></ul><li><p><code>minetest.register_ore(ore definition)</code></p></li><li><p><code>minetest.register_biome(biome definition)</code></p></li><li><p><code>minetest.register_decoration(decoration definition)</code></p></li><li><p><code>minetest.override_item(name, redefinition)</code></p></li><ul><li><p>Overrides fields of an item registered with register_node/tool/craftitem.</p></li><li><p>Note: Item must already be defined, (opt)depend on the mod defining it.</p></li><li><p>Example: <code>minetest.override_item(&quot;default:mese&quot;, {light_source=LIGHT_MAX})</code></p></li></ul><li><p><code>minetest.clear_registered_ores()</code></p></li><li><p><code>minetest.clear_registered_biomes()</code></p></li><li><p><code>minetest.clear_registered_decorations()</code></p></li></ul><br><h3 id="gheader231"><p>Global callback registration functions</p></h3><p>Call these functions only at load time!</p><br><ul><li><p><code>minetest.register_globalstep(func(dtime))</code></p></li><ul><li><p>Called every server step, usually interval of 0.1s</p></li></ul><li><p><code>minetest.register_on_mods_loaded(func())</code></p></li><ul><li><p>Called after mods have finished loading and before the media is cached or the</p></li><p>      aliases handled.</p></ul><li><p><code>minetest.register_on_shutdown(func())</code></p></li><ul><li><p>Called before server shutdown</p></li><li><p><b>Warning</b>: If the server terminates abnormally (i.e. crashes), the</p></li><p>      registered callbacks <b>will likely not be run</b>. Data should be saved at</p><p>      semi-frequent intervals as well as on server shutdown.</p></ul><li><p><code>minetest.register_on_placenode(func(pos, newnode, placer, oldnode, itemstack, pointed_thing))</code></p></li><ul><li><p>Called when a node has been placed</p></li><li><p>If return <code>true</code> no item is taken from <code>itemstack</code></p></li><li><p><code>placer</code> may be any valid ObjectRef or nil.</p></li><li><p><b>Not recommended</b>; use <code>on_construct</code> or <code>after_place_node</code> in node</p></li><p>      definition whenever possible.</p></ul><li><p><code>minetest.register_on_dignode(func(pos, oldnode, digger))</code></p></li><ul><li><p>Called when a node has been dug.</p></li><li><p><b>Not recommended</b>; Use <code>on_destruct</code> or <code>after_dig_node</code> in node</p></li><p>      definition whenever possible.</p></ul><li><p><code>minetest.register_on_punchnode(func(pos, node, puncher, pointed_thing))</code></p></li><ul><li><p>Called when a node is punched</p></li></ul><li><p><code>minetest.register_on_generated(func(minp, maxp, blockseed))</code></p></li><ul><li><p>Called after generating a piece of world. Modifying nodes inside the area</p></li><p>      is a bit faster than usually.</p></ul><li><p><code>minetest.register_on_newplayer(func(ObjectRef))</code></p></li><ul><li><p>Called after a new player has been created</p></li></ul><li><p><code>minetest.register_on_punchplayer(func(player, hitter, time_from_last_punch, tool_capabilities, dir, damage))</code></p></li><ul><li><p>Called when a player is punched</p></li><li><p><code>player</code> - ObjectRef - Player that was punched</p></li><li><p><code>hitter</code> - ObjectRef - Player that hit</p></li><li><p><code>time_from_last_punch</code>: Meant for disallowing spamming of clicks</p></li><p>      (can be nil).</p><li><p><code>tool_capabilities</code>: capability table of used tool (can be nil)</p></li><li><p><code>dir</code>: unit vector of direction of punch. Always defined. Points from</p></li><p>      the puncher to the punched.</p><li><p><code>damage</code> - number that represents the damage calculated by the engine</p></li><li><p>should return <code>true</code> to prevent the default damage mechanism</p></li></ul><li><p><code>minetest.register_on_player_hpchange(func(player, hp_change, reason), modifier)</code></p></li><ul><li><p>Called when the player gets damaged or healed</p></li><li><p><code>player</code>: ObjectRef of the player</p></li><li><p><code>hp_change</code>: the amount of change. Negative when it is damage.</p></li><li><p><code>reason</code>: a PlayerHPChangeReason table.</p></li><ul><li><p>The <code>type</code> field will have one of the following values:</p></li><ul><ul><li><p><code>set_hp</code> - A mod or the engine called <code>set_hp</code> without</p></li><p>                         giving a type - use this for custom damage types.</p><li><p><code>punch</code> - Was punched. <code>reason.object</code> will hold the puncher, or nil if none.</p></li><li><p><code>fall</code></p></li><li><p><code>node_damage</code> - damage_per_second from a neighbouring node.</p></li><li><p><code>drown</code></p></li><li><p><code>respawn</code></p></li></ul></ul><li><p>Any of the above types may have additional fields from mods.</p></li><li><p><code>reason.from</code> will be <code>mod</code> or <code>engine</code>.</p></li></ul><li><p><code>modifier</code>: when true, the function should return the actual <code>hp_change</code>.</p></li><p>       Note: modifiers only get a temporary hp_change that can be modified by later modifiers.</p><p>       modifiers can return true as a second argument to stop the execution of further functions.</p><p>       Non-modifiers receive the final hp change calculated by the modifiers.</p></ul><li><p><code>minetest.register_on_dieplayer(func(ObjectRef, reason))</code></p></li><ul><li><p>Called when a player dies</p></li><li><p><code>reason</code>: a PlayerHPChangeReason table, see register_on_player_hpchange</p></li></ul><li><p><code>minetest.register_on_respawnplayer(func(ObjectRef))</code></p></li><ul><li><p>Called when player is to be respawned</p></li><li><p>Called _before_ repositioning of player occurs</p></li><li><p>return true in func to disable regular player placement</p></li></ul><li><p><code>minetest.register_on_prejoinplayer(func(name, ip))</code></p></li><ul><li><p>Called before a player joins the game</p></li><li><p>If it returns a string, the player is disconnected with that string as</p></li><p>      reason.</p></ul><li><p><code>minetest.register_on_joinplayer(func(ObjectRef))</code></p></li><ul><li><p>Called when a player joins the game</p></li></ul><li><p><code>minetest.register_on_leaveplayer(func(ObjectRef, timed_out))</code></p></li><ul><li><p>Called when a player leaves the game</p></li><li><p><code>timed_out</code>: True for timeout, false for other reasons.</p></li></ul><li><p><code>minetest.register_on_auth_fail(func(name, ip))</code></p></li><ul><li><p>Called when a client attempts to log into an account but supplies the</p></li><p>      wrong password.</p><li><p><code>ip</code>: The IP address of the client.</p></li><li><p><code>name</code>: The account the client attempted to log into.</p></li></ul><li><p><code>minetest.register_on_cheat(func(ObjectRef, cheat))</code></p></li><ul><li><p>Called when a player cheats</p></li><li><p><code>cheat</code>: <code>{type=&lt;cheat_type&gt;}</code>, where <code>&lt;cheat_type&gt;</code> is one of:</p></li><ul><li><p><code>moved_too_fast</code></p></li><li><p><code>interacted_too_far</code></p></li><li><p><code>interacted_while_dead</code></p></li><li><p><code>finished_unknown_dig</code></p></li><li><p><code>dug_unbreakable</code></p></li><li><p><code>dug_too_fast</code></p></li></ul></ul><li><p><code>minetest.register_on_chat_message(func(name, message))</code></p></li><ul><li><p>Called always when a player says something</p></li><li><p>Return <code>true</code> to mark the message as handled, which means that it will</p></li><p>      not be sent to other players.</p></ul><li><p><code>minetest.register_on_player_receive_fields(func(player, formname, fields))</code></p></li><ul><li><p>Called when a button is pressed in player&#x27;s inventory form</p></li><li><p>Newest functions are called first</p></li><li><p>If function returns <code>true</code>, remaining functions are not called</p></li></ul><li><p><code>minetest.register_on_craft(func(itemstack, player, old_craft_grid, craft_inv))</code></p></li><ul><li><p>Called when <code>player</code> crafts something</p></li><li><p><code>itemstack</code> is the output</p></li><li><p><code>old_craft_grid</code> contains the recipe (Note: the one in the inventory is</p></li><p>      cleared).</p><li><p><code>craft_inv</code> is the inventory with the crafting grid</p></li><li><p>Return either an <code>ItemStack</code>, to replace the output, or <code>nil</code>, to not</p></li><p>      modify it.</p></ul><li><p><code>minetest.register_craft_predict(func(itemstack, player, old_craft_grid, craft_inv))</code></p></li><ul><li><p>The same as before, except that it is called before the player crafts, to</p></li><p>      make craft prediction, and it should not change anything.</p></ul><li><p><code>minetest.register_allow_player_inventory_action(func(player, inventory, action, inventory_info))</code></p></li><ul><li><p>Determinates how much of a stack may be taken, put or moved to a</p></li><p>      player inventory.</p><li><p><code>player</code> (type <code>ObjectRef</code>) is the player who modified the inventory</p></li><p>      <code>inventory</code> (type <code>InvRef</code>).</p><li><p>List of possible <code>action</code> (string) values and their</p></li><p>      <code>inventory_info</code> (table) contents:</p><ul><li><p><code>move</code>: <code>{from_list=string, to_list=string, from_index=number, to_index=number, count=number}</code></p></li><li><p><code>put</code>:  <code>{listname=string, index=number, stack=ItemStack}</code></p></li><li><p><code>take</code>: Same as <code>put</code></p></li></ul><li><p>Return a numeric value to limit the amount of items to be taken, put or</p></li><p>      moved. A value of <code>-1</code> for <code>take</code> will make the source stack infinite.</p></ul><li><p><code>minetest.register_on_player_inventory_action(func(player, inventory, action, inventory_info))</code></p></li><ul><li><p>Called after a take, put or move event from/to/in a player inventory</p></li><li><p>Function arguments: see <code>minetest.register_allow_player_inventory_action</code></p></li><li><p>Does not accept or handle any return value.</p></li></ul><li><p><code>minetest.register_on_protection_violation(func(pos, name))</code></p></li><ul><li><p>Called by <code>builtin</code> and mods when a player violates protection at a</p></li><p>      position (eg, digs a node or punches a protected entity).</p><li><p>The registered functions can be called using</p></li><p>      <code>minetest.record_protection_violation</code>.</p><li><p>The provided function should check that the position is protected by the</p></li><p>      mod calling this function before it prints a message, if it does, to</p><p>      allow for multiple protection mods.</p></ul><li><p><code>minetest.register_on_item_eat(func(hp_change, replace_with_item, itemstack, user, pointed_thing))</code></p></li><ul><li><p>Called when an item is eaten, by <code>minetest.item_eat</code></p></li><li><p>Return <code>true</code> or <code>itemstack</code> to cancel the default item eat response</p></li><p>      (i.e.: hp increase).</p></ul><li><p><code>minetest.register_on_priv_grant(function(name, granter, priv))</code></p></li><ul><li><p>Called when <code>granter</code> grants the priv <code>priv</code> to <code>name</code>.</p></li><li><p>Note that the callback will be called twice if it&#x27;s done by a player,</p></li><p>      once with granter being the player name, and again with granter being nil.</p></ul><li><p><code>minetest.register_on_priv_revoke(function(name, revoker, priv))</code></p></li><ul><li><p>Called when <code>revoker</code> revokes the priv <code>priv</code> from <code>name</code>.</p></li><li><p>Note that the callback will be called twice if it&#x27;s done by a player,</p></li><p>      once with revoker being the player name, and again with revoker being nil.</p></ul><li><p><code>minetest.register_can_bypass_userlimit(function(name, ip))</code></p></li><ul><li><p>Called when <code>name</code> user connects with <code>ip</code>.</p></li><li><p>Return <code>true</code> to by pass the player limit</p></li></ul><li><p><code>minetest.register_on_modchannel_message(func(channel_name, sender, message))</code></p></li><ul><li><p>Called when an incoming mod channel message is received</p></li><li><p>You should have joined  some channels to receive events.</p></li><li><p>If message comes from a server mod, <code>sender</code> field is an empty string.</p></li></ul></ul><br><h3 id="gheader232"><p>Other registration functions</p></h3><ul><li><p><code>minetest.register_chatcommand(cmd, chatcommand definition)</code></p></li><ul><li><p>Adds definition to <code>minetest.registered_chatcommands</code></p></li></ul><li><p><code>minetest.override_chatcommand(name, redefinition)</code></p></li><ul><li><p>Overrides fields of a chatcommand registered with <code>register_chatcommand</code>.</p></li></ul><li><p><code>minetest.unregister_chatcommand(name)</code></p></li><ul><li><p>Unregisters a chatcommands registered with <code>register_chatcommand</code>.</p></li></ul><li><p><code>minetest.register_privilege(name, definition)</code></p></li><ul><li><p><code>definition</code>: <code>&quot;description text&quot;</code></p></li><li><p><code>definition</code>:</p></li><p>      <code>{description = &quot;description text&quot;, give_to_singleplayer = boolean}</code></p><p>      the default of <code>give_to_singleplayer</code> is true.</p><li><p>To allow players with <code>basic_privs</code> to grant, see <code>basic_privs</code></p></li><p>      minetest.conf setting.</p><li><p><code>on_grant(name, granter_name)</code>: Called when given to player <code>name</code> by</p></li><p>      <code>granter_name</code>.</p><p>      <code>granter_name</code> will be nil if the priv was granted by a mod.</p><li><p><code>on_revoke(name, revoker_name)</code>: Called when taken from player <code>name</code> by</p></li><p>      <code>revoker_name</code>.</p><p>      <code>revoker_name</code> will be nil if the priv was revoked by a mod</p><li><p>Note that the above two callbacks will be called twice if a player is</p></li><p>      responsible, once with the player name, and then with a nil player name.</p><li><p>Return true in the above callbacks to stop register_on_priv_grant or</p></li><p>      revoke being called.</p></ul><li><p><code>minetest.register_authentication_handler(authentication handler definition)</code></p></li><ul><li><p>Registers an auth handler that overrides the builtin one</p></li><li><p>This function can be called by a single mod once only.</p></li></ul></ul><br><h3 id="gheader233"><p>Setting-related</p></h3><ul><li><p><code>minetest.settings</code>: Settings object containing all of the settings from the</p></li><p>  main config file (<code>minetest.conf</code>).</p><li><p><code>minetest.setting_get_pos(name)</code>: Loads a setting from the main settings and</p></li><p>  parses it as a position (in the format <code>(1,2,3)</code>). Returns a position or nil.</p></ul><br><h3 id="gheader234"><p>Authentication</p></h3><ul><li><p><code>minetest.string_to_privs(str)</code>: returns <code>{priv1=true,...}</code></p></li><li><p><code>minetest.privs_to_string(privs)</code>: returns <code>&quot;priv1,priv2,...&quot;</code></p></li><ul><li><p>Convert between two privilege representations</p></li></ul><li><p><code>minetest.get_player_privs(name) -&gt; {priv1=true,...}</code></p></li><li><p><code>minetest.check_player_privs(player_or_name, ...)</code>:</p></li><p>  returns <code>bool, missing_privs</code></p><ul><li><p>A quickhand for checking privileges.</p></li><li><p><code>player_or_name</code>: Either a Player object or the name of a player.</p></li><li><p><code>...</code> is either a list of strings, e.g. <code>&quot;priva&quot;, &quot;privb&quot;</code> or</p></li><p>      a table, e.g. <code>{ priva = true, privb = true }</code>.</p></ul></ul><br><ul><li><p><code>minetest.check_password_entry(name, entry, password)</code></p></li><ul><li><p>Returns true if the &quot;password entry&quot; for a player with name matches given</p></li><p>      password, false otherwise.</p><li><p>The &quot;password entry&quot; is the password representation generated by the</p></li><p>      engine as returned as part of a <code>get_auth()</code> call on the auth handler.</p><li><p>Only use this function for making it possible to log in via password from</p></li><p>      external protocols such as IRC, other uses are frowned upon.</p></ul><li><p><code>minetest.get_password_hash(name, raw_password)</code></p></li><ul><li><p>Convert a name-password pair to a password hash that Minetest can use.</p></li><li><p>The returned value alone is not a good basis for password checks based</p></li><p>      on comparing the password hash in the database with the password hash</p><p>      from the function, with an externally provided password, as the hash</p><p>      in the db might use the new SRP verifier format.</p><li><p>For this purpose, use <code>minetest.check_password_entry</code> instead.</p></li></ul><li><p><code>minetest.get_player_ip(name)</code>: returns an IP address string for the player</p></li><p>  <code>name</code>.</p><ul><li><p>The player needs to be online for this to be successful.</p></li></ul></ul><br><ul><li><p><code>minetest.get_auth_handler()</code>: Return the currently active auth handler</p></li><ul><li><p>See the <code>Authentication handler definition</code></p></li><li><p>Use this to e.g. get the authentication data for a player:</p></li><p>      <code>local auth_data = minetest.get_auth_handler().get_auth(playername)</code></p></ul><li><p><code>minetest.notify_authentication_modified(name)</code></p></li><ul><li><p>Must be called by the authentication handler for privilege changes.</p></li><li><p><code>name</code>: string; if omitted, all auth data should be considered modified</p></li></ul><li><p><code>minetest.set_player_password(name, password_hash)</code>: Set password hash of</p></li><p>  player <code>name</code>.</p><li><p><code>minetest.set_player_privs(name, {priv1=true,...})</code>: Set privileges of player</p></li><p>  <code>name</code>.</p><li><p><code>minetest.auth_reload()</code></p></li><ul><li><p>See <code>reload()</code> in authentication handler definition</p></li></ul></ul><br><p><code>minetest.set_player_password</code>, <code>minetest_set_player_privs</code>,</p><p><code>minetest_get_player_privs</code> and <code>minetest.auth_reload</code> call the authentication</p><p>handler.</p><br><h3 id="gheader235"><p>Chat</p></h3><ul><li><p><code>minetest.chat_send_all(text)</code></p></li><li><p><code>minetest.chat_send_player(name, text)</code></p></li></ul><br><h3 id="gheader236"><p>Environment access</p></h3><ul><li><p><code>minetest.set_node(pos, node)</code></p></li><li><p><code>minetest.add_node(pos, node): alias to </code>minetest.set_node</p></li><ul><li><p>Set node at position <code>pos</code></p></li><li><p><code>node</code>: table <code>{name=string, param1=number, param2=number}</code></p></li><li><p>If param1 or param2 is omitted, it&#x27;s set to <code>0</code>.</p></li><li><p>e.g. <code>minetest.set_node({x=0, y=10, z=0}, {name=&quot;default:wood&quot;})</code></p></li></ul><li><p><code>minetest.bulk_set_node({pos1, pos2, pos3, ...}, node)</code></p></li><ul><li><p>Set node on all positions set in the first argument.</p></li><li><p>e.g. <code>minetest.bulk_set_node({{x=0, y=1, z=1}, {x=1, y=2, z=2}}, {name=&quot;default:stone&quot;})</code></p></li><li><p>For node specification or position syntax see <code>minetest.set_node</code> call</p></li><li><p>Faster than set_node due to single call, but still considerably slower</p></li><p>      than Lua Voxel Manipulators (LVM) for large numbers of nodes.</p><p>      Unlike LVMs, this will call node callbacks. It also allows setting nodes</p><p>      in spread out positions which would cause LVMs to waste memory.</p><p>      For setting a cube, this is 1.3x faster than set_node whereas LVM is 20</p><p>      times faster.</p></ul><li><p><code>minetest.swap_node(pos, node)</code></p></li><ul><li><p>Set node at position, but don&#x27;t remove metadata</p></li></ul><li><p><code>minetest.remove_node(pos)</code></p></li><ul><li><p>By default it does the same as <code>minetest.set_node(pos, {name=&quot;air&quot;})</code></p></li></ul><li><p><code>minetest.get_node(pos)</code></p></li><ul><li><p>Returns the node at the given position as table in the format</p></li><p>      <code>{name=&quot;node_name&quot;, param1=0, param2=0}</code>,</p><p>      returns <code>{name=&quot;ignore&quot;, param1=0, param2=0}</code> for unloaded areas.</p></ul><li><p><code>minetest.get_node_or_nil(pos)</code></p></li><ul><li><p>Same as <code>get_node</code> but returns <code>nil</code> for unloaded areas.</p></li></ul><li><p><code>minetest.get_node_light(pos, timeofday)</code></p></li><ul><li><p>Gets the light value at the given position. Note that the light value</p></li><p>      &quot;inside&quot; the node at the given position is returned, so you usually want</p><p>      to get the light value of a neighbor.</p><li><p><code>pos</code>: The position where to measure the light.</p></li><li><p><code>timeofday</code>: <code>nil</code> for current time, <code>0</code> for night, <code>0.5</code> for day</p></li><li><p>Returns a number between <code>0</code> and <code>15</code> or <code>nil</code></p></li></ul><li><p><code>minetest.place_node(pos, node)</code></p></li><ul><li><p>Place node with the same effects that a player would cause</p></li></ul><li><p><code>minetest.dig_node(pos)</code></p></li><ul><li><p>Dig node with the same effects that a player would cause</p></li><li><p>Returns <code>true</code> if successful, <code>false</code> on failure (e.g. protected location)</p></li></ul><li><p><code>minetest.punch_node(pos)</code></p></li><ul><li><p>Punch node with the same effects that a player would cause</p></li></ul><li><p><code>minetest.spawn_falling_node(pos)</code></p></li><ul><li><p>Change node into falling node</p></li><li><p>Returns <code>true</code> if successful, <code>false</code> on failure</p></li></ul></ul><br><ul><li><p><code>minetest.find_nodes_with_meta(pos1, pos2)</code></p></li><ul><li><p>Get a table of positions of nodes that have metadata within a region</p></li><p>      {pos1, pos2}.</p></ul><li><p><code>minetest.get_meta(pos)</code></p></li><ul><li><p>Get a <code>NodeMetaRef</code> at that position</p></li></ul><li><p><code>minetest.get_node_timer(pos)</code></p></li><ul><li><p>Get <code>NodeTimerRef</code></p></li></ul></ul><br><ul><li><p><code>minetest.add_entity(pos, name, [staticdata])</code>: Spawn Lua-defined entity at</p></li><p>  position.</p><ul><li><p>Returns <code>ObjectRef</code>, or <code>nil</code> if failed</p></li></ul><li><p><code>minetest.add_item(pos, item)</code>: Spawn item</p></li><ul><li><p>Returns <code>ObjectRef</code>, or <code>nil</code> if failed</p></li></ul><li><p><code>minetest.get_player_by_name(name)</code>: Get an <code>ObjectRef</code> to a player</p></li><li><p><code>minetest.get_objects_inside_radius(pos, radius)</code>: returns a list of</p></li><p>  ObjectRefs.</p><ul><li><p><code>radius</code>: using an euclidean metric</p></li></ul><li><p><code>minetest.set_timeofday(val)</code></p></li><ul><li><p><code>val</code> is between <code>0</code> and <code>1</code>; <code>0</code> for midnight, <code>0.5</code> for midday</p></li></ul><li><p><code>minetest.get_timeofday()</code></p></li><li><p><code>minetest.get_gametime()</code>: returns the time, in seconds, since the world was</p></li><p>  created.</p><li><p><code>minetest.get_day_count()</code>: returns number days elapsed since world was</p></li><p>  created.</p><ul><li><p>accounts for time changes.</p></li></ul><li><p><code>minetest.find_node_near(pos, radius, nodenames, [search_center])</code>: returns</p></li><p>  pos or <code>nil</code>.</p><ul><li><p><code>radius</code>: using a maximum metric</p></li><li><p><code>nodenames</code>: e.g. <code>{&quot;ignore&quot;, &quot;group:tree&quot;}</code> or <code>&quot;default:dirt&quot;</code></p></li><li><p><code>search_center</code> is an optional boolean (default: <code>false</code>)</p></li><p>      If true <code>pos</code> is also checked for the nodes</p></ul><li><p><code>minetest.find_nodes_in_area(pos1, pos2, nodenames)</code>: returns a list of</p></li><p>  positions.</p><ul><li><p><code>nodenames</code>: e.g. <code>{&quot;ignore&quot;, &quot;group:tree&quot;}</code> or <code>&quot;default:dirt&quot;</code></p></li><li><p>First return value: Table with all node positions</p></li><li><p>Second return value: Table with the count of each node with the node name</p></li><p>      as index.</p><li><p>Area volume is limited to 4,096,000 nodes</p></li></ul><li><p><code>minetest.find_nodes_in_area_under_air(pos1, pos2, nodenames)</code>: returns a</p></li><p>  list of positions.</p><ul><li><p><code>nodenames</code>: e.g. <code>{&quot;ignore&quot;, &quot;group:tree&quot;}</code> or <code>&quot;default:dirt&quot;</code></p></li><li><p>Return value: Table with all node positions with a node air above</p></li><li><p>Area volume is limited to 4,096,000 nodes</p></li></ul><li><p><code>minetest.get_perlin(noiseparams)</code></p></li><li><p><code>minetest.get_perlin(seeddiff, octaves, persistence, scale)</code></p></li><ul><li><p>Return world-specific perlin noise (<code>int(worldseed)+seeddiff</code>)</p></li></ul><li><p><code>minetest.get_voxel_manip([pos1, pos2])</code></p></li><ul><li><p>Return voxel manipulator object.</p></li><li><p>Loads the manipulator from the map if positions are passed.</p></li></ul><li><p><code>minetest.set_gen_notify(flags, {deco_ids})</code></p></li><ul><li><p>Set the types of on-generate notifications that should be collected.</p></li><li><p><code>flags</code> is a flag field with the available flags:</p></li><ul><li><p>dungeon</p></li><li><p>temple</p></li><li><p>cave_begin</p></li><li><p>cave_end</p></li><li><p>large_cave_begin</p></li><li><p>large_cave_end</p></li><li><p>decoration</p></li></ul><li><p>The second parameter is a list of IDS of decorations which notification</p></li><p>      is requested for.</p></ul><li><p><code>minetest.get_gen_notify()</code></p></li><ul><li><p>Returns a flagstring and a table with the <code>deco_id</code>s.</p></li></ul><li><p></p></li><ul><li><p>Returns the decoration ID number for the provided decoration name string,</p></li><p>      or <code>nil</code> on failure.</p></ul><li><p><code>minetest.get_mapgen_object(objectname)</code></p></li><ul><li><p>Return requested mapgen object if available (see &quot;Mapgen objects&quot;)</p></li></ul><li><p><code>minetest.get_heat(pos)</code></p></li><ul><li><p>Returns the heat at the position, or <code>nil</code> on failure.</p></li></ul><li><p><code>minetest.get_humidity(pos)</code></p></li><ul><li><p>Returns the humidity at the position, or <code>nil</code> on failure.</p></li></ul><li><p><code>minetest.get_biome_data(pos)</code></p></li><ul><li><p>Returns a table containing:</p></li><ul><li><p><code>biome</code> the biome id of the biome at that position</p></li><li><p><code>heat</code> the heat at the position</p></li><li><p><code>humidity</code> the humidity at the position</p></li></ul><li><p>Or returns <code>nil</code> on failure.</p></li></ul><li><p><code>minetest.get_biome_id(biome_name)</code></p></li><ul><li><p>Returns the biome id, as used in the biomemap Mapgen object and returned</p></li><p>      by <code>minetest.get_biome_data(pos)</code>, for a given biome_name string.</p></ul><li><p><code>minetest.get_biome_name(biome_id)</code></p></li><ul><li><p>Returns the biome name string for the provided biome id, or <code>nil</code> on</p></li><p>      failure.</p><li><p>If no biomes have been registered, such as in mgv6, returns <code>default</code>.</p></li></ul><li><p><code>minetest.get_mapgen_params()</code></p></li><ul><li><p>Deprecated: use <code>minetest.get_mapgen_setting(name)</code> instead.</p></li><li><p>Returns a table containing:</p></li><ul><li><p><code>mgname</code></p></li><li><p><code>seed</code></p></li><li><p><code>chunksize</code></p></li><li><p><code>water_level</code></p></li><li><p><code>flags</code></p></li></ul></ul><li><p><code>minetest.set_mapgen_params(MapgenParams)</code></p></li><ul><li><p>Deprecated: use <code>minetest.set_mapgen_setting(name, value, override)</code></p></li><p>      instead.</p><li><p>Set map generation parameters.</p></li><li><p>Function cannot be called after the registration period; only</p></li><p>      initialization and <code>on_mapgen_init</code>.</p><li><p>Takes a table as an argument with the fields:</p></li><ul><li><p><code>mgname</code></p></li><li><p><code>seed</code></p></li><li><p><code>chunksize</code></p></li><li><p><code>water_level</code></p></li><li><p><code>flags</code></p></li></ul><li><p>Leave field unset to leave that parameter unchanged.</p></li><li><p><code>flags</code> contains a comma-delimited string of flags to set, or if the</p></li><p>      prefix <code>&quot;no&quot;</code> is attached, clears instead.</p><li><p><code>flags</code> is in the same format and has the same options as <code>mg_flags</code> in</p></li><p>      <code>minetest.conf</code>.</p></ul><li><p><code>minetest.get_mapgen_setting(name)</code></p></li><ul><li><p>Gets the *active* mapgen setting (or nil if none exists) in string</p></li><p>      format with the following order of precedence:</p><p>        1) Settings loaded from map_meta.txt or overrides set during mod</p><p>           execution.</p><p>        2) Settings set by mods without a metafile override</p><p>        3) Settings explicitly set in the user config file, minetest.conf</p><p>        4) Settings set as the user config default</p></ul><li><p><code>minetest.get_mapgen_setting_noiseparams(name)</code></p></li><ul><li><p>Same as above, but returns the value as a NoiseParams table if the</p></li><p>      setting <code>name</code> exists and is a valid NoiseParams.</p></ul><li><p><code>minetest.set_mapgen_setting(name, value, [override_meta])</code></p></li><ul><li><p>Sets a mapgen param to <code>value</code>, and will take effect if the corresponding</p></li><p>      mapgen setting is not already present in map_meta.txt.</p><li><p><code>override_meta</code> is an optional boolean (default: <code>false</code>). If this is set</p></li><p>      to true, the setting will become the active setting regardless of the map</p><p>      metafile contents.</p><li><p>Note: to set the seed, use <code>&quot;seed&quot;</code>, not <code>&quot;fixed_map_seed&quot;</code>.</p></li></ul><li><p><code>minetest.set_mapgen_setting_noiseparams(name, value, [override_meta])</code></p></li><ul><li><p>Same as above, except value is a NoiseParams table.</p></li></ul><li><p><code>minetest.set_noiseparams(name, noiseparams, set_default)</code></p></li><ul><li><p>Sets the noiseparams setting of <code>name</code> to the noiseparams table specified</p></li><p>      in <code>noiseparams</code>.</p><li><p><code>set_default</code> is an optional boolean (default: <code>true</code>) that specifies</p></li><p>      whether the setting should be applied to the default config or current</p><p>      active config.</p></ul><li><p><code>minetest.get_noiseparams(name)</code></p></li><ul><li><p>Returns a table of the noiseparams for name.</p></li></ul><li><p><code>minetest.generate_ores(vm, pos1, pos2)</code></p></li><ul><li><p>Generate all registered ores within the VoxelManip <code>vm</code> and in the area</p></li><p>      from <code>pos1</code> to <code>pos2</code>.</p><li><p><code>pos1</code> and <code>pos2</code> are optional and default to mapchunk minp and maxp.</p></li></ul><li><p><code>minetest.generate_decorations(vm, pos1, pos2)</code></p></li><ul><li><p>Generate all registered decorations within the VoxelManip <code>vm</code> and in the</p></li><p>      area from <code>pos1</code> to <code>pos2</code>.</p><li><p><code>pos1</code> and <code>pos2</code> are optional and default to mapchunk minp and maxp.</p></li></ul><li><p><code>minetest.clear_objects([options])</code></p></li><ul><li><p>Clear all objects in the environment</p></li><li><p>Takes an optional table as an argument with the field <code>mode</code>.</p></li><ul><li><p>mode = <code>&quot;full&quot;</code> : Load and go through every mapblock, clearing</p></li><p>                            objects (default).</p><li><p>mode = <code>&quot;quick&quot;</code>: Clear objects immediately in loaded mapblocks,</p></li><p>                            clear objects in unloaded mapblocks only when the</p><p>                            mapblocks are next activated.</p></ul></ul><li><p><code>minetest.emerge_area(pos1, pos2, [callback], [param])</code></p></li><ul><li><p>Queue all blocks in the area from <code>pos1</code> to <code>pos2</code>, inclusive, to be</p></li><p>      asynchronously fetched from memory, loaded from disk, or if inexistent,</p><p>      generates them.</p><li><p>If <code>callback</code> is a valid Lua function, this will be called for each block</p></li><p>      emerged.</p><li><p>The function signature of callback is:</p></li><ul><li><p><code>function EmergeAreaCallback(blockpos, action, calls_remaining, param)</code></p></li><ul><ul><li><p><code>blockpos</code> is the *block* coordinates of the block that had been</p></li><p>              emerged.</p><li><p><code>action</code> could be one of the following constant values:</p></li><ul><li><p><code>minetest.EMERGE_CANCELLED</code></p></li><li><p><code>minetest.EMERGE_ERRORED</code></p></li><li><p><code>minetest.EMERGE_FROM_MEMORY</code></p></li><li><p><code>minetest.EMERGE_FROM_DISK</code></p></li><li><p><code>minetest.EMERGE_GENERATED</code></p></li></ul><li><p><code>calls_remaining</code> is the number of callbacks to be expected after</p></li><p>              this one.</p><li><p><code>param</code> is the user-defined parameter passed to emerge_area (or</p></li><p>              nil if the parameter was absent).</p></ul></ul></ul></ul><li><p><code>minetest.delete_area(pos1, pos2)</code></p></li><ul><li><p>delete all mapblocks in the area from pos1 to pos2, inclusive</p></li></ul><li><p><code>minetest.line_of_sight(pos1, pos2)</code>: returns <code>boolean, pos</code></p></li><ul><li><p>Checks if there is anything other than air between pos1 and pos2.</p></li><li><p>Returns false if something is blocking the sight.</p></li><li><p>Returns the position of the blocking node when <code>false</code></p></li><li><p><code>pos1</code>: First position</p></li><li><p><code>pos2</code>: Second position</p></li></ul><li><p><code>minetest.raycast(pos1, pos2, objects, liquids)</code>: returns <code>Raycast</code></p></li><ul><li><p>Creates a <code>Raycast</code> object.</p></li><li><p><code>pos1</code>: start of the ray</p></li><li><p><code>pos2</code>: end of the ray</p></li><li><p><code>objects</code> : if false, only nodes will be returned. Default is <code>true</code>.</p></li><li><p><code>liquids&#x27; : if false, liquid nodes won&#x27;t be returned. Default is </code>false</p></li></ul><li><p><code>minetest.find_path(pos1,pos2,searchdistance,max_jump,max_drop,algorithm)</code></p></li><ul><li><p>returns table containing path</p></li><li><p>returns a table of 3D points representing a path from <code>pos1</code> to <code>pos2</code> or</p></li><p>      <code>nil</code>.</p><li><p><code>pos1</code>: start position</p></li><li><p><code>pos2</code>: end position</p></li><li><p><code>searchdistance</code>: number of blocks to search in each direction using a</p></li><p>      maximum metric.</p><li><p><code>max_jump</code>: maximum height difference to consider walkable</p></li><li><p><code>max_drop</code>: maximum height difference to consider droppable</p></li><li><p><code>algorithm</code>: One of <code>&quot;A*_noprefetch&quot;</code> (default), <code>&quot;A*&quot;</code>, <code>&quot;Dijkstra&quot;</code></p></li></ul><li><p><code>minetest.spawn_tree (pos, {treedef})</code></p></li><ul><li><p>spawns L-system tree at given <code>pos</code> with definition in <code>treedef</code> table</p></li></ul><li><p><code>minetest.transforming_liquid_add(pos)</code></p></li><ul><li><p>add node to liquid update queue</p></li></ul><li><p><code>minetest.get_node_max_level(pos)</code></p></li><ul><li><p>get max available level for leveled node</p></li></ul><li><p><code>minetest.get_node_level(pos)</code></p></li><ul><li><p>get level of leveled node (water, snow)</p></li></ul><li><p><code>minetest.set_node_level(pos, level)</code></p></li><ul><li><p>set level of leveled node, default <code>level</code> equals <code>1</code></p></li><li><p>if <code>totallevel &gt; maxlevel</code>, returns rest (<code>total-max</code>).</p></li></ul><li><p><code>minetest.add_node_level(pos, level)</code></p></li><ul><li><p>increase level of leveled node by level, default <code>level</code> equals <code>1</code></p></li><li><p>if <code>totallevel &gt; maxlevel</code>, returns rest (<code>total-max</code>)</p></li><li><p>can be negative for decreasing</p></li></ul><li><p><code>minetest.fix_light(pos1, pos2)</code>: returns <code>true</code>/<code>false</code></p></li><ul><li><p>resets the light in a cuboid-shaped part of</p></li><p>      the map and removes lighting bugs.</p><li><p>Loads the area if it is not loaded.</p></li><li><p><code>pos1</code> is the corner of the cuboid with the least coordinates</p></li><p>      (in node coordinates), inclusive.</p><li><p><code>pos2</code> is the opposite corner of the cuboid, inclusive.</p></li><li><p>The actual updated cuboid might be larger than the specified one,</p></li><p>      because only whole map blocks can be updated.</p><p>      The actual updated area consists of those map blocks that intersect</p><p>      with the given cuboid.</p><li><p>However, the neighborhood of the updated area might change</p></li><p>      as well, as light can spread out of the cuboid, also light</p><p>      might be removed.</p><li><p>returns <code>false</code> if the area is not fully generated,</p></li><p>      <code>true</code> otherwise</p></ul><li><p><code>minetest.check_single_for_falling(pos)</code></p></li><ul><li><p>causes an unsupported <code>group:falling_node</code> node to fall and causes an</p></li><p>      unattached <code>group:attached_node</code> node to fall.</p><li><p>does not spread these updates to neighbours.</p></li></ul><li><p><code>minetest.check_for_falling(pos)</code></p></li><ul><li><p>causes an unsupported <code>group:falling_node</code> node to fall and causes an</p></li><p>      unattached <code>group:attached_node</code> node to fall.</p><li><p>spread these updates to neighbours and can cause a cascade</p></li><p>      of nodes to fall.</p></ul><li><p><code>minetest.get_spawn_level(x, z)</code></p></li><ul><li><p>Returns a player spawn y co-ordinate for the provided (x, z)</p></li><p>      co-ordinates, or <code>nil</code> for an unsuitable spawn point.</p><li><p>For most mapgens a &#x27;suitable spawn point&#x27; is one with y between</p></li><p>      <code>water_level</code> and <code>water_level + 16</code>, and in mgv7 well away from rivers,</p><p>      so <code>nil</code> will be returned for many (x, z) co-ordinates.</p><li><p>The spawn level returned is for a player spawn in unmodified terrain.</p></li><li><p>The spawn level is intentionally above terrain level to cope with</p></li><p>      full-node biome &#x27;dust&#x27; nodes.</p></ul></ul><br><h3 id="gheader237"><p>Mod channels</p></h3><p>You can find mod channels communication scheme in <code>docs/mod_channels.png</code>.</p><br><ul><li><p><code>minetest.mod_channel_join(channel_name)</code></p></li><ul><li><p>Server joins channel <code>channel_name</code>, and creates it if necessary. You</p></li><p>      should listen from incoming messages with</p><p>      <code>minetest.register_on_modchannel_message</code> call to receive incoming</p><p>      messages.</p></ul></ul><br><h3 id="gheader238"><p>Inventory</p></h3><p><code>minetest.get_inventory(location)</code>: returns an <code>InvRef</code></p><br><ul><li><p><code>location</code> = e.g.</p></li><ul><li><p><code>{type=&quot;player&quot;, name=&quot;celeron55&quot;}</code></p></li><li><p><code>{type=&quot;node&quot;, pos={x=, y=, z=}}</code></p></li><li><p><code>{type=&quot;detached&quot;, name=&quot;creative&quot;}</code></p></li></ul><li><p><code>minetest.create_detached_inventory(name, callbacks, [player_name])</code>: returns</p></li><p>  an <code>InvRef</code>.</p><ul><li><p>callbacks: See &quot;Detached inventory callbacks&quot;</p></li><li><p><code>player_name</code>: Make detached inventory available to one player</p></li><p>      exclusively, by default they will be sent to every player (even if not</p><p>      used).</p><p>      Note that this parameter is mostly just a workaround and will be removed</p><p>      in future releases.</p><li><p>Creates a detached inventory. If it already exists, it is cleared.</p></li></ul><li><p><code>minetest.do_item_eat(hp_change, replace_with_item, itemstack, user, pointed_thing)</code>:</p></li><p>  returns left over ItemStack.</p><ul><li><p>See <code>minetest.item_eat</code> and <code>minetest.register_on_item_eat</code></p></li></ul></ul><br><h3 id="gheader239"><p>Formspec</p></h3><ul><li><p><code>minetest.show_formspec(playername, formname, formspec)</code></p></li><ul><li><p><code>playername</code>: name of player to show formspec</p></li><li><p><code>formname</code>: name passed to <code>on_player_receive_fields</code> callbacks.</p></li><p>      It should follow the <code>&quot;modname:&lt;whatever&gt;&quot;</code> naming convention</p><li><p><code>formspec</code>: formspec to display</p></li></ul><li><p><code>minetest.close_formspec(playername, formname)</code></p></li><ul><li><p><code>playername</code>: name of player to close formspec</p></li><li><p><code>formname</code>: has to exactly match the one given in <code>show_formspec</code>, or the</p></li><p>      formspec will not close.</p><li><p>calling <code>show_formspec(playername, formname, &quot;&quot;)</code> is equal to this</p></li><p>      expression.</p><li><p>to close a formspec regardless of the formname, call</p></li><p>      <code>minetest.close_formspec(playername, &quot;&quot;)</code>.</p><p>      <b>USE THIS ONLY WHEN ABSOLUTELY NECESSARY!</b></p></ul><li><p><code>minetest.formspec_escape(string)</code>: returns a string</p></li><ul><li><p>escapes the characters &quot;[&quot;, &quot;]&quot;, &quot;\&quot;, &quot;,&quot; and &quot;;&quot;, which can not be used</p></li><p>      in formspecs.</p></ul><li><p><code>minetest.explode_table_event(string)</code>: returns a table</p></li><ul><li><p>returns e.g. <code>{type=&quot;CHG&quot;, row=1, column=2}</code></p></li><li><p><code>type</code> is one of:</p></li><ul><li><p><code>&quot;INV&quot;</code>: no row selected)</p></li><li><p><code>&quot;CHG&quot;</code>: selected)</p></li><li><p><code>&quot;DCL&quot;</code>: double-click</p></li></ul></ul><li><p><code>minetest.explode_textlist_event(string)</code>: returns a table</p></li><ul><li><p>returns e.g. <code>{type=&quot;CHG&quot;, index=1}</code></p></li><li><p><code>type</code> is one of:</p></li><ul><li><p><code>&quot;INV&quot;</code>: no row selected)</p></li><li><p><code>&quot;CHG&quot;</code>: selected)</p></li><li><p><code>&quot;DCL&quot;</code>: double-click</p></li></ul></ul><li><p><code>minetest.explode_scrollbar_event(string)</code>: returns a table</p></li><ul><li><p>returns e.g. <code>{type=&quot;CHG&quot;, value=500}</code></p></li><li><p><code>type</code> is one of:</p></li><ul><li><p><code>&quot;INV&quot;</code>: something failed</p></li><li><p><code>&quot;CHG&quot;</code>: has been changed</p></li><li><p><code>&quot;VAL&quot;</code>: not changed</p></li></ul></ul></ul><br><h3 id="gheader240"><p>Item handling</p></h3><ul><li><p><code>minetest.inventorycube(img1, img2, img3)</code></p></li><ul><li><p>Returns a string for making an image of a cube (useful as an item image)</p></li></ul><li><p><code>minetest.get_pointed_thing_position(pointed_thing, above)</code></p></li><ul><li><p>Get position of a <code>pointed_thing</code> (that you can get from somewhere)</p></li></ul><li><p><code>minetest.dir_to_facedir(dir, is6d)</code></p></li><ul><li><p>Convert a vector to a facedir value, used in <code>param2</code> for</p></li><p>      <code>paramtype2=&quot;facedir&quot;</code>.</p><li><p>passing something non-<code>nil</code>/<code>false</code> for the optional second parameter</p></li><p>      causes it to take the y component into account.</p></ul><li><p><code>minetest.facedir_to_dir(facedir)</code></p></li><ul><li><p>Convert a facedir back into a vector aimed directly out the &quot;back&quot; of a</p></li><p>      node.</p></ul><li><p><code>minetest.dir_to_wallmounted(dir)</code></p></li><ul><li><p>Convert a vector to a wallmounted value, used for</p></li><p>      <code>paramtype2=&quot;wallmounted&quot;</code>.</p></ul><li><p><code>minetest.wallmounted_to_dir(wallmounted)</code></p></li><ul><li><p>Convert a wallmounted value back into a vector aimed directly out the</p></li><p>      &quot;back&quot; of a node.</p></ul><li><p><code>minetest.dir_to_yaw(dir)</code></p></li><ul><li><p>Convert a vector into a yaw (angle)</p></li></ul><li><p><code>minetest.yaw_to_dir(yaw)</code></p></li><ul><li><p>Convert yaw (angle) to a vector</p></li></ul><li><p><code>minetest.is_colored_paramtype(ptype)</code></p></li><ul><li><p>Returns a boolean. Returns <code>true</code> if the given <code>paramtype2</code> contains</p></li><p>      color information (<code>color</code>, <code>colorwallmounted</code> or <code>colorfacedir</code>).</p></ul><li><p><code>minetest.strip_param2_color(param2, paramtype2)</code></p></li><ul><li><p>Removes everything but the color information from the</p></li><p>      given <code>param2</code> value.</p><li><p>Returns <code>nil</code> if the given <code>paramtype2</code> does not contain color</p></li><p>      information.</p></ul><li><p><code>minetest.get_node_drops(nodename, toolname)</code></p></li><ul><li><p>Returns list of item names.</p></li><li><p><b>Note</b>: This will be removed or modified in a future version.</p></li></ul><li><p><code>minetest.get_craft_result(input)</code>: returns <code>output, decremented_input</code></p></li><ul><li><p><code>input.method</code> = <code>&quot;normal&quot;</code> or <code>&quot;cooking&quot;</code> or <code>&quot;fuel&quot;</code></p></li><li><p><code>input.width</code> = for example <code>3</code></p></li><li><p><code>input.items</code> = for example</p></li><p>      <code>{stack1, stack2, stack3, stack4, stack 5, stack 6, stack 7, stack 8, stack 9}</code></p><li><p><code>output.item</code> = <code>ItemStack</code>, if unsuccessful: empty <code>ItemStack</code></p></li><li><p><code>output.time</code> = a number, if unsuccessful: <code>0</code></p></li><li><p><code>output.replacements</code> = list of <code>ItemStack</code>s that couldn&#x27;t be placed in</p></li><p>      <code>decremented_input.items</code></p><li><p><code>decremented_input</code> = like <code>input</code></p></li></ul><li><p><code>minetest.get_craft_recipe(output)</code>: returns input</p></li><ul><li><p>returns last registered recipe for output item (node)</p></li><li><p><code>output</code> is a node or item type such as <code>&quot;default:torch&quot;</code></p></li><li><p><code>input.method</code> = <code>&quot;normal&quot;</code> or <code>&quot;cooking&quot;</code> or <code>&quot;fuel&quot;</code></p></li><li><p><code>input.width</code> = for example <code>3</code></p></li><li><p><code>input.items</code> = for example</p></li><p>      <code>{stack1, stack2, stack3, stack4, stack 5, stack 6, stack 7, stack 8, stack 9}</code></p><ul><li><p><code>input.items</code> = <code>nil</code> if no recipe found</p></li></ul></ul><li><p><code>minetest.get_all_craft_recipes(query item)</code>: returns a table or <code>nil</code></p></li><ul><li><p>returns indexed table with all registered recipes for query item (node)</p></li><p>      or <code>nil</code> if no recipe was found.</p><li><p>recipe entry table:</p></li></ul></ul><br><pre><code>      {
          method = &#x27;normal&#x27; or &#x27;cooking&#x27; or &#x27;fuel&#x27;
          width = 0-3, 0 means shapeless recipe
          items = indexed [1-9] table with recipe items
          output = string with item name and quantity
      }
* Example query for `&quot;default:gold_ingot&quot;` will return table:
</code></pre><br><pre><code>      {
          [1]={method = &quot;cooking&quot;, width = 3, output = &quot;default:gold_ingot&quot;,
          items = {1 = &quot;default:gold_lump&quot;}},
          [2]={method = &quot;normal&quot;, width = 1, output = &quot;default:gold_ingot 9&quot;,
          items = {1 = &quot;default:goldblock&quot;}}
      }
</code></pre><ul><li><p><code>minetest.handle_node_drops(pos, drops, digger)</code></p></li><ul><li><p><code>drops</code>: list of itemstrings</p></li><li><p>Handles drops from nodes after digging: Default action is to put them</p></li><p>      into digger&#x27;s inventory.</p><li><p>Can be overridden to get different functionality (e.g. dropping items on</p></li><p>      ground)</p></ul><li><p><code>minetest.itemstring_with_palette(item, palette_index)</code>: returns an item</p></li><p>  string.</p><ul><li><p>Creates an item string which contains palette index information</p></li><p>      for hardware colorization. You can use the returned string</p><p>      as an output in a craft recipe.</p><li><p><code>item</code>: the item stack which becomes colored. Can be in string,</p></li><p>      table and native form.</p><li><p><code>palette_index</code>: this index is added to the item stack</p></li></ul><li><p><code>minetest.itemstring_with_color(item, colorstring)</code>: returns an item string</p></li><ul><li><p>Creates an item string which contains static color information</p></li><p>      for hardware colorization. Use this method if you wish to colorize</p><p>      an item that does not own a palette. You can use the returned string</p><p>      as an output in a craft recipe.</p><li><p><code>item</code>: the item stack which becomes colored. Can be in string,</p></li><p>      table and native form.</p><li><p><code>colorstring</code>: the new color of the item stack</p></li></ul></ul><br><h3 id="gheader241"><p>Rollback</p></h3><ul><li><p><code>minetest.rollback_get_node_actions(pos, range, seconds, limit)</code>:</p></li><p>  returns <code>{{actor, pos, time, oldnode, newnode}, ...}</code></p><ul><li><p>Find who has done something to a node, or near a node</p></li><li><p><code>actor</code>: <code>&quot;player:&lt;name&gt;&quot;</code>, also <code>&quot;liquid&quot;</code>.</p></li></ul><li><p><code>minetest.rollback_revert_actions_by(actor, seconds)</code>: returns</p></li><p>  <code>boolean, log_messages</code>.</p><ul><li><p>Revert latest actions of someone</p></li><li><p><code>actor</code>: <code>&quot;player:&lt;name&gt;&quot;</code>, also <code>&quot;liquid&quot;</code>.</p></li></ul></ul><br><h3 id="gheader242"><p>Defaults for the <code>on_*</code> item definition functions</p></h3><p>These functions return the leftover itemstack.</p><br><ul><li><p><code>minetest.item_place_node(itemstack, placer, pointed_thing[, param2, prevent_after_place])</code></p></li><ul><li><p>Place item as a node</p></li><li><p><code>param2</code> overrides <code>facedir</code> and wallmounted <code>param2</code></p></li><li><p><code>prevent_after_place</code>: if set to <code>true</code>, <code>after_place_node</code> is not called</p></li><p>      for the newly placed node to prevent a callback and placement loop</p><li><p>returns <code>itemstack, success</code></p></li></ul><li><p><code>minetest.item_place_object(itemstack, placer, pointed_thing)</code></p></li><ul><li><p>Place item as-is</p></li></ul><li><p><code>minetest.item_place(itemstack, placer, pointed_thing, param2)</code></p></li><ul><li><p>Use one of the above based on what the item is.</p></li><li><p>Calls <code>on_rightclick</code> of <code>pointed_thing.under</code> if defined instead</p></li><li><p><b>Note</b>: is not called when wielded item overrides <code>on_place</code></p></li><li><p><code>param2</code> overrides <code>facedir</code> and wallmounted <code>param2</code></p></li><li><p>returns <code>itemstack, success</code></p></li></ul><li><p><code>minetest.item_drop(itemstack, dropper, pos)</code></p></li><ul><li><p>Drop the item</p></li></ul><li><p><code>minetest.item_eat(hp_change, replace_with_item)</code></p></li><ul><li><p>Eat the item.</p></li><li><p><code>replace_with_item</code> is the itemstring which is added to the inventory.</p></li><p>      If the player is eating a stack, then replace_with_item goes to a</p><p>      different spot. Can be <code>nil</code></p><li><p>See <code>minetest.do_item_eat</code></p></li></ul></ul><br><h3 id="gheader243"><p>Defaults for the <code>on_punch</code> and <code>on_dig</code> node definition callbacks</p></h3><ul><li><p><code>minetest.node_punch(pos, node, puncher, pointed_thing)</code></p></li><ul><li><p>Calls functions registered by <code>minetest.register_on_punchnode()</code></p></li></ul><li><p><code>minetest.node_dig(pos, node, digger)</code></p></li><ul><li><p>Checks if node can be dug, puts item into inventory, removes node</p></li><li><p>Calls functions registered by <code>minetest.registered_on_dignodes()</code></p></li></ul></ul><br><h3 id="gheader244"><p>Sounds</p></h3><ul><li><p><code>minetest.sound_play(spec, parameters)</code>: returns a handle</p></li><ul><li><p><code>spec</code> is a <code>SimpleSoundSpec</code></p></li><li><p><code>parameters</code> is a sound parameter table</p></li></ul><li><p><code>minetest.sound_stop(handle)</code></p></li><li><p><code>minetest.sound_fade(handle, step, gain)</code></p></li><ul><li><p><code>handle</code> is a handle returned by <code>minetest.sound_play</code></p></li><li><p><code>step</code> determines how fast a sound will fade.</p></li><p>      Negative step will lower the sound volume, positive step will increase</p><p>      the sound volume.</p><li><p><code>gain</code> the target gain for the fade.</p></li></ul></ul><br><h3 id="gheader245"><p>Timing</p></h3><ul><li><p><code>minetest.after(time, func, ...)</code></p></li><ul><li><p>Call the function <code>func</code> after <code>time</code> seconds, may be fractional</p></li><li><p>Optional: Variable number of arguments that are passed to <code>func</code></p></li></ul></ul><br><h3 id="gheader246"><p>Server</p></h3><ul><li><p><code>minetest.request_shutdown([message],[reconnect],[delay])</code>: request for</p></li><p>  server shutdown. Will display <code>message</code> to clients.</p><ul><li><p><code>reconnect</code> == true displays a reconnect button</p></li><li><p><code>delay</code> adds an optional delay (in seconds) before shutdown.</p></li><p>      Negative delay cancels the current active shutdown.</p><p>      Zero delay triggers an immediate shutdown.</p></ul><li><p><code>minetest.cancel_shutdown_requests()</code>: cancel current delayed shutdown</p></li><li><p><code>minetest.get_server_status()</code>: returns server status string</p></li><li><p><code>minetest.get_server_uptime()</code>: returns the server uptime in seconds</p></li><li><p><code>minetest.remove_player(name)</code>: remove player from database (if they are not</p></li><p>  connected).</p><ul><li><p>As auth data is not removed, minetest.player_exists will continue to</p></li><p>      return true. Call the below method as well if you want to remove auth</p><p>      data too.</p><li><p>Returns a code (0: successful, 1: no such player, 2: player is connected)</p></li></ul><li><p><code>minetest.remove_player_auth(name)</code>: remove player authentication data</p></li><ul><li><p>Returns boolean indicating success (false if player nonexistant)</p></li></ul></ul><br><h3 id="gheader247"><p>Bans</p></h3><ul><li><p><code>minetest.get_ban_list()</code>: returns the ban list</p></li><p>  (same as <code>minetest.get_ban_description(&quot;&quot;)</code>).</p><li><p><code>minetest.get_ban_description(ip_or_name)</code>: returns ban description (string)</p></li><li><p><code>minetest.ban_player(name)</code>: ban a player</p></li><li><p><code>minetest.unban_player_or_ip(name)</code>: unban player or IP address</p></li><li><p><code>minetest.kick_player(name, [reason])</code>: disconnect a player with a optional</p></li><p>  reason.</p></ul><br><h3 id="gheader248"><p>Particles</p></h3><ul><li><p><code>minetest.add_particle(particle definition)</code></p></li><ul><li><p>Deprecated: </p></li><p>      expirationtime, size, collisiondetection, texture, playername)</p></ul></ul><br><ul><li><p><code>minetest.add_particlespawner(particlespawner definition)</code></p></li><ul><li><p>Add a <code>ParticleSpawner</code>, an object that spawns an amount of particles</p></li><p>      over <code>time</code> seconds.</p><li><p>Returns an <code>id</code>, and -1 if adding didn&#x27;t succeed</p></li><li><p></p></li><p>      minpos, maxpos,</p><p>      minvel, maxvel,</p><p>      minacc, maxacc,</p><p>      minexptime, maxexptime,</p><p>      minsize, maxsize,</p><p>      collisiondetection, texture, playername)</p></ul></ul><br><ul><li><p><code>minetest.delete_particlespawner(id, player)</code></p></li><ul><li><p>Delete <code>ParticleSpawner</code> with <code>id</code> (return value from</p></li><p>      <code>minetest.add_particlespawner</code>).</p><li><p>If playername is specified, only deletes on the player&#x27;s client,</p></li><p>      otherwise on all clients.</p></ul></ul><br><h3 id="gheader249"><p>Schematics</p></h3><ul><li><p><code>minetest.create_schematic(p1, p2, probability_list, filename, slice_prob_list)</code></p></li><ul><li><p>Create a schematic from the volume of map specified by the box formed by</p></li><p>      p1 and p2.</p><li><p>Apply the specified probability and per-node force-place to the specified</p></li><p>      nodes according to the <code>probability_list</code>.</p><ul><li><p><code>probability_list</code> is an array of tables containing two fields, <code>pos</code></p></li><p>          and <code>prob</code>.</p><ul><ul><li><p><code>pos</code> is the 3D vector specifying the absolute coordinates of the</p></li><p>              node being modified,</p><li><p><code>prob</code> is an integer value from <code>0</code> to <code>255</code> that encodes</p></li><p>              probability and per-node force-place. Probability has levels</p><p>              0-127, then 128 may be added to encode per-node force-place.</p><p>              For probability stated as 0-255, divide by 2 and round down to</p><p>              get values 0-127, then add 128 to apply per-node force-place.</p><li><p>If there are two or more entries with the same pos value, the</p></li><p>              last entry is used.</p><li><p>If <code>pos</code> is not inside the box formed by <code>p1</code> and <code>p2</code>, it is</p></li><p>              ignored.</p><li><p>If <code>probability_list</code> equals <code>nil</code>, no probabilities are applied.</p></li></ul></ul></ul><li><p>Apply the specified probability to the specified horizontal slices</p></li><p>      according to the <code>slice_prob_list</code>.</p><ul><li><p><code>slice_prob_list</code> is an array of tables containing two fields, <code>ypos</code></p></li><p>          and <code>prob</code>.</p><ul><ul><li><p><code>ypos</code> indicates the y position of the slice with a probability</p></li><p>              applied, the lowest slice being <code>ypos = 0</code>.</p><li><p>If slice probability list equals <code>nil</code>, no slice probabilities</p></li><p>              are applied.</p></ul></ul></ul><li><p>Saves schematic in the Minetest Schematic format to filename.</p></li></ul></ul><br><ul><li><p><code>minetest.place_schematic(pos, schematic, rotation, replacements, force_placement, flags)</code></p></li><ul><li><p>Place the schematic specified by schematic (see: Schematic specifier) at</p></li><p>      <code>pos</code>.</p><li><p><code>rotation</code> can equal <code>&quot;0&quot;</code>, <code>&quot;90&quot;</code>, <code>&quot;180&quot;</code>, <code>&quot;270&quot;</code>, or <code>&quot;random&quot;</code>.</p></li><li><p>If the <code>rotation</code> parameter is omitted, the schematic is not rotated.</p></li><li><p><code>replacements</code> = <code>{[&quot;old_name&quot;] = &quot;convert_to&quot;, ...}</code></p></li><li><p><code>force_placement</code> is a boolean indicating whether nodes other than <code>air</code></p></li><p>      and <code>ignore</code> are replaced by the schematic.</p><li><p>Returns nil if the schematic could not be loaded.</p></li><li><p><b>Warning</b>: Once you have loaded a schematic from a file, it will be</p></li><p>      cached. Future calls will always use the cached version and the</p><p>      replacement list defined for it, regardless of whether the file or the</p><p>      replacement list parameter have changed. The only way to load the file</p><p>      anew is to restart the server.</p><li><p><code>flags</code> is a flag field with the available flags:</p></li><ul><li><p>place_center_x</p></li><li><p>place_center_y</p></li><li><p>place_center_z</p></li></ul></ul></ul><br><ul><li><p><code>minetest.place_schematic_on_vmanip(vmanip, pos, schematic, rotation, replacement, force_placement, flags)</code>:</p></li><ul><li><p>This function is analogous to minetest.place_schematic, but places a</p></li><p>      schematic onto the specified VoxelManip object <code>vmanip</code> instead of the</p><p>      map.</p><li><p>Returns false if any part of the schematic was cut-off due to the</p></li><p>      VoxelManip not containing the full area required, and true if the whole</p><p>      schematic was able to fit.</p><li><p>Returns nil if the schematic could not be loaded.</p></li><li><p>After execution, any external copies of the VoxelManip contents are</p></li><p>      invalidated.</p><li><p><code>flags</code> is a flag field with the available flags:</p></li><ul><li><p>place_center_x</p></li><li><p>place_center_y</p></li><li><p>place_center_z</p></li></ul></ul></ul><br><ul><li><p><code>minetest.serialize_schematic(schematic, format, options)</code></p></li><ul><li><p>Return the serialized schematic specified by schematic</p></li><p>      (see: Schematic specifier)</p><li><p>in the <code>format</code> of either &quot;mts&quot; or &quot;lua&quot;.</p></li><li><p>&quot;mts&quot; - a string containing the binary MTS data used in the MTS file</p></li><p>      format.</p><li><p>&quot;lua&quot; - a string containing Lua code representing the schematic in table</p></li><p>      format.</p><li><p><code>options</code> is a table containing the following optional parameters:</p></li><ul><li><p>If <code>lua_use_comments</code> is true and <code>format</code> is &quot;lua&quot;, the Lua code</p></li><p>          generated will have (X, Z) position comments for every X row</p><p>          generated in the schematic data for easier reading.</p><li><p>If <code>lua_num_indent_spaces</code> is a nonzero number and <code>format</code> is &quot;lua&quot;,</p></li><p>          the Lua code generated will use that number of spaces as indentation</p><p>          instead of a tab character.</p></ul></ul></ul><br><h3 id="gheader250"><p>HTTP Requests:</p></h3><ul><li><p><code>minetest.request_http_api()</code>:</p></li><ul><li><p>returns <code>HTTPApiTable</code> containing http functions if the calling mod has</p></li><p>      been granted access by being listed in the <code>secure.http_mods</code> or</p><p>      <code>secure.trusted_mods</code> setting, otherwise returns <code>nil</code>.</p><li><p>The returned table contains the functions <code>fetch</code>, <code>fetch_async</code> and</p></li><p>      <code>fetch_async_get</code> described below.</p><li><p>Only works at init time and must be called from the mod&#x27;s main scope</p></li><p>      (not from a function).</p><li><p>Function only exists if minetest server was built with cURL support.</p></li><li><p></p></li><p>      A LOCAL VARIABLE!</p></ul><li><p><code>HTTPApiTable.fetch(HTTPRequest req, callback)</code></p></li><ul><li><p>Performs given request asynchronously and calls callback upon completion</p></li><li><p>callback: <code>function(HTTPRequestResult res)</code></p></li><li><p>Use this HTTP function if you are unsure, the others are for advanced use</p></li></ul><li><p><code>HTTPApiTable.fetch_async(HTTPRequest req)</code>: returns handle</p></li><ul><li><p>Performs given request asynchronously and returns handle for</p></li><p>      <code>HTTPApiTable.fetch_async_get</code></p></ul><li><p><code>HTTPApiTable.fetch_async_get(handle)</code>: returns HTTPRequestResult</p></li><ul><li><p>Return response data for given asynchronous HTTP request</p></li></ul></ul><br><h3 id="gheader251"><p>Storage API:</p></h3><ul><li><p><code>minetest.get_mod_storage()</code>:</p></li><ul><li><p>returns reference to mod private <code>StorageRef</code></p></li><li><p>must be called during mod load time</p></li></ul></ul><br><h3 id="gheader252"><p>Misc.</p></h3><ul><li><p><code>minetest.get_connected_players()</code>: returns list of <code>ObjectRefs</code></p></li><li><p><code>minetest.is_player(o)</code>: boolean, whether <code>o</code> is a player</p></li><li><p><code>minetest.player_exists(name)</code>: boolean, whether player exists</p></li><p>  (regardless of online status)</p><li><p><code>minetest.hud_replace_builtin(name, hud_definition)</code></p></li><ul><li><p>Replaces definition of a builtin hud element</p></li><li><p><code>name</code>: <code>&quot;breath&quot;</code> or <code>&quot;health&quot;</code></p></li><li><p><code>hud_definition</code>: definition to replace builtin definition</p></li></ul><li><p><code>minetest.send_join_message(player_name)</code></p></li><ul><li><p>This function can be overridden by mods to change the join message.</p></li></ul><li><p><code>minetest.send_leave_message(player_name, timed_out)</code></p></li><ul><li><p>This function can be overridden by mods to change the leave message.</p></li></ul><li><p><code>minetest.hash_node_position(pos)</code>: returns an 48-bit integer</p></li><ul><li><p><code>pos</code>: table {x=number, y=number, z=number},</p></li><li><p>Gives a unique hash number for a node position (16+16+16=48bit)</p></li></ul><li><p><code>minetest.get_position_from_hash(hash)</code>: returns a position</p></li><ul><li><p>Inverse transform of <code>minetest.hash_node_position</code></p></li></ul><li><p><code>minetest.get_item_group(name, group)</code>: returns a rating</p></li><ul><li><p>Get rating of a group of an item. (<code>0</code> means: not in group)</p></li></ul><li><p><code>minetest.get_node_group(name, group)</code>: returns a rating</p></li><ul><li><p>Deprecated: An alias for the former.</p></li></ul><li><p><code>minetest.raillike_group(name)</code>: returns a rating</p></li><ul><li><p>Returns rating of the connect_to_raillike group corresponding to name</p></li><li><p>If name is not yet the name of a connect_to_raillike group, a new group</p></li><p>      id is created, with that name.</p></ul><li><p><code>minetest.get_content_id(name)</code>: returns an integer</p></li><ul><li><p>Gets the internal content ID of <code>name</code></p></li></ul><li><p><code>minetest.get_name_from_content_id(content_id)</code>: returns a string</p></li><ul><li><p>Gets the name of the content with that content ID</p></li></ul><li><p><code>minetest.parse_json(string[, nullvalue])</code>: returns something</p></li><ul><li><p>Convert a string containing JSON data into the Lua equivalent</p></li><li><p><code>nullvalue</code>: returned in place of the JSON null; defaults to <code>nil</code></p></li><li><p>On success returns a table, a string, a number, a boolean or <code>nullvalue</code></p></li><li><p>On failure outputs an error message and returns <code>nil</code></p></li><li><p>Example: <code>parse_json(&quot;[10, {\&quot;a\&quot;:false}]&quot;)</code>, returns <code>{10, {a = false}}</code></p></li></ul><li><p><code>minetest.write_json(data[, styled])</code>: returns a string or <code>nil</code> and an error</p></li><p>  message.</p><ul><li><p>Convert a Lua table into a JSON string</p></li><li><p>styled: Outputs in a human-readable format if this is set, defaults to</p></li><p>      false.</p><li><p>Unserializable things like functions and userdata will cause an error.</p></li><li><p><b>Warning</b>: JSON is more strict than the Lua table format.</p></li><p>        1. You can only use strings and positive integers of at least one as</p><p>           keys.</p><p>        2. You can not mix string and integer keys.</p><p>           This is due to the fact that JSON has two distinct array and object</p><p>           values.</p><li><p>Example: <code>write_json({10, {a = false}})</code>,</p></li><p>      returns <code>&quot;[10, {\&quot;a\&quot;: false}]&quot;</code></p></ul><li><p><code>minetest.serialize(table)</code>: returns a string</p></li><ul><li><p>Convert a table containing tables, strings, numbers, booleans and <code>nil</code>s</p></li><p>      into string form readable by <code>minetest.deserialize</code></p><li><p>Example: <code>serialize({foo=&#x27;bar&#x27;})</code>, returns <code>&#x27;return { [&quot;foo&quot;] = &quot;bar&quot; }&#x27;</code></p></li></ul><li><p><code>minetest.deserialize(string)</code>: returns a table</p></li><ul><li><p>Convert a string returned by <code>minetest.deserialize</code> into a table</p></li><li><p><code>string</code> is loaded in an empty sandbox environment.</p></li><li><p>Will load functions, but they cannot access the global environment.</p></li><li><p>Example: <code>deserialize(&#x27;return { [&quot;foo&quot;] = &quot;bar&quot; }&#x27;)</code>,</p></li><p>      returns <code>{foo=&#x27;bar&#x27;}</code></p><li><p>Example: <code>deserialize(&#x27;print(&quot;foo&quot;)&#x27;)</code>, returns <code>nil</code></p></li><p>      (function call fails), returns</p><p>      <code>error:[string &quot;print(&quot;foo&quot;)&quot;]:1: attempt to call global &#x27;print&#x27; (a nil value)</code></p></ul><li><p><code>minetest.compress(data, method, ...)</code>: returns <code>compressed_data</code></p></li><ul><li><p>Compress a string of data.</p></li><li><p><code>method</code> is a string identifying the compression method to be used.</p></li><li><p>Supported compression methods:</p></li><ul><li><p>Deflate (zlib): <code>&quot;deflate&quot;</code></p></li></ul><li><p><code>...</code> indicates method-specific arguments. Currently defined arguments</p></li><p>      are:</p><ul><li><p>Deflate: <code>level</code> - Compression level, <code>0</code>-<code>9</code> or <code>nil</code>.</p></li></ul></ul><li><p><code>minetest.decompress(compressed_data, method, ...)</code>: returns data</p></li><ul><li><p>Decompress a string of data (using ZLib).</p></li><li><p>See documentation on <code>minetest.compress()</code> for supported compression</p></li><p>      methods.</p><li><p><code>...</code> indicates method-specific arguments. Currently, no methods use this</p></li></ul><li><p><code>minetest.rgba(red, green, blue[, alpha])</code>: returns a string</p></li><ul><li><p>Each argument is a 8 Bit unsigned integer</p></li><li><p>Returns the ColorString from rgb or rgba values</p></li><li><p>Example: <code>minetest.rgba(10, 20, 30, 40)</code>, returns <code>&quot;#0A141E28&quot;</code></p></li></ul><li><p><code>minetest.encode_base64(string)</code>: returns string encoded in base64</p></li><ul><li><p>Encodes a string in base64.</p></li></ul><li><p><code>minetest.decode_base64(string)</code>: returns string</p></li><ul><li><p>Decodes a string encoded in base64.</p></li></ul><li><p><code>minetest.is_protected(pos, name)</code>: returns boolean</p></li><ul><li><p>Returns true, if player <code>name</code> shouldn&#x27;t be able to dig at <code>pos</code> or do</p></li><p>      other actions, definable by mods, due to some mod-defined ownership-like</p><p>      concept.</p><li><p>Returns false or nil, if the player is allowed to do such actions.</p></li><li><p><code>name</code> will be &quot;&quot; for non-players or unknown players.</p></li><li><p>This function should be overridden by protection mods and should be used</p></li><p>      to check if a player can interact at a position.</p><li><p>This function should call the old version of itself if the position is</p></li><p>      not protected by the mod.</p><li><p>Example:</p></li></ul></ul><br><pre><code>        local old_is_protected = minetest.is_protected
        function minetest.is_protected(pos, name)
            if mymod:position_protected_from(pos, name) then
                return true
            end
                return old_is_protected(pos, name)
        end
</code></pre><ul><li><p><code>minetest.record_protection_violation(pos, name)</code></p></li><ul><li><p>This function calls functions registered with</p></li><p>      <code>minetest.register_on_protection_violation</code>.</p></ul><li><p></p></li><ul><li><p>Returns the position of the first node that <code>player_name</code> may not modify</p></li><p>      in the specified cuboid between <code>pos1</code> and <code>pos2</code>.</p><li><p>Returns <code>false</code> if no protections were found.</p></li><li><p>Applies <code>is_protected()</code> to a 3D lattice of points in the defined volume.</p></li><p>      The points are spaced evenly throughout the volume and have a spacing</p><p>      similar to, but no larger than, <code>interval</code>.</p><li><p>All corners and edges of the defined volume are checked.</p></li><li><p><code>interval</code> defaults to 4.</p></li><li><p><code>interval</code> should be carefully chosen and maximised to avoid an excessive</p></li><p>      number of points being checked.</p><li><p>Like <code>minetest.is_protected</code>, this function may be extended or</p></li><p>      overwritten by mods to provide a faster implementation to check the</p><p>      cuboid for intersections.</p></ul><li><p></p></li><p>        orient_flags, prevent_after_place])</p><ul><li><p>Attempt to predict the desired orientation of the facedir-capable node</p></li><p>      defined by <code>itemstack</code>, and place it accordingly (on-wall, on the floor,</p><p>      or hanging from the ceiling).</p><li><p><code>infinitestacks</code>: if <code>true</code>, the itemstack is not changed. Otherwise the</p></li><p>      stacks are handled normally.</p><li><p><code>orient_flags</code>: Optional table containing extra tweaks to the placement code:</p></li><ul><li><p><code>invert_wall</code>:   if <code>true</code>, place wall-orientation on the ground and</p></li><p>          ground-orientation on the wall.</p><li><p><code>force_wall</code> :   if <code>true</code>, always place the node in wall orientation.</p></li><li><p><code>force_ceiling</code>: if <code>true</code>, always place on the ceiling.</p></li><li><p><code>force_floor</code>:   if <code>true</code>, always place the node on the floor.</p></li><li><p><code>force_facedir</code>: if <code>true</code>, forcefully reset the facedir to north</p></li><p>          when placing on the floor or ceiling.</p><li><p>The first four options are mutually-exclusive; the last in the list</p></li><p>          takes precedence over the first.</p></ul><li><p><code>prevent_after_place</code> is directly passed to <code>minetest.item_place_node</code></p></li><li><p>Returns the new itemstack after placement</p></li></ul><li><p><code>minetest.rotate_node(itemstack, placer, pointed_thing)</code></p></li><ul><li><p>calls <code>rotate_and_place()</code> with <code>infinitestacks</code> set according to the state</p></li><p>      of the creative mode setting, checks for &quot;sneak&quot; to set the <code>invert_wall</code></p><p>      parameter and <code>prevent_after_place</code> set to <code>true</code>.</p></ul></ul><br><ul><li><p><code>minetest.forceload_block(pos[, transient])</code></p></li><ul><li><p>forceloads the position <code>pos</code>.</p></li><li><p>returns <code>true</code> if area could be forceloaded</p></li><li><p>If <code>transient</code> is <code>false</code> or absent, the forceload will be persistent</p></li><p>      (saved between server runs). If <code>true</code>, the forceload will be transient</p><p>      (not saved between server runs).</p></ul></ul><br><ul><li><p><code>minetest.forceload_free_block(pos[, transient])</code></p></li><ul><li><p>stops forceloading the position <code>pos</code></p></li><li><p>If <code>transient</code> is <code>false</code> or absent, frees a persistent forceload.</p></li><p>      If <code>true</code>, frees a transient forceload.</p></ul></ul><br><ul><li><p><code>minetest.request_insecure_environment()</code>: returns an environment containing</p></li><p>  insecure functions if the calling mod has been listed as trusted in the</p><p>  <code>secure.trusted_mods</code> setting or security is disabled, otherwise returns</p><p>  <code>nil</code>.</p><ul><li><p>Only works at init time and must be called from the mod&#x27;s main scope (not</p></li><p>      from a function).</p><li><p></p></li><p>      IT IN A LOCAL VARIABLE!</p></ul></ul><br><ul><li><p><code>minetest.global_exists(name)</code></p></li><ul><li><p>Checks if a global variable has been set, without triggering a warning.</p></li></ul></ul><br><h3 id="gheader253"><p>Global objects</p></h3><ul><li><p><code>minetest.env</code>: <code>EnvRef</code> of the server environment and world.</p></li><ul><li><p>Any function in the minetest namespace can be called using the syntax</p></li><p>      <code>minetest.env:somefunction(somearguments)</code></p><p>      instead of <code>minetest.somefunction(somearguments)</code></p><li><p>Deprecated, but support is not to be dropped soon</p></li></ul></ul><br><h3 id="gheader254"><p>Global tables</p></h3><ul><li><p><code>minetest.registered_items</code></p></li><ul><li><p>Map of registered items, indexed by name</p></li></ul><li><p><code>minetest.registered_nodes</code></p></li><ul><li><p>Map of registered node definitions, indexed by name</p></li></ul><li><p><code>minetest.registered_craftitems</code></p></li><ul><li><p>Map of registered craft item definitions, indexed by name</p></li></ul><li><p><code>minetest.registered_tools</code></p></li><ul><li><p>Map of registered tool definitions, indexed by name</p></li></ul><li><p><code>minetest.registered_entities</code></p></li><ul><li><p>Map of registered entity prototypes, indexed by name</p></li></ul><li><p><code>minetest.object_refs</code></p></li><ul><li><p>Map of object references, indexed by active object id</p></li></ul><li><p><code>minetest.luaentities</code></p></li><ul><li><p>Map of Lua entities, indexed by active object id</p></li></ul><li><p><code>minetest.registered_chatcommands</code></p></li><ul><li><p>Map of registered chat command definitions, indexed by name</p></li></ul><li><p><code>minetest.registered_ores</code></p></li><ul><li><p>List of registered ore definitions.</p></li></ul><li><p><code>minetest.registered_biomes</code></p></li><ul><li><p>List of registered biome definitions.</p></li></ul><li><p><code>minetest.registered_decorations</code></p></li><ul><li><p>List of registered decoration definitions.</p></li><h1 id="gheader255"><br></h1></ul></ul><br><h2 id="gheader256"><p>Class reference</p></h2><br><br><h3 id="gheader257"><p><code>AreaStore</code></p></h3><p>A fast access data structure to store areas, and find areas near a given</p><p>position or area.</p><p>Every area has a <code>data</code> string attribute to store additional information.</p><p>You can create an empty <code>AreaStore</code> by calling <code>AreaStore()</code>, or</p><p><code>AreaStore(type_name)</code>.</p><p>If you chose the parameter-less constructor, a fast implementation will be</p><p>automatically chosen for you.</p><br><h4 id="gheader258"><p>Methods</p></h4><ul><li><p><code>get_area(id, include_borders, include_data)</code>: returns the area with the id</p></li><p>  <code>id</code>.</p><p>  (optional) Boolean values <code>include_borders</code> and <code>include_data</code> control what&#x27;s</p><p>  copied.</p><p>  Returns nil if specified area id does not exist.</p><li><p><code>get_areas_for_pos(pos, include_borders, include_data)</code>: returns all areas</p></li><p>  that contain the position <code>pos</code>.</p><p>  (optional) Boolean values <code>include_borders</code> and <code>include_data</code> control what&#x27;s</p><p>  copied.</p><li><p><code>get_areas_in_area(edge1, edge2, accept_overlap, include_borders, include_data)</code>:</p></li><p>  returns all areas that contain all nodes inside the area specified by <code>edge1</code></p><p>  and <code>edge2</code> (inclusive).</p><p>  If <code>accept_overlap</code> is true, also areas are returned that have nodes in</p><p>  common with the specified area.</p><p>  (optional) Boolean values <code>include_borders</code> and <code>include_data</code> control what&#x27;s</p><p>  copied.</p><li><p><code>insert_area(edge1, edge2, data, [id])</code>: inserts an area into the store.</p></li><p>  Returns the new area&#x27;s ID, or nil if the insertion failed.</p><p>  The (inclusive) positions <code>edge1</code> and <code>edge2</code> describe the area.</p><p>  <code>data</code> is a string stored with the area.  If passed, <code>id</code> will be used as the</p><p>  internal area ID, it must be a unique number between 0 and 2^32-2. If you use</p><p>  the <code>id</code> parameter you must always use it, or insertions are likely to fail</p><p>  due to conflicts.</p><li><p><code>reserve(count)</code>: reserves resources for at most <code>count</code> many contained</p></li><p>  areas.</p><p>  Only needed for efficiency, and only some implementations profit.</p><li><p><code>remove_area(id)</code>: removes the area with the given id from the store, returns</p></li><p>  success.</p><li><p><code>set_cache_params(params)</code>: sets params for the included prefiltering cache.</p></li><p>  Calling invalidates the cache, so that its elements have to be newly</p><p>  generated.</p><ul><li><p><code>params</code>:</p></li><p>      {</p><p>        enabled = boolean,     -- whether to enable, default true</p><p>        block_radius = number, -- the radius (in nodes) of the areas the cache</p><p>                                  generates prefiltered lists for, minimum 16,</p><p>                                  default 64.</p><p>        limit = number,        -- the cache&#x27;s size, minimum 20, default 1000</p><p>      }</p></ul><li><p><code>to_string()</code>: Experimental. Returns area store serialized as a (binary)</p></li><p>  string.</p><li><p><code>to_file(filename)</code>: Experimental. Like <code>to_string()</code>, but writes the data to</p></li><p>  a file.</p><li><p><code>from_string(str)</code>: Experimental. Deserializes string and loads it into the</p></li><p>  AreaStore.</p><p>  Returns success and, optionally, an error message.</p><li><p><code>from_file(filename)</code>: Experimental. Like <code>from_string()</code>, but reads the data</p></li><p>  from a file.</p></ul><br><h3 id="gheader259"><p><code>InvRef</code></p></h3><p>An <code>InvRef</code> is a reference to an inventory.</p><br><h4 id="gheader260"><p>Methods</p></h4><ul><li><p><code>is_empty(listname)</code>: return <code>true</code> if list is empty</p></li><li><p><code>get_size(listname)</code>: get size of a list</p></li><li><p><code>set_size(listname, size)</code>: set size of a list</p></li><ul><li><p>returns <code>false</code> on error (e.g. invalid <code>listname</code> or <code>size</code>)</p></li></ul><li><p><code>get_width(listname)</code>: get width of a list</p></li><li><p><code>set_width(listname, width)</code>: set width of list; currently used for crafting</p></li><li><p><code>get_stack(listname, i)</code>: get a copy of stack index <code>i</code> in list</p></li><li><p><code>set_stack(listname, i, stack)</code>: copy <code>stack</code> to index <code>i</code> in list</p></li><li><p><code>get_list(listname)</code>: return full list</p></li><li><p><code>set_list(listname, list)</code>: set full list (size will not change)</p></li><li><p><code>get_lists()</code>: returns list of inventory lists</p></li><li><p><code>set_lists(lists)</code>: sets inventory lists (size will not change)</p></li><li><p><code>add_item(listname, stack)</code>: add item somewhere in list, returns leftover</p></li><p>  <code>ItemStack</code>.</p><li><p><code>room_for_item(listname, stack):</code> returns <code>true</code> if the stack of items</p></li><p>  can be fully added to the list</p><li><p><code>contains_item(listname, stack, [match_meta])</code>: returns <code>true</code> if</p></li><p>  the stack of items can be fully taken from the list.</p><p>  If <code>match_meta</code> is false, only the items&#x27; names are compared</p><p>  (default: <code>false</code>).</p><li><p><code>remove_item(listname, stack)</code>: take as many items as specified from the</p></li><p>  list, returns the items that were actually removed (as an <code>ItemStack</code>)</p><p>  -- note that any item metadata is ignored, so attempting to remove a specific</p><p>  unique item this way will likely remove the wrong one -- to do that use</p><p>  <code>set_stack</code> with an empty <code>ItemStack</code>.</p><li><p><code>get_location()</code>: returns a location compatible to</p></li><p>  <code>minetest.get_inventory(location)</code>.</p><ul><li><p>returns <code>{type=&quot;undefined&quot;}</code> in case location is not known</p></li></ul></ul><br><h3 id="gheader261"><p><code>ItemStack</code></p></h3><p>An <code>ItemStack</code> is a stack of items.</p><br><p>It can be created via <code>ItemStack(x)</code>, where x is an <code>ItemStack</code>,</p><p>an itemstring, a table or <code>nil</code>.</p><br><h4 id="gheader262"><p>Methods</p></h4><ul><li><p><code>is_empty()</code>: returns <code>true</code> if stack is empty.</p></li><li><p><code>get_name()</code>: returns item name (e.g. <code>&quot;default:stone&quot;</code>).</p></li><li><p><code>set_name(item_name)</code>: returns a boolean indicating whether the item was</p></li><p>  cleared.</p><li><p><code>get_count()</code>: Returns number of items on the stack.</p></li><li><p><code>set_count(count)</code>: returns a boolean indicating whether the item was cleared</p></li><ul><li><p><code>count</code>: number, unsigned 16 bit integer</p></li></ul><li><p><code>get_wear()</code>: returns tool wear (<code>0</code>-<code>65535</code>), <code>0</code> for non-tools.</p></li><li><p><code>set_wear(wear)</code>: returns boolean indicating whether item was cleared</p></li><ul><li><p><code>wear</code>: number, unsigned 16 bit integer</p></li></ul><li><p><code>get_meta()</code>: returns ItemStackMetaRef. See section for more details</p></li><li><p><code>get_metadata()</code>: (DEPRECATED) Returns metadata (a string attached to an item</p></li><p>  stack).</p><li><p><code>set_metadata(metadata)</code>: (DEPRECATED) Returns true.</p></li><li><p><code>clear()</code>: removes all items from the stack, making it empty.</p></li><li><p><code>replace(item)</code>: replace the contents of this stack.</p></li><ul><li><p><code>item</code> can also be an itemstring or table.</p></li></ul><li><p><code>to_string()</code>: returns the stack in itemstring form.</p></li><li><p><code>to_table()</code>: returns the stack in Lua table form.</p></li><li><p><code>get_stack_max()</code>: returns the maximum size of the stack (depends on the</p></li><p>  item).</p><li><p><code>get_free_space()</code>: returns <code>get_stack_max() - get_count()</code>.</p></li><li><p><code>is_known()</code>: returns <code>true</code> if the item name refers to a defined item type.</p></li><li><p><code>get_definition()</code>: returns the item definition table.</p></li><li><p><code>get_tool_capabilities()</code>: returns the digging properties of the item,</p></li><p>  or those of the hand if none are defined for this item type</p><li><p><code>add_wear(amount)</code></p></li><ul><li><p>Increases wear by <code>amount</code> if the item is a tool</p></li><li><p><code>amount</code>: number, integer</p></li></ul><li><p><code>add_item(item)</code>: returns leftover <code>ItemStack</code></p></li><ul><li><p>Put some item or stack onto this stack</p></li></ul><li><p><code>item_fits(item)</code>: returns <code>true</code> if item or stack can be fully added to</p></li><p>  this one.</p><li><p><code>take_item(n)</code>: returns taken <code>ItemStack</code></p></li><ul><li><p>Take (and remove) up to <code>n</code> items from this stack</p></li><li><p><code>n</code>: number, default: <code>1</code></p></li></ul><li><p><code>peek_item(n)</code>: returns taken <code>ItemStack</code></p></li><ul><li><p>Copy (don&#x27;t remove) up to <code>n</code> items from this stack</p></li><li><p><code>n</code>: number, default: <code>1</code></p></li></ul></ul><br><h3 id="gheader263"><p><code>ItemStackMetaRef</code></p></h3><p>ItemStack metadata: reference extra data and functionality stored in a stack.</p><p>Can be obtained via <code>item:get_meta()</code>.</p><br><h4 id="gheader264"><p>Methods</p></h4><ul><li><p>All methods in MetaDataRef</p></li><li><p><code>set_tool_capabilities([tool_capabilities])</code></p></li><ul><li><p>Overrides the item&#x27;s tool capabilities</p></li><li><p>A nil value will clear the override data and restore the original</p></li><p>      behavior.</p></ul></ul><br><h3 id="gheader265"><p><code>MetaDataRef</code></p></h3><p>See <code>StorageRef</code>, <code>NodeMetaRef</code>, <code>ItemStackMetaRef</code>, and <code>PlayerMetaRef</code>.</p><br><h4 id="gheader266"><p>Methods</p></h4><ul><li><p><code>contains(key)</code>: Returns true if key present, otherwise false.</p></li><ul><li><p>Returns <code>nil</code> when the MetaData is inexistent.</p></li></ul><li><p><code>get(key)</code>: Returns <code>nil</code> if key not present, else the stored string.</p></li><li><p><code>set_string(key, value)</code>: Value of <code>&quot;&quot;</code> will delete the key.</p></li><li><p><code>get_string(key)</code>: Returns <code>&quot;&quot;</code> if key not present.</p></li><li><p><code>set_int(key, value)</code></p></li><li><p><code>get_int(key)</code>: Returns <code>0</code> if key not present.</p></li><li><p><code>set_float(key, value)</code></p></li><li><p><code>get_float(key)</code>: Returns <code>0</code> if key not present.</p></li><li><p><code>to_table()</code>: returns <code>nil</code> or a table with keys:</p></li><ul><li><p><code>fields</code>: key-value storage</p></li><li><p><code>inventory</code>: <code>{list1 = {}, ...}}</code> (NodeMetaRef only)</p></li></ul><li><p><code>from_table(nil or {})</code></p></li><ul><li><p>Any non-table value will clear the metadata</p></li><li><p>See &quot;Node Metadata&quot; for an example</p></li><li><p>returns <code>true</code> on success</p></li></ul><li><p><code>equals(other)</code></p></li><ul><li><p>returns <code>true</code> if this metadata has the same key-value pairs as <code>other</code></p></li></ul></ul><br><h3 id="gheader267"><p>ModChannel</p></h3><p>An interface to use mod channels on client and server</p><br><h4 id="gheader268"><p>Methods</p></h4><ul><li><p><code>leave()</code>: leave the mod channel.</p></li><ul><li><p>Server leaves channel <code>channel_name</code>.</p></li><li><p>No more incoming or outgoing messages can be sent to this channel from</p></li><p>      server mods.</p><li><p>This invalidate all future object usage.</p></li><li><p>Ensure your set mod_channel to nil after that to free Lua resources.</p></li></ul><li><p><code>is_writeable()</code>: returns true if channel is writeable and mod can send over</p></li><p>  it.</p><li><p><code>send_all(message)</code>: Send <code>message</code> though the mod channel.</p></li><ul><li><p>If mod channel is not writeable or invalid, message will be dropped.</p></li><li><p>Message size is limited to 65535 characters by protocol.</p></li></ul></ul><br><h3 id="gheader269"><p><code>NodeMetaRef</code></p></h3><p>Node metadata: reference extra data and functionality stored in a node.</p><p>Can be obtained via <code>minetest.get_meta(pos)</code>.</p><br><h4 id="gheader270"><p>Methods</p></h4><ul><li><p>All methods in MetaDataRef</p></li><li><p><code>get_inventory()</code>: returns <code>InvRef</code></p></li><li><p><code>mark_as_private(name or {name1, name2, ...})</code>: Mark specific vars as private</p></li><p>  This will prevent them from being sent to the client. Note that the &quot;private&quot;</p><p>  status will only be remembered if an associated key-value pair exists,</p><p>  meaning it&#x27;s best to call this when initializing all other meta (e.g.</p><p>  <code>on_construct</code>).</p></ul><br><h3 id="gheader271"><p><code>NodeTimerRef</code></p></h3><p>Node Timers: a high resolution persistent per-node timer.</p><p>Can be gotten via <code>minetest.get_node_timer(pos)</code>.</p><br><h4 id="gheader272"><p>Methods</p></h4><ul><li><p><code>set(timeout,elapsed)</code></p></li><ul><li><p>set a timer&#x27;s state</p></li><li><p><code>timeout</code> is in seconds, and supports fractional values (0.1 etc)</p></li><li><p><code>elapsed</code> is in seconds, and supports fractional values (0.1 etc)</p></li><li><p>will trigger the node&#x27;s <code>on_timer</code> function after <code>(timeout - elapsed)</code></p></li><p>      seconds.</p></ul><li><p><code>start(timeout)</code></p></li><ul><li><p>start a timer</p></li><li><p>equivalent to <code>set(timeout,0)</code></p></li></ul><li><p><code>stop()</code></p></li><ul><li><p>stops the timer</p></li></ul><li><p><code>get_timeout()</code>: returns current timeout in seconds</p></li><ul><li><p>if <code>timeout</code> equals <code>0</code>, timer is inactive</p></li></ul><li><p><code>get_elapsed()</code>: returns current elapsed time in seconds</p></li><ul><li><p>the node&#x27;s <code>on_timer</code> function will be called after <code>(timeout - elapsed)</code></p></li><p>      seconds.</p></ul><li><p><code>is_started()</code>: returns boolean state of timer</p></li><ul><li><p>returns <code>true</code> if timer is started, otherwise <code>false</code></p></li></ul></ul><br><h3 id="gheader273"><p><code>ObjectRef</code></p></h3><p>Moving things in the game are generally these.</p><br><p>This is basically a reference to a C++ <code>ServerActiveObject</code></p><br><h4 id="gheader274"><p>Methods</p></h4><ul><li><p><code>remove()</code>: remove object (after returning from Lua)</p></li><ul><li><p>Note: Doesn&#x27;t work on players, use <code>minetest.kick_player</code> instead</p></li></ul><li><p><code>get_pos()</code>: returns <code>{x=num, y=num, z=num}</code></p></li><li><p><code>set_pos(pos)</code>; <code>pos</code>=<code>{x=num, y=num, z=num}</code></p></li><li><p><code>move_to(pos, continuous=false)</code>: interpolated move</p></li><li><p><code>punch(puncher, time_from_last_punch, tool_capabilities, direction)</code></p></li><ul><li><p><code>puncher</code> = another <code>ObjectRef</code>,</p></li><li><p><code>time_from_last_punch</code> = time since last punch action of the puncher</p></li><li><p><code>direction</code>: can be <code>nil</code></p></li></ul><li><p><code>right_click(clicker)</code>; <code>clicker</code> is another <code>ObjectRef</code></p></li><li><p><code>get_hp()</code>: returns number of hitpoints (2 * number of hearts)</p></li><li><p><code>set_hp(hp, reason)</code>: set number of hitpoints (2 * number of hearts).</p></li><ul><li><p>See reason in register_on_player_hpchange</p></li></ul><li><p><code>get_inventory()</code>: returns an <code>InvRef</code></p></li><li><p><code>get_wield_list()</code>: returns the name of the inventory list the wielded item</p></li><p>   is in.</p><li><p><code>get_wield_index()</code>: returns the index of the wielded item</p></li><li><p><code>get_wielded_item()</code>: returns an <code>ItemStack</code></p></li><li><p><code>set_wielded_item(item)</code>: replaces the wielded item, returns <code>true</code> if</p></li><p>  successful.</p><li><p><code>set_armor_groups({group1=rating, group2=rating, ...})</code></p></li><li><p><code>get_armor_groups()</code>: returns a table with the armor group ratings</p></li><li><p><code>set_animation(frame_range, frame_speed, frame_blend, frame_loop)</code></p></li><ul><li><p><code>frame_range</code>: table {x=num, y=num}, default: <code>{x=1, y=1}</code></p></li><li><p><code>frame_speed</code>: number, default: <code>15.0</code></p></li><li><p><code>frame_blend</code>: number, default: <code>0.0</code></p></li><li><p><code>frame_loop</code>: boolean, default: <code>true</code></p></li></ul><li><p><code>get_animation()</code>: returns <code>range</code>, <code>frame_speed</code>, <code>frame_blend</code> and</p></li><p>  <code>frame_loop</code>.</p><li><p><code>set_animation_frame_speed(frame_speed)</code></p></li><ul><li><p><code>frame_speed</code>: number, default: <code>15.0</code></p></li></ul><li><p><code>set_attach(parent, bone, position, rotation)</code></p></li><ul><li><p><code>bone</code>: string</p></li><li><p><code>position</code>: <code>{x=num, y=num, z=num}</code> (relative)</p></li><li><p><code>rotation</code>: <code>{x=num, y=num, z=num}</code> = Rotation on each axis, in degrees</p></li></ul><li><p><code>get_attach()</code>: returns parent, bone, position, rotation or nil if it isn&#x27;t</p></li><p>  attached.</p><li><p><code>set_detach()</code></p></li><li><p><code>set_bone_position(bone, position, rotation)</code></p></li><ul><li><p><code>bone</code>: string</p></li><li><p><code>position</code>: <code>{x=num, y=num, z=num}</code> (relative)</p></li><li><p><code>rotation</code>: <code>{x=num, y=num, z=num}</code></p></li></ul><li><p><code>get_bone_position(bone)</code>: returns position and rotation of the bone</p></li><li><p><code>set_properties(object property table)</code></p></li><li><p><code>get_properties()</code>: returns object property table</p></li><li><p><code>is_player()</code>: returns true for players, false otherwise</p></li><li><p><code>get_nametag_attributes()</code></p></li><ul><li><p>returns a table with the attributes of the nametag of an object</p></li><li><p>{</p></li><p>        color = {a=0..255, r=0..255, g=0..255, b=0..255},</p><p>        text = &quot;&quot;,</p><p>      }</p></ul><li><p><code>set_nametag_attributes(attributes)</code></p></li><ul><li><p>sets the attributes of the nametag of an object</p></li><li><p><code>attributes</code>:</p></li><p>      {</p><p>        color = ColorSpec,</p><p>        text = &quot;My Nametag&quot;,</p><p>      }</p></ul></ul><br><h5 id="gheader275"><p>LuaEntitySAO-only (no-op for other objects)</p></h5><ul><li><p><code>set_velocity(vel)</code></p></li><ul><li><p><code>vel</code> is a vector, e.g. <code>{x=0.0, y=2.3, z=1.0}</code></p></li></ul><li><p><code>add_velocity(vel)</code></p></li><ul><li><p><code>vel</code> is a vector, e.g. <code>{x=0.0, y=2.3, z=1.0}</code></p></li><li><p>In comparison to using get_velocity, adding the velocity and then using</p></li><p>      set_velocity, add_velocity is supposed to avoid synchronization problems.</p></ul><li><p><code>get_velocity()</code>: returns the velocity, a vector</p></li><li><p><code>set_acceleration(acc)</code></p></li><ul><li><p><code>acc</code> is a vector</p></li></ul><li><p><code>get_acceleration()</code>: returns the acceleration, a vector</p></li><li><p><code>set_yaw(radians)</code></p></li><li><p><code>get_yaw()</code>: returns number in radians</p></li><li><p><code>set_texture_mod(mod)</code></p></li><li><p><code>get_texture_mod()</code> returns current texture modifier</p></li><li><p><code>set_sprite(p, num_frames, framelength, select_horiz_by_yawpitch)</code></p></li><ul><li><p>Select sprite from spritesheet with optional animation and Dungeon Master</p></li><p>      style texture selection based on yaw relative to camera</p><li><p><code>p</code>: {x=number, y=number}, the coordinate of the first frame</p></li><p>      (x: column, y: row), default: <code>{x=0, y=0}</code></p><li><p><code>num_frames</code>: number, default: <code>1</code></p></li><li><p><code>framelength</code>: number, default: <code>0.2</code></p></li><li><p><code>select_horiz_by_yawpitch</code>: boolean, this was once used for the Dungeon</p></li><p>      Master mob, default: <code>false</code></p></ul><li><p><code>get_entity_name()</code> (<b>Deprecated</b>: Will be removed in a future version)</p></li><li><p><code>get_luaentity()</code></p></li></ul><br><h5 id="gheader276"><p>Player-only (no-op for other objects)</p></h5><ul><li><p><code>get_player_name()</code>: returns <code>&quot;&quot;</code> if is not a player</p></li><li><p><code>get_player_velocity()</code>: returns <code>nil</code> if is not a player, otherwise a</p></li><p>  table {x, y, z} representing the player&#x27;s instantaneous velocity in nodes/s</p><li><p><code>get_look_dir()</code>: get camera direction as a unit vector</p></li><li><p><code>get_look_vertical()</code>: pitch in radians</p></li><ul><li><p>Angle ranges between -pi/2 and pi/2, which are straight up and down</p></li><p>      respectively.</p></ul><li><p><code>get_look_horizontal()</code>: yaw in radians</p></li><ul><li><p>Angle is counter-clockwise from the +z direction.</p></li></ul><li><p><code>set_look_vertical(radians)</code>: sets look pitch</p></li><ul><li><p>radians - Angle from looking forward, where positive is downwards.</p></li></ul><li><p><code>set_look_horizontal(radians)</code>: sets look yaw</p></li><ul><li><p>radians - Angle from the +z direction, where positive is</p></li><p>      counter-clockwise.</p></ul><li><p><code>get_look_pitch()</code>: pitch in radians - Deprecated as broken. Use</p></li><p>  <code>get_look_vertical</code>.</p><ul><li><p>Angle ranges between -pi/2 and pi/2, which are straight down and up</p></li><p>      respectively.</p></ul><li><p><code>get_look_yaw()</code>: yaw in radians - Deprecated as broken. Use</p></li><p>  <code>get_look_horizontal</code>.</p><ul><li><p>Angle is counter-clockwise from the +x direction.</p></li></ul><li><p><code>set_look_pitch(radians)</code>: sets look pitch - Deprecated. Use</p></li><p>  <code>set_look_vertical</code>.</p><li><p><code>set_look_yaw(radians)</code>: sets look yaw - Deprecated. Use</p></li><p>  <code>set_look_horizontal</code>.</p><li><p><code>get_breath()</code>: returns players breath</p></li><li><p><code>set_breath(value)</code>: sets players breath</p></li><ul><li><p>values:</p></li><ul><li><p><code>0</code>: player is drowning</p></li><li><p>max: bubbles bar is not shown</p></li><li><p>See Object Properties for more information</p></li></ul></ul><li><p><code>set_attribute(attribute, value)</code>:  DEPRECATED, use get_meta() instead</p></li><ul><li><p>Sets an extra attribute with value on player.</p></li><li><p><code>value</code> must be a string, or a number which will be converted to a</p></li><p>      string.</p><li><p>If <code>value</code> is <code>nil</code>, remove attribute from player.</p></li></ul><li><p><code>get_attribute(attribute)</code>:  DEPRECATED, use get_meta() instead</p></li><ul><li><p>Returns value (a string) for extra attribute.</p></li><li><p>Returns <code>nil</code> if no attribute found.</p></li></ul><li><p><code>get_meta()</code>: Returns a PlayerMetaRef.</p></li><li><p><code>set_inventory_formspec(formspec)</code></p></li><ul><li><p>Redefine player&#x27;s inventory form</p></li><li><p>Should usually be called in <code>on_joinplayer</code></p></li></ul><li><p><code>get_inventory_formspec()</code>: returns a formspec string</p></li><li><p><code>set_formspec_prepend(formspec)</code>:</p></li><ul><li><p>the formspec string will be added to every formspec shown to the user,</p></li><p>      except for those with a no_prepend[] tag.</p><li><p>This should be used to set style elements such as background[] and</p></li><p>      bgcolor[], any non-style elements (eg: label) may result in weird behaviour.</p><li><p>Only affects formspecs shown after this is called.</p></li></ul><li><p><code>get_formspec_prepend(formspec)</code>: returns a formspec string.</p></li><li><p><code>get_player_control()</code>: returns table with player pressed keys</p></li><ul><li><p>The table consists of fields with boolean value representing the pressed</p></li><p>      keys, the fields are jump, right, left, LMB, RMB, sneak, aux1, down, up.</p><li><p>example: </p></li><p>      sneak=true, aux1=false, down=false, up=false}</p></ul><li><p><code>get_player_control_bits()</code>: returns integer with bit packed player pressed</p></li><p>  keys.</p><ul><li><p>bit nr/meaning: 0/up, 1/down, 2/left, 3/right, 4/jump, 5/aux1, 6/sneak,</p></li><p>      7/LMB, 8/RMB</p></ul><li><p><code>set_physics_override(override_table)</code></p></li><ul><li><p><code>override_table</code> is a table with the following fields:</p></li><ul><li><p><code>speed</code>: multiplier to default walking speed value (default: <code>1</code>)</p></li><li><p><code>jump</code>: multiplier to default jump value (default: <code>1</code>)</p></li><li><p><code>gravity</code>: multiplier to default gravity value (default: <code>1</code>)</p></li><li><p><code>sneak</code>: whether player can sneak (default: <code>true</code>)</p></li><li><p><code>sneak_glitch</code>: whether player can use the new move code replications</p></li><p>          of the old sneak side-effects: sneak ladders and 2 node sneak jump</p><p>          (default: <code>false</code>)</p><li><p><code>new_move</code>: use new move/sneak code. When <code>false</code> the exact old code</p></li><p>          is used for the specific old sneak behaviour (default: <code>true</code>)</p></ul></ul><li><p><code>get_physics_override()</code>: returns the table given to <code>set_physics_override</code></p></li><li><p><code>hud_add(hud definition)</code>: add a HUD element described by HUD def, returns ID</p></li><p>   number on success</p><li><p><code>hud_remove(id)</code>: remove the HUD element of the specified id</p></li><li><p><code>hud_change(id, stat, value)</code>: change a value of a previously added HUD</p></li><p>  element.</p><ul><li><p>element <code>stat</code> values:</p></li><p>      <code>position</code>, <code>name</code>, <code>scale</code>, <code>text</code>, <code>number</code>, <code>item</code>, <code>dir</code></p></ul><li><p><code>hud_get(id)</code>: gets the HUD element definition structure of the specified ID</p></li><li><p><code>hud_set_flags(flags)</code>: sets specified HUD flags to <code>true</code>/<code>false</code></p></li><ul><li><p><code>flags</code>: (is visible) <code>hotbar</code>, <code>healthbar</code>, <code>crosshair</code>, <code>wielditem</code>,</p></li><p>      <code>breathbar</code>, <code>minimap</code>, <code>minimap_radar</code></p><li><p>pass a table containing a <code>true</code>/<code>false</code> value of each flag to be set or</p></li><p>      unset.</p><li><p>if a flag equals <code>nil</code>, the flag is not modified</p></li><li><p>note that setting <code>minimap</code> modifies the client&#x27;s permission to view the</p></li><p>      minimap - the client may locally elect to not view the minimap.</p><li><p>minimap <code>radar</code> is only usable when <code>minimap</code> is true</p></li></ul><li><p><code>hud_get_flags()</code>: returns a table containing status of hud flags</p></li><ul><li><p>returns </p></li><p>      breathbar=true, minimap=true, minimap_radar=true}</p></ul><li><p><code>hud_set_hotbar_itemcount(count)</code>: sets number of items in builtin hotbar</p></li><ul><li><p><code>count</code>: number of items, must be between <code>1</code> and <code>23</code></p></li></ul><li><p><code>hud_get_hotbar_itemcount</code>: returns number of visible items</p></li><li><p><code>hud_set_hotbar_image(texturename)</code></p></li><ul><li><p>sets background image for hotbar</p></li></ul><li><p><code>hud_get_hotbar_image</code>: returns texturename</p></li><li><p><code>hud_set_hotbar_selected_image(texturename)</code></p></li><ul><li><p>sets image for selected item of hotbar</p></li></ul><li><p><code>hud_get_hotbar_selected_image</code>: returns texturename</p></li><li><p><code>set_sky(bgcolor, type, {texture names}, clouds)</code></p></li><ul><li><p><code>bgcolor</code>: ColorSpec, defaults to white</p></li><li><p><code>type</code>: Available types:</p></li><ul><li><p><code>&quot;regular&quot;</code>: Uses 0 textures, <code>bgcolor</code> ignored</p></li><li><p><code>&quot;skybox&quot;</code>: Uses 6 textures, <code>bgcolor</code> used</p></li><li><p><code>&quot;plain&quot;</code>: Uses 0 textures, <code>bgcolor</code> used</p></li></ul><li><p><code>clouds</code>: Boolean for whether clouds appear in front of <code>&quot;skybox&quot;</code> or</p></li><p>      <code>&quot;plain&quot;</code> custom skyboxes (default: <code>true</code>)</p></ul><li><p><code>get_sky()</code>: returns bgcolor, type, table of textures, clouds</p></li><li><p><code>set_clouds(parameters)</code>: set cloud parameters</p></li><ul><li><p><code>parameters</code> is a table with the following optional fields:</p></li><ul><li><p><code>density</code>: from <code>0</code> (no clouds) to <code>1</code> (full clouds) (default <code>0.4</code>)</p></li><li><p><code>color</code>: basic cloud color with alpha channel, ColorSpec</p></li><p>          (default <code>#fff0f0e5</code>).</p><li><p><code>ambient</code>: cloud color lower bound, use for a &quot;glow at night&quot; effect.</p></li><p>          ColorSpec (alpha ignored, default <code>#000000</code>)</p><li><p><code>height</code>: cloud height, i.e. y of cloud base (default per conf,</p></li><p>          usually <code>120</code>)</p><li><p><code>thickness</code>: cloud thickness in nodes (default <code>16</code>)</p></li><li><p><code>speed</code>: 2D cloud speed + direction in nodes per second</p></li><p>          (default <code>{x=0, z=-2}</code>).</p></ul></ul><li><p><code>get_clouds()</code>: returns a table with the current cloud parameters as in</p></li><p>  <code>set_clouds</code>.</p><li><p><code>override_day_night_ratio(ratio or nil)</code></p></li><ul><li><p><code>0</code>...<code>1</code>: Overrides day-night ratio, controlling sunlight to a specific</p></li><p>      amount.</p><li><p><code>nil</code>: Disables override, defaulting to sunlight based on day-night cycle</p></li></ul><li><p><code>get_day_night_ratio()</code>: returns the ratio or nil if it isn&#x27;t overridden</p></li><li><p><code>set_local_animation(stand/idle, walk, dig, walk+dig, frame_speed=frame_speed)</code>:</p></li><p>  set animation for player model in third person view</p></ul><br><pre><code>    set_local_animation({x=0, y=79}, -- &lt; stand/idle animation key frames
        {x=168, y=187}, -- &lt; walk animation key frames
        {x=189, y=198}, -- &lt;  dig animation key frames
        {x=200, y=219}, -- &lt;  walk+dig animation key frames
        frame_speed=30): -- &lt;  animation frame speed
</code></pre><ul><li><p><code>get_local_animation()</code>: returns stand, walk, dig, dig+walk tables and</p></li><p>  <code>frame_speed</code>.</p><li><p><code>set_eye_offset({x=0,y=0,z=0},{x=0,y=0,z=0})</code>: defines offset value for</p></li><p>  camera per player.</p><ul><li><p>in first person view</p></li><li><p>in third person view (max. values <code>{x=-10/10,y=-10,15,z=-5/5}</code>)</p></li></ul><li><p><code>get_eye_offset()</code>: returns <code>offset_first</code> and <code>offset_third</code></p></li></ul><br><h3 id="gheader277"><p><code>PcgRandom</code></p></h3><p>A 32-bit pseudorandom number generator.</p><p>Uses PCG32, an algorithm of the permuted congruential generator family,</p><p>offering very strong randomness.</p><br><p>It can be created via <code>PcgRandom(seed)</code> or <code>PcgRandom(seed, sequence)</code>.</p><br><h4 id="gheader278"><p>Methods</p></h4><ul><li><p><code>next()</code>: return next integer random number [<code>-2147483648</code>...<code>2147483647</code>]</p></li><li><p><code>next(min, max)</code>: return next integer random number [<code>min</code>...<code>max</code>]</p></li><li><p><code>rand_normal_dist(min, max, num_trials=6)</code>: return normally distributed</p></li><p>  random number [<code>min</code>...<code>max</code>].</p><ul><li><p>This is only a rough approximation of a normal distribution with:</p></li><li><p><code>mean = (max - min) / 2</code>, and</p></li><li><p><code>variance = (((max - min + 1) ^ 2) - 1) / (12 * num_trials)</code></p></li><li><p>Increasing <code>num_trials</code> improves accuracy of the approximation</p></li></ul></ul><br><h3 id="gheader279"><p><code>PerlinNoise</code></p></h3><p>A perlin noise generator.</p><p>It can be created via <code>PerlinNoise(seed, octaves, persistence, scale)</code></p><p>or <code>PerlinNoise(noiseparams)</code>.</p><p>Alternatively with <code>minetest.get_perlin(seeddiff, octaves, persistence, scale)</code></p><p>or <code>minetest.get_perlin(noiseparams)</code>.</p><br><h4 id="gheader280"><p>Methods</p></h4><ul><li><p><code>get_2d(pos)</code>: returns 2D noise value at <code>pos={x=,y=}</code></p></li><li><p><code>get_3d(pos)</code>: returns 3D noise value at <code>pos={x=,y=,z=}</code></p></li></ul><br><h3 id="gheader281"><p><code>PerlinNoiseMap</code></p></h3><p>A fast, bulk perlin noise generator.</p><br><p>It can be created via <code>PerlinNoiseMap(noiseparams, size)</code> or</p><p><code>minetest.get_perlin_map(noiseparams, size)</code>.</p><br><p>Format of <code>size</code> is <code>{x=dimx, y=dimy, z=dimz}</code>. The <code>z</code> component is omitted</p><p>for 2D noise, and it must be must be larger than 1 for 3D noise (otherwise</p><p><code>nil</code> is returned).</p><br><p>For each of the functions with an optional <code>buffer</code> parameter: If <code>buffer</code> is</p><p>not nil, this table will be used to store the result instead of creating a new</p><p>table.</p><br><h4 id="gheader282"><p>Methods</p></h4><ul><li><p><code>get_2d_map(pos)</code>: returns a <code>&lt;size.x&gt;</code> times <code>&lt;size.y&gt;</code> 2D array of 2D noise</p></li><p>  with values starting at <code>pos={x=,y=}</code></p><li><p><code>get_3d_map(pos)</code>: returns a <code>&lt;size.x&gt;</code> times <code>&lt;size.y&gt;</code> times <code>&lt;size.z&gt;</code></p></li><p>  3D array of 3D noise with values starting at <code>pos={x=,y=,z=}</code>.</p><li><p><code>get_2d_map_flat(pos, buffer)</code>: returns a flat <code>&lt;size.x * size.y&gt;</code> element</p></li><p>  array of 2D noise with values starting at <code>pos={x=,y=}</code></p><li><p><code>get_3d_map_flat(pos, buffer)</code>: Same as <code>get2dMap_flat</code>, but 3D noise</p></li><li><p><code>calc_2d_map(pos)</code>: Calculates the 2d noise map starting at <code>pos</code>. The result</p></li><p>  is stored internally.</p><li><p><code>calc_3d_map(pos)</code>: Calculates the 3d noise map starting at <code>pos</code>. The result</p></li><p>  is stored internally.</p><li><p><code>get_map_slice(slice_offset, slice_size, buffer)</code>: In the form of an array,</p></li><p>  returns a slice of the most recently computed noise results. The result slice</p><p>  begins at coordinates <code>slice_offset</code> and takes a chunk of <code>slice_size</code>.</p><p>  E.g. to grab a 2-slice high horizontal 2d plane of noise starting at buffer</p><p>  offset y = 20:</p><p>  <code>noisevals = noise:get_map_slice({y=20}, {y=2})</code></p><p>  It is important to note that <code>slice_offset</code> offset coordinates begin at 1,</p><p>  and are relative to the starting position of the most recently calculated</p><p>  noise.</p><p>  To grab a single vertical column of noise starting at map coordinates</p><p>  x = 1023, y=1000, z = 1000:</p><p>  <code>noise:calc_3d_map({x=1000, y=1000, z=1000})</code></p><p>  <code>noisevals = noise:get_map_slice({x=24, z=1}, {x=1, z=1})</code></p></ul><br><h3 id="gheader283"><p><code>PlayerMetaRef</code></p></h3><p>Player metadata.</p><p>Uses the same method of storage as the deprecated player attribute API, so</p><p>data there will also be in player meta.</p><p>Can be obtained using <code>player:get_meta()</code>.</p><br><h4 id="gheader284"><p>Methods</p></h4><ul><li><p>All methods in MetaDataRef</p></li></ul><br><h3 id="gheader285"><p><code>PseudoRandom</code></p></h3><p>A 16-bit pseudorandom number generator.</p><p>Uses a well-known LCG algorithm introduced by K&amp;R.</p><br><p>It can be created via <code>PseudoRandom(seed)</code>.</p><br><h4 id="gheader286"><p>Methods</p></h4><ul><li><p><code>next()</code>: return next integer random number [<code>0</code>...<code>32767</code>]</p></li><li><p><code>next(min, max)</code>: return next integer random number [<code>min</code>...<code>max</code>]</p></li><ul><li><p><code>((max - min) == 32767) or ((max-min) &lt;= 6553))</code> must be true</p></li><p>      due to the simple implementation making bad distribution otherwise.</p></ul></ul><br><h3 id="gheader287"><p><code>Raycast</code></p></h3><p>A raycast on the map. It works with selection boxes.</p><p>Can be used as an iterator in a for loop.</p><br><p>The map is loaded as the ray advances. If the</p><p>map is modified after the <code>Raycast</code> is created,</p><p>the changes may or may not have an effect on</p><p>the object.</p><br><p>It can be created via <code>Raycast(pos1, pos2, objects, liquids)</code> or</p><p><code>minetest.raycast(pos1, pos2, objects, liquids)</code> where:</p><ul><li><p><code>pos1</code>: start of the ray</p></li><li><p><code>pos2</code>: end of the ray</p></li><li><p><code>objects</code> : if false, only nodes will be returned. Default is true.</p></li><li><p></p></li></ul><br><h4 id="gheader288"><p>Methods</p></h4><ul><li><p><code>next()</code>: returns a <code>pointed_thing</code></p></li><ul><li><p>Returns the next thing pointed by the ray or nil.</p></li></ul></ul><br><h3 id="gheader289"><p><code>SecureRandom</code></p></h3><p>Interface for the operating system&#x27;s crypto-secure PRNG.</p><br><p>It can be created via <code>SecureRandom()</code>.  The constructor returns nil if a</p><p>secure random device cannot be found on the system.</p><br><h4 id="gheader290"><p>Methods</p></h4><ul><li><p><code>next_bytes([count])</code>: return next <code>count</code> (default 1, capped at 2048) many</p></li><p>  random bytes, as a string.</p></ul><br><h3 id="gheader291"><p><code>Settings</code></p></h3><p>An interface to read config files in the format of <code>minetest.conf</code>.</p><br><p>It can be created via <code>Settings(filename)</code>.</p><br><h4 id="gheader292"><p>Methods</p></h4><ul><li><p><code>get(key)</code>: returns a value</p></li><li><p><code>get_bool(key, [default])</code>: returns a boolean</p></li><ul><li><p><code>default</code> is the value returned if <code>key</code> is not found.</p></li><li><p>Returns <code>nil</code> if <code>key</code> is not found and <code>default</code> not specified.</p></li></ul><li><p><code>get_np_group(key)</code>: returns a NoiseParams table</p></li><li><p><code>set(key, value)</code></p></li><ul><li><p>Setting names can&#x27;t contain whitespace or any of <code>=&quot;{}#</code>.</p></li><li><p>Setting values can&#x27;t contain the sequence <code>\n&quot;&quot;&quot;</code>.</p></li><li><p>Setting names starting with &quot;secure.&quot; can&#x27;t be set on the main settings</p></li><p>      object (<code>minetest.settings</code>).</p></ul><li><p><code>set_bool(key, value)</code></p></li><ul><li><p>See documentation for set() above.</p></li></ul><li><p><code>set_np_group(key, value)</code></p></li><ul><li><p><code>value</code> is a NoiseParams table.</p></li><li><p>Also, see documentation for set() above.</p></li></ul><li><p><code>remove(key)</code>: returns a boolean (<code>true</code> for success)</p></li><li><p><code>get_names()</code>: returns <code>{key1,...}</code></p></li><li><p><code>write()</code>: returns a boolean (<code>true</code> for success)</p></li><ul><li><p>Writes changes to file.</p></li></ul><li><p><code>to_table()</code>: returns <code>{[key1]=value1,...}</code></p></li></ul><br><h3 id="gheader293"><p><code>StorageRef</code></p></h3><p>Mod metadata: per mod metadata, saved automatically.</p><p>Can be obtained via <code>minetest.get_mod_storage()</code> during load time.</p><br><h4 id="gheader294"><p>Methods</p></h4><ul><li><p>All methods in MetaDataRef</p></li><h1 id="gheader295"><br></h1></ul><br><h2 id="gheader296"><p>Definition tables</p></h2><br><br><h3 id="gheader297"><p>Object Properties</p></h3><br><pre><code>{
    hp_max = 1,
--  ^ For players: Defaults to `minetest.PLAYER_MAX_HP_DEFAULT`
    breath_max = 0,
--  ^ For players only. Defaults to `minetest.PLAYER_MAX_BREATH_DEFAULT`
    zoom_fov = 0.0,
--  ^ For players only. Zoom FOV in degrees.
--    Note that zoom loads and/or generates world beyond the server&#x27;s
--    maximum send and generate distances, so acts like a telescope.
--    Smaller zoomFOV values increase the distance loaded and/or generated.
--    Defaults to 15 in creative mode, 0 in survival mode.
--    zoom_fov = 0 disables zooming for the player.
    eye_height = 1.625,
--  ^ For players only. Camera height above feet position in nodes.
--    Defaults to 1.625.
    physical = true,
    collide_with_objects = true,
--  ^ Collide with other objects if physical = true.
    weight = 5,
    collisionbox = {-0.5, 0.0, -0.5, 0.5, 1.0, 0.5},
    selectionbox = {-0.5, 0.0, -0.5, 0.5, 1.0, 0.5},
--  ^ Default, uses collision box dimensions when not set.
--  ^ For both boxes: {xmin, ymin, zmin, xmax, ymax, zmax} in nodes from
--    object position.
    pointable = true,
--  ^ Overrides selection box when false.
    visual = &quot;cube&quot; / &quot;sprite&quot; / &quot;upright_sprite&quot; / &quot;mesh&quot; / &quot;wielditem&quot;,
--  ^ &quot;cube&quot; is a node-sized cube.
--  ^ &quot;sprite&quot; is a flat texture always facing the player.
--  ^ &quot;upright_sprite&quot; is a vertical flat texture.
--  ^ &quot;mesh&quot; uses the defined mesh model.
--  ^ &quot;wielditem&quot; is used for dropped items
--    (see builtin/game/item_entity.lua).
--    For this use &#x27;textures = {itemname}&#x27;.
--    If the item has a &#x27;wield_image&#x27; the object will be an extrusion of
--    that, otherwise:
--    If &#x27;itemname&#x27; is a cubic node or nodebox the object will appear
--    identical to &#x27;itemname&#x27;.
--    If &#x27;itemname&#x27; is a plantlike node the object will be an extrusion of
--    its texture.
--    Otherwise for non-node items, the object will be an extrusion of
--    &#x27;inventory_image&#x27;.
    visual_size = {x = 1, y = 1},
--  ^ `x` multiplies horizontal (X and Z) visual size.
--  ^ `y` multiplies vertical (Y) visual size.
    mesh = &quot;model&quot;,
    textures = {},
--  ^ Number of required textures depends on visual.
--  ^ &quot;cube&quot; uses 6 textures in the way a node does.
--  ^ &quot;sprite&quot; uses 1 texture.
--  ^ &quot;upright_sprite&quot; uses 2 textures: {front, back}.
--  ^ &quot;wielditem&quot; expects &#x27;textures = {itemname}&#x27; (see &#x27;visual&#x27; above).
    colors = {},
--  ^ Number of required colors depends on visual.
    use_texture_alpha = false,
--  ^ Use texture&#x27;s alpha channel, excludes &quot;upright_sprite&quot; and &quot;wielditem&quot;
</code></pre><p>	--  ^ Note: currently causes visual issues when viewed through other</p><p>	--  ^ semi-transparent materials such as water.</p><pre><code>    spritediv = {x = 1, y = 1},
--  ^ Used with spritesheet textures for animation and/or frame selection
--    according to position relative to player.
--  ^ Defines the number of columns and rows in the spritesheet:
--    {columns, rows}.
    initial_sprite_basepos = {x = 0, y = 0},
--  ^ Used with spritesheet textures.
--  ^ Defines the {column, row} position of the initially used frame in the
--    spritesheet.
    is_visible = true,
    makes_footstep_sound = false,
    automatic_rotate = 0,
--  ^ Set constant rotation in radians per second, positive or negative.
--  ^ Set to 0 to disable constant rotation.
    stepheight = 0,
    automatic_face_movement_dir = 0.0,
--  ^ Automatically set yaw to movement direction, offset in degrees,
--    &#x27;false&#x27; to disable.
    automatic_face_movement_max_rotation_per_sec = -1,
--  ^ Limit automatic rotation to this value in degrees per second,
--    value &lt; 0 no limit.
    backface_culling = true,
--  ^ Set to false to disable backface_culling for model.
    glow = 0,
--  ^ Add this much extra lighting when calculating texture color.
--    Value &lt; 0 disables light&#x27;s effect on texture color.
--    For faking self-lighting, UI style entities, or programmatic coloring
--    in mods.
    nametag = &quot;&quot;,
--  ^ By default empty, for players their name is shown if empty.
    nametag_color = &lt;color&gt;,
--  ^ Sets color of nametag as ColorSpec.
    infotext = &quot;&quot;,
--  ^ By default empty, text to be shown when pointed at object.
    static_save = true,
--  ^ If false, never save this object statically. It will simply be
--    deleted when the block gets unloaded.
--    The get_staticdata() callback is never called then.
--    Defaults to &#x27;true&#x27;
}
</code></pre><br><h3 id="gheader298"><p>Entity definition (<code>register_entity</code>)</p></h3><br><pre><code>{
--  Deprecated: Everything in object properties is read directly from here
</code></pre><br><pre><code>    initial_properties = --[[&lt;initial object properties&gt;]],
</code></pre><br><pre><code>    on_activate = function(self, staticdata, dtime_s),
    on_step = function(self, dtime),
    on_punch = function(self, puncher, time_from_last_punch, tool_capabilities, dir),
    on_rightclick = function(self, clicker),
    get_staticdata = function(self),
--  ^ Called sometimes; the string returned is passed to on_activate when
--    the entity is re-activated from static state
</code></pre><br><pre><code>    _custom_field = whatever,
--  ^ You can define arbitrary member variables here (see item definition
--    for more info) by using a &#x27;_&#x27; prefix.
}
</code></pre><br><h3 id="gheader299"><p>ABM (ActiveBlockModifier) definition (<code>register_abm</code>)</p></h3><br><pre><code>{
    label = &quot;Lava cooling&quot;,
    ^ Descriptive label for profiling purposes (optional).
      Definitions with identical labels will be listed as one.
    nodenames = {&quot;default:lava_source&quot;},
    ^ Apply `action` function to these nodes.
    ^ `group:groupname` can also be used here.
    neighbors = {&quot;default:water_source&quot;, &quot;default:water_flowing&quot;},
    ^ Only apply `action` to nodes that have one of, or any
      combination of, these neighbors.
    ^ If left out or empty, any neighbor will do.
    ^ `group:groupname` can also be used here.
    interval = 1.0,
    ^ Operation interval in seconds.
    chance = 1,
    ^ Chance of triggering `action` per-node per-interval is 1.0 / this
      value.
    catch_up = true,
    ^ If true, catch-up behaviour is enabled: The `chance` value is
      temporarily reduced when returning to an area to simulate time lost
      by the area being unattended. Note that the `chance` value can often
      be reduced to 1.
    action = function(pos, node, active_object_count, active_object_count_wider),
    ^ Function triggered for each qualifying node.
    ^ `active_object_count` is number of active objects in the node&#x27;s
      mapblock.
    ^ `active_object_count_wider` is number of active objects in the node&#x27;s
      mapblock plus all 26 neighboring mapblocks. If any neighboring
      mapblocks are unloaded an estmate is calculated for them based on
      loaded mapblocks.
}
</code></pre><br><h3 id="gheader300"><p>LBM (LoadingBlockModifier) definition (<code>register_lbm</code>)</p></h3><br><pre><code>{
    label = &quot;Upgrade legacy doors&quot;,
--  ^ Descriptive label for profiling purposes (optional).
--    Definitions with identical labels will be listed as one.
    name = &quot;modname:replace_legacy_door&quot;,
    nodenames = {&quot;default:lava_source&quot;},
--  ^ List of node names to trigger the LBM on.
--    Also non-registered nodes will work.
--    Groups (as of group:groupname) will work as well.
    run_at_every_load = false,
--  ^ Whether to run the LBM&#x27;s action every time a block gets loaded,
--    and not just for blocks that were saved last time before LBMs were
--    introduced to the world.
    action = func(pos, node),
}
</code></pre><br><h3 id="gheader301"><p>Item definition (<code>register_node</code>, <code>register_craftitem</code>, <code>register_tool</code>)</p></h3><br><pre><code>{
    description = &quot;Steel Axe&quot;,
    groups = {}, -- key = name, value = rating; rating = 1..3.
                    if rating not applicable, use 1.
                    e.g. {wool = 1, fluffy = 3}
                        {soil = 2, outerspace = 1, crumbly = 1}
                        {bendy = 2, snappy = 1},
                        {hard = 1, metal = 1, spikes = 1}
    inventory_image = &quot;default_tool_steelaxe.png&quot;,
    inventory_overlay = &quot;overlay.png&quot;,
    ^ An overlay which does not get colorized.
    wield_image = &quot;&quot;,
    wield_overlay = &quot;&quot;,
    palette = &quot;&quot;,
    --[[
    ^ An image file containing the palette of a node.
    ^ You can set the currently used color as the
    ^ &quot;palette_index&quot; field of the item stack metadata.
    ^ The palette is always stretched to fit indices
    ^ between 0 and 255, to ensure compatibility with
    ^ &quot;colorfacedir&quot; and &quot;colorwallmounted&quot; nodes.
    ]]
    color = &quot;0xFFFFFFFF&quot;,
    ^ The color of the item. The palette overrides this.
    wield_scale = {x = 1, y = 1, z = 1},
    stack_max = 99,
    range = 4.0,
    liquids_pointable = false,
    tool_capabilities = {
        full_punch_interval = 1.0,
        max_drop_level = 0,
        groupcaps = {
            -- For example:
            choppy = {times = {[1] = 2.50, [2] = 1.40, [3] = 1.00},
                     uses = 20, maxlevel = 2},
        },
        damage_groups = {groupname = damage},
    },
    node_placement_prediction = nil,
    --[[
    ^ If nil and item is node, prediction is made automatically
    ^ If nil and item is not a node, no prediction is made
    ^ If &quot;&quot; and item is anything, no prediction is made
    ^ Otherwise should be name of node which the client immediately places
      on ground when the player places the item. Server will always update
      actual result to client in a short moment.
    ]]
    node_dig_prediction = &quot;air&quot;,
    --[[
    ^ if &quot;&quot;, no prediction is made
    ^ if &quot;air&quot;, node is removed
    ^ Otherwise should be name of node which the client immediately places
      upon digging. Server will always update actual result shortly.
    ]]
    sound = {
        breaks = &quot;default_tool_break&quot;, -- tools only
        place = --[[&lt;SimpleSoundSpec&gt;]],
    },
</code></pre><br><pre><code>    on_place = func(itemstack, placer, pointed_thing),
    --[[
    ^ Shall place item and return the leftover itemstack
    ^ The placer may be any ObjectRef or nil.
    ^ default: minetest.item_place ]]
    on_secondary_use = func(itemstack, user, pointed_thing),
    --[[
    ^ Same as on_place but called when pointing at nothing.
    ^ The user may be any ObjectRef or nil.
    ^ pointed_thing : always { type = &quot;nothing&quot; }
    ]]
    on_drop = func(itemstack, dropper, pos),
    --[[
    ^ Shall drop item and return the leftover itemstack
    ^ The dropper may be any ObjectRef or nil.
    ^ default: minetest.item_drop ]]
    on_use = func(itemstack, user, pointed_thing),
    --[[
    ^  default: nil
    ^ Function must return either nil if no item shall be removed from
      inventory, or an itemstack to replace the original itemstack.
      e.g. itemstack:take_item(); return itemstack
    ^ Otherwise, the function is free to do what it wants.
    ^ The user may be any ObjectRef or nil.
    ^ The default functions handle regular use cases.
    ]]
    after_use = func(itemstack, user, node, digparams),
    --[[
    ^  default: nil
    ^ If defined, should return an itemstack and will be called instead of
      wearing out the tool. If returns nil, does nothing.
      If after_use doesn&#x27;t exist, it is the same as:
        function(itemstack, user, node, digparams)
          itemstack:add_wear(digparams.wear)
          return itemstack
        end
    ^ The user may be any ObjectRef or nil.
    ]]
    _custom_field = whatever,
    --[[
    ^ Add your own custom fields. By convention, all custom field names
      should start with `_` to avoid naming collisions with future engine
      usage.
    ]]
}
</code></pre><br><h3 id="gheader302"><p>Tile definition</p></h3><ul><li><p><code>&quot;image.png&quot;</code></p></li><li><p><code>{name=&quot;image.png&quot;, animation={Tile Animation definition}}</code></p></li><li><p></p></li><p>    tileable_horizontal=bool, align_style=&quot;node&quot;/&quot;world&quot;/&quot;user&quot;, scale=int}</p><ul><li><p>backface culling enabled by default for most nodes</p></li><li><p>tileable flags are info for shaders, how they should treat texture</p></li><p>      when displacement mapping is used</p><p>      Directions are from the point of view of the tile texture,</p><p>      not the node it&#x27;s on</p><li><p>align style determines whether the texture will be rotated with the node</p></li><p>      or kept aligned with its surroundings. &quot;user&quot; means that client</p><p>      setting will be used, similar to <code>glasslike_framed_optional</code>.</p><p>      Note: supported by solid nodes and nodeboxes only.</p><li><p>scale is used to make texture span several (exactly <code>scale</code>) nodes,</p></li><p>      instead of just one, in each direction. Works for world-aligned</p><p>      textures only.</p><p>      Note that as the effect is applied on per-mapblock basis, <code>16</code> should</p><p>      be equally divisible by <code>scale</code> or you may get wrong results.</p></ul><li><p><code>{name=&quot;image.png&quot;, color=ColorSpec}</code></p></li><ul><li><p>the texture&#x27;s color will be multiplied with this color.</p></li><li><p>the tile&#x27;s color overrides the owning node&#x27;s color in all cases.</p></li></ul><li><p>deprecated, yet still supported field names:</p></li><ul><li><p><code>image</code> (name)</p></li></ul></ul><br><h3 id="gheader303"><p>Tile animation definition</p></h3><br><pre><code>{
    type = &quot;vertical_frames&quot;,
    aspect_w = 16,
    -- ^ specify width of a frame in pixels
    aspect_h = 16,
    -- ^ specify height of a frame in pixels
    length = 3.0,
    -- ^ specify full loop length
}
</code></pre><br><pre><code>{
    type = &quot;sheet_2d&quot;,
    frames_w = 5,
    -- ^ specify width in number of frames
    frames_h = 3,
    -- ^ specify height in number of frames
    frame_length = 0.5,
    -- ^ specify length of a single frame
}
</code></pre><br><h3 id="gheader304"><p>Node definition (<code>register_node</code>)</p></h3><br><pre><code>{
    -- &lt;all fields allowed in item definitions&gt;,
</code></pre><br><pre><code>    drawtype = &quot;normal&quot;, -- See &quot;Node drawtypes&quot;
    visual_scale = 1.0, --[[
    ^ Supported for drawtypes &quot;plantlike&quot;, &quot;signlike&quot;, &quot;torchlike&quot;,
    ^ &quot;firelike&quot;, &quot;mesh&quot;.
    ^ For plantlike and firelike, the image will start at the bottom of the
    ^ node, for the other drawtypes the image will be centered on the node.
    ^ Note that positioning for &quot;torchlike&quot; may still change. ]]
    tiles = {tile definition 1, def2, def3, def4, def5, def6}, --[[
    ^ Textures of node; +Y, -Y, +X, -X, +Z, -Z
    ^ Old field name was &#x27;tile_images&#x27;.
    ^ List can be shortened to needed length ]]
    overlay_tiles = {tile definition 1, def2, def3, def4, def5, def6}, --[[
    ^ Same as `tiles`, but these textures are drawn on top of the
    ^ base tiles. You can use this to colorize only specific parts of
    ^ your texture. If the texture name is an empty string, that
    ^ overlay is not drawn. Since such tiles are drawn twice, it
    ^ is not recommended to use overlays on very common nodes. ]]
    special_tiles = {tile definition 1, Tile definition 2}, --[[
    ^ Special textures of node; used rarely
    ^ Old field name was &#x27;special_materials&#x27;.
    ^ List can be shortened to needed length ]]
    color = ColorSpec, --[[
    ^ The node&#x27;s original color will be multiplied with this color.
    ^ If the node has a palette, then this setting only has an effect
    ^ in the inventory and on the wield item. ]]
    use_texture_alpha = false,
    ^ Use texture&#x27;s alpha channel.
    palette = &quot;palette.png&quot;, --[[
    ^ The node&#x27;s `param2` is used to select a pixel from the image
    ^ (pixels are arranged from left to right and from top to bottom).
    ^ The node&#x27;s color will be multiplied with the selected pixel&#x27;s
    ^ color. Tiles can override this behavior.
    ^ Only when `paramtype2` supports palettes. ]]
    post_effect_color = &quot;green#0F&quot;,
    ^ Screen tint if player is inside node, see &quot;ColorSpec&quot;.
    paramtype = &quot;none&quot;, -- See &quot;Nodes&quot;.
    paramtype2 = &quot;none&quot;, -- See &quot;Nodes&quot;
    place_param2 = nil, -- Force value for param2 when player places node
    is_ground_content = true,
    ^ If false, the cave generator will not carve through this node.
    sunlight_propagates = false,
    ^ If true, sunlight will go infinitely through this.
    walkable = true, -- If true, objects collide with node
    pointable = true, -- If true, can be pointed at
    diggable = true, -- If false, can never be dug
    climbable = false, -- If true, can be climbed on (ladder)
    buildable_to = false, -- If true, placed nodes can replace this node
    floodable = false, --[[
    ^ If true, liquids flow into and replace this node.
    ^ Warning: making a liquid node &#x27;floodable&#x27; will cause problems. ]]
    liquidtype = &quot;none&quot;, -- &quot;none&quot;/&quot;source&quot;/&quot;flowing&quot;
    liquid_alternative_flowing = &quot;&quot;, -- Flowing version of source liquid
    liquid_alternative_source = &quot;&quot;, -- Source version of flowing liquid
    liquid_viscosity = 0, -- Higher viscosity = slower flow (max. 7)
    liquid_renewable = true, --[[
    ^ If true, a new liquid source can be created by placing two or more
      sources nearby. ]]
    leveled = 16, --[[
    ^ Only valid for &quot;nodebox&quot; drawtype with &#x27;type = &quot;leveled&quot;&#x27;.
    ^ Allows defining the nodebox height without using param2.
    ^ The nodebox height is &#x27;leveled&#x27; / 64 nodes.
    ^ The maximum value of &#x27;leveled&#x27; is 127. ]]
    liquid_range = 8, -- number of flowing nodes around source (max. 8)
    drowning = 0,
    ^ Player will take this amount of damage if no bubbles are left.
    light_source = 0, --[[
    ^ Amount of light emitted by node.
    ^ To set the maximum (currently 14), use the value
    ^ &#x27;minetest.LIGHT_MAX&#x27;.
    ^ A value outside the range 0 to minetest.LIGHT_MAX causes undefined
    ^ behavior.]]
    damage_per_second = 0,
    ^ If player is inside node, this damage is caused.
    node_box = {type=&quot;regular&quot;}, -- See &quot;Node boxes&quot;
    connects_to = nodenames, --[[
    ^ Used for nodebox nodes with the type == &quot;connected&quot;
    ^ Specifies to what neighboring nodes connections will be drawn
    ^ e.g. `{&quot;group:fence&quot;, &quot;default:wood&quot;}` or `&quot;default:stone&quot;` ]]
    connect_sides = { &quot;top&quot;, &quot;bottom&quot;, &quot;front&quot;, &quot;left&quot;, &quot;back&quot;, &quot;right&quot; },
</code></pre><p>		-- [[</p><pre><code>    ^ Tells connected nodebox nodes to connect only to these sides of this
    ^ node. ]]
    mesh = &quot;model&quot;,
    selection_box = {
        type = &quot;fixed&quot;,
        fixed = {
            {-2 / 16, -0.5, -2 / 16, 2 / 16, 3 / 16, 2 / 16},
        },
    },
    ^ Custom selection box definition. Multiple boxes can be defined.
    ^ If drawtype &quot;nodebox&quot; is used and selection_box is nil, then node_box
    ^ definition is used for the selection box.
    collision_box = {
        type = &quot;fixed&quot;,
        fixed = {
            {-2 / 16, -0.5, -2 / 16, 2 / 16, 3 / 16, 2 / 16},
        },
    },
    ^ Custom collision box definition. Multiple boxes can be defined.
    ^ If drawtype &quot;nodebox&quot; is used and collision_box is nil, then node_box
    ^ definition is used for the collision box.
    ^ For both of the above a box is defined as:
    ^ {xmin, ymin, zmin, xmax, ymax, zmax} in nodes from node center.
    legacy_facedir_simple = false,
    ^ Support maps made in and before January 2012.
    legacy_wallmounted = false,
    ^ Support maps made in and before January 2012.
    waving = 0, --[[
    ^ Valid for mesh, nodebox, plantlike, allfaces_optional nodes.
    ^ 1 - wave node like plants (top of node moves, bottom is fixed)
    ^ 2 - wave node like leaves (whole node moves side-to-side)
    ^ caveats: not all models will properly wave.
    ^ plantlike drawtype nodes can only wave like plants.
    ^ allfaces_optional drawtype nodes can only wave like leaves. --]]
    sounds = {
        footstep = &lt;SimpleSoundSpec&gt;,
        dig = &lt;SimpleSoundSpec&gt;, -- &quot;__group&quot; = group-based sound (default)
        dug = &lt;SimpleSoundSpec&gt;,
        place = &lt;SimpleSoundSpec&gt;,
        place_failed = &lt;SimpleSoundSpec&gt;,
    },
    drop = &quot;&quot;,
    ^ Name of dropped node when dug. Default is the node itself.
    ^ Alternatively:
    drop = {
        max_items = 1,  -- Maximum number of items to drop.
        items = {  -- Choose max_items randomly from this list.
            {
                items = {&quot;foo:bar&quot;, &quot;baz:frob&quot;},  -- Items to drop.
                rarity = 1,  -- Probability of dropping is 1 / rarity.
                inherit_color = true, -- To inherit palette color from the
                                         node.
            },
        },
    },
</code></pre><br><pre><code>    on_construct = func(pos), --[[
    ^ Node constructor; called after adding node
    ^ Can set up metadata and stuff like that
    ^ Not called for bulk node placement (i.e. schematics and VoxelManip)
    ^ default: nil ]]
</code></pre><br><pre><code>    on_destruct = func(pos), --[[
    ^ Node destructor; called before removing node
    ^ Not called for bulk node placement (i.e. schematics and VoxelManip)
    ^ default: nil ]]
</code></pre><br><pre><code>    after_destruct = func(pos, oldnode), --[[
    ^ Node destructor; called after removing node
    ^ Not called for bulk node placement (i.e. schematics and VoxelManip)
    ^ default: nil ]]
</code></pre><br><pre><code>    on_flood = func(pos, oldnode, newnode), --[[
    ^ Called when a liquid (newnode) is about to flood oldnode, if
    ^ it has `floodable = true` in the nodedef. Not called for bulk
    ^ node placement (i.e. schematics and VoxelManip) or air nodes. If
    ^ return true the node is not flooded, but on_flood callback will
    ^ most likely be called over and over again every liquid update
    ^ interval. Default: nil.
    ^ Warning: making a liquid node &#x27;floodable&#x27; will cause problems. ]]
</code></pre><br><pre><code>    preserve_metadata = func(pos, oldnode, oldmeta, drops) --[[
    ^ Called when oldnode is about be converted to an item, but before the
    ^ node is deleted from the world or the drops are added. This is
    ^ generally the result of either the node being dug or an attached node
    ^ becoming detached.
    ^ drops is a table of ItemStacks, so any metadata to be preserved can
    ^ be added directly to one or more of the dropped items. See
    ^ &quot;ItemStackMetaRef&quot;.
    ^ default: nil ]]
</code></pre><br><pre><code>    after_place_node = func(pos, placer, itemstack, pointed_thing) --[[
    ^ Called after constructing node when node was placed using
    ^ minetest.item_place_node / minetest.place_node
    ^ If return true no item is taken from itemstack
    ^ `placer` may be any valid ObjectRef or nil
    ^ default: nil ]]
</code></pre><br><pre><code>    after_dig_node = func(pos, oldnode, oldmetadata, digger), --[[
    ^ oldmetadata is in table format
    ^ Called after destructing node when node was dug using
    ^ minetest.node_dig / minetest.dig_node
    ^ default: nil ]]
</code></pre><br><pre><code>    can_dig = function(pos, [player]) --[[
    ^ returns true if node can be dug, or false if not
    ^ default: nil ]]
</code></pre><br><pre><code>    on_punch = func(pos, node, puncher, pointed_thing), --[[
    ^ default: minetest.node_punch
    ^ By default: Calls minetest.register_on_punchnode callbacks ]]
</code></pre><br><pre><code>    on_rightclick = func(pos, node, clicker, itemstack, pointed_thing),
    --[[
    ^ default: nil
    ^ itemstack will hold clicker&#x27;s wielded item
    ^ Shall return the leftover itemstack
    ^ Note: pointed_thing can be nil, if a mod calls this function
    ^ This function does not get triggered by clients &lt;=0.4.16 if the
    ^ &quot;formspec&quot; node metadata field is set ]]
</code></pre><br><pre><code>    on_dig = func(pos, node, digger), --[[
    ^ default: minetest.node_dig
    ^ By default: checks privileges, wears out tool and removes node ]]
</code></pre><br><pre><code>    on_timer = function(pos,elapsed), --[[
    ^ default: nil
    ^ called by NodeTimers, see minetest.get_node_timer and NodeTimerRef
    ^ elapsed is the total time passed since the timer was started
    ^ return true to run the timer for another cycle with the same timeout
    ^ value. ]]
</code></pre><br><pre><code>    on_receive_fields = func(pos, formname, fields, sender), --[[
    ^ fields = {name1 = value1, name2 = value2, ...}
    ^ Called when an UI form (e.g. sign text input) returns data
    ^ default: nil ]]
</code></pre><br><pre><code>    allow_metadata_inventory_move = func(pos, from_list, from_index, to_list, to_index, count, player),
    --[[
    ^ Called when a player wants to move items inside the inventory
    ^ Return value: number of items allowed to move ]]
</code></pre><br><pre><code>    allow_metadata_inventory_put = func(pos, listname, index, stack, player),
    --[[
    ^ Called when a player wants to put something into the inventory
    ^ Return value: number of items allowed to put
    ^ Return value: -1: Allow and don&#x27;t modify item count in inventory ]]
</code></pre><br><pre><code>    allow_metadata_inventory_take = func(pos, listname, index, stack, player),
    --[[
    ^ Called when a player wants to take something out of the inventory
    ^ Return value: number of items allowed to take
    ^ Return value: -1: Allow and don&#x27;t modify item count in inventory ]]
</code></pre><br><pre><code>    on_metadata_inventory_move = func(pos, from_list, from_index, to_list, to_index, count, player),
    on_metadata_inventory_put = func(pos, listname, index, stack, player),
    on_metadata_inventory_take = func(pos, listname, index, stack, player),
    --[[
    ^ Called after the actual action has happened, according to what was
    ^ allowed.
    ^ No return value ]]
</code></pre><br><pre><code>    on_blast = func(pos, intensity), --[[
    ^ intensity: 1.0 = mid range of regular TNT
    ^ If defined, called when an explosion touches the node, instead of
      removing the node ]]
}
</code></pre><br><h3 id="gheader305"><p>Recipe for <code>register_craft</code> (shaped)</p></h3><br><pre><code>{
    output = &#x27;default:pick_stone&#x27;,
    recipe = {
        {&#x27;default:cobble&#x27;, &#x27;default:cobble&#x27;, &#x27;default:cobble&#x27;},
        {&#x27;&#x27;, &#x27;default:stick&#x27;, &#x27;&#x27;},
        {&#x27;&#x27;, &#x27;default:stick&#x27;, &#x27;&#x27;}, -- Also groups; e.g. &#x27;group:crumbly&#x27;
    },
    replacements = --[[&lt;optional list of item pairs,
                    replace one input item with another item on crafting&gt;]]
}
</code></pre><br><h3 id="gheader306"><p>Recipe for <code>register_craft</code> (shapeless)</p></h3><br><pre><code>{
   type = &quot;shapeless&quot;,
   output = &#x27;mushrooms:mushroom_stew&#x27;,
   recipe = {
       &quot;mushrooms:bowl&quot;,
       &quot;mushrooms:mushroom_brown&quot;,
       &quot;mushrooms:mushroom_red&quot;,
   },
   replacements = --[[&lt;optional list of item pairs,
                   replace one input item with another item on crafting&gt;]]
</code></pre><p>   }</p><br><h3 id="gheader307"><p>Recipe for <code>register_craft</code> (tool repair)</p></h3><br><pre><code>{
    type = &quot;toolrepair&quot;,
    additional_wear = -0.02,
}
</code></pre><br><h3 id="gheader308"><p>Recipe for <code>register_craft</code> (cooking)</p></h3><br><pre><code>{
    type = &quot;cooking&quot;,
    output = &quot;default:glass&quot;,
    recipe = &quot;default:sand&quot;,
    cooktime = 3,
}
</code></pre><br><h3 id="gheader309"><p>Recipe for <code>register_craft</code> (furnace fuel)</p></h3><br><pre><code>{
    type = &quot;fuel&quot;,
    recipe = &quot;default:leaves&quot;,
    burntime = 1,
}
</code></pre><br><h3 id="gheader310"><p>Ore definition (<code>register_ore</code>)</p></h3><br><pre><code>See &#x27;Ore types&#x27; section above for essential information.
</code></pre><br><pre><code>{
    ore_type = &quot;scatter&quot;,
    ore = &quot;default:stone_with_coal&quot;,
    ore_param2 = 3,
--  ^ Facedir rotation. Default is 0 (unchanged rotation)
    wherein = &quot;default:stone&quot;,
--  ^ a list of nodenames is supported too
    clust_scarcity = 8 * 8 * 8,
--  ^ Ore has a 1 out of clust_scarcity chance of spawning in a node
--  ^ If the desired average distance between ores is &#x27;d&#x27;, set this to
--  ^ d * d * d.
    clust_num_ores = 8,
--  ^ Number of ores in a cluster
    clust_size = 3,
--  ^ Size of the bounding box of the cluster
--  ^ In this example, there is a 3 * 3 * 3 cluster where 8 out of the 27
--  ^ nodes are coal ore.
    y_min = -31000,
    y_max = 64,
--  ^ Lower and upper limits for ore.
    flags = &quot;&quot;,
--  ^ Attributes for this ore generation, see &#x27;Ore attributes&#x27; section
--  ^ above.
    noise_threshold = 0.5,
--  ^ If noise is above this threshold, ore is placed. Not needed for a
--  ^ uniform distribution.
    noise_params = {
        offset = 0,
        scale = 1,
        spread = {x = 100, y = 100, z = 100},
        seed = 23,
        octaves = 3,
        persist = 0.7
    },
--  ^ NoiseParams structure describing one of the perlin noises used for
--  ^ ore distribution.
--  ^ Needed by &quot;sheet&quot;, &quot;puff&quot;, &quot;blob&quot; and &quot;vein&quot; ores.
--  ^ Omit from &quot;scatter&quot; ore for a uniform ore distribution.
--  ^ Omit from &quot;stratum ore for a simple horizontal strata from y_min to
--  ^ y_max.
    biomes = {&quot;desert&quot;, &quot;rainforest&quot;}
--  ^ List of biomes in which this decoration occurs.
--  ^ Occurs in all biomes if this is omitted, and ignored if the Mapgen
--  ^ being used does not support biomes.
--  ^ Can be a list of (or a single) biome names, IDs, or definitions.
    column_height_min = 1,
    column_height_max = 16,
    column_midpoint_factor = 0.5,
--  ^ See &#x27;Ore types&#x27; section above.
--  ^ The above 3 parameters are only valid for &quot;sheet&quot; ore.
    np_puff_top = {
        offset = 4,
        scale = 2,
        spread = {x = 100, y = 100, z = 100},
        seed = 47,
        octaves = 3,
        persist = 0.7
    },
    np_puff_bottom = {
        offset = 4,
        scale = 2,
        spread = {x = 100, y = 100, z = 100},
        seed = 11,
        octaves = 3,
        persist = 0.7
    },
--  ^ See &#x27;Ore types&#x27; section above.
--  ^ The above 2 parameters are only valid for &quot;puff&quot; ore.
    random_factor = 1.0,
--  ^ See &#x27;Ore types&#x27; section above.
--  ^ Only valid for &quot;vein&quot; ore.
    np_stratum_thickness = {
        offset = 8,
        scale = 4,
        spread = {x = 100, y = 100, z = 100},
        seed = 17,
        octaves = 3,
        persist = 0.7
    },
    stratum_thickness = 8,
--  ^ See &#x27;Ore types&#x27; section above.
--  ^ The above 2 parameters are only valid for &quot;stratum&quot; ore.
}
</code></pre><br><h3 id="gheader311"><p>Biome definition (<code>register_biome</code>)</p></h3><br><pre><code>{
    name = &quot;tundra&quot;,
    node_dust = &quot;default:snow&quot;,
--  ^ Node dropped onto upper surface after all else is generated.
    node_top = &quot;default:dirt_with_snow&quot;,
    depth_top = 1,
--  ^ Node forming surface layer of biome and thickness of this layer.
    node_filler = &quot;default:permafrost&quot;,
    depth_filler = 3,
--  ^ Node forming lower layer of biome and thickness of this layer.
    node_stone = &quot;default:bluestone&quot;,
--  ^ Node that replaces all stone nodes between roughly y_min and y_max.
    node_water_top = &quot;default:ice&quot;,
    depth_water_top = 10,
--  ^ Node forming a surface layer in seawater with the defined thickness.
    node_water = &quot;&quot;,
--  ^ Node that replaces all seawater nodes not in the defined surface
--  ^ layer.
    node_river_water = &quot;default:ice&quot;,
--  ^ Node that replaces river water in mapgens that use
--  ^ default:river_water.
    node_riverbed = &quot;default:gravel&quot;,
    depth_riverbed = 2,
--  ^ Node placed under river water and thickness of this layer.
    node_cave_liquid = &quot;default:water_source&quot;,
--  ^ Nodes placed as a blob of liquid in 50% of large caves.
--  ^ If absent, cave liquids fall back to classic behaviour of lava or
--  ^ water distributed according to a hardcoded 3D noise.
    node_dungeon = &quot;default:cobble&quot;,
--  ^ Node used for primary dungeon structure.
--  ^ If absent, dungeon materials fall back to classic behaviour.
--  ^ If present, the following two nodes are also used.
    node_dungeon_alt = &quot;default:mossycobble&quot;,
--  ^ Node used for randomly-distributed alternative structure nodes.
--  ^ If alternative structure nodes are not wanted leave this absent for
--  ^ performance reasons.
    node_dungeon_stair = &quot;stairs:stair_cobble&quot;,
--  ^ Node used for dungeon stairs.
--  ^ If absent, stairs fall back to &#x27;node_dungeon&#x27;.
    y_max = 31000,
    y_min = 1,
--  ^ Upper and lower limits for biome.
--  ^ Alternatively you can use xyz limits as shown below.
    max_pos = {x = 31000, y = 128, z = 31000},
    min_pos = {x = -31000, y = 9, z = -31000},
--  ^ xyz limits for biome, an alternative to using &#x27;y_min&#x27; and &#x27;y_max&#x27;.
--  ^ Biome is limited to a cuboid defined by these positions.
--  ^ Any x, y or z field left undefined defaults to -31000 in &#x27;min_pos&#x27; or
--  ^ 31000 in &#x27;max_pos&#x27;.
    vertical_blend = 8,
--  ^ Vertical distance in nodes above &#x27;y_max&#x27; over which the biome will
--  ^ blend with the biome above.
--  ^ Set to 0 for no vertical blend. Defaults to 0.
    heat_point = 0,
    humidity_point = 50,
--  ^ Characteristic temperature and humidity for the biome.
--  ^ These values create &#x27;biome points&#x27; on a voronoi diagram with heat and
--  ^ humidity as axes. The resulting voronoi cells determine the
--  ^ distribution of the biomes.
--  ^ Heat and humidity have average values of 50, vary mostly between
--  ^ 0 and 100 but can exceed these values.
}
</code></pre><br><h3 id="gheader312"><p>Decoration definition (<code>register_decoration</code>)</p></h3><br><pre><code>{
    deco_type = &quot;simple&quot;, -- See &quot;Decoration types&quot;
    place_on = &quot;default:dirt_with_grass&quot;,
--  ^ Node (or list of nodes) that the decoration can be placed on
    sidelen = 8,
--  ^ Size of the square divisions of the mapchunk being generated.
--  ^ Determines the resolution of noise variation if used.
--  ^ If the chunk size is not evenly divisible by sidelen, sidelen is made
--  ^ equal to the chunk size.
    fill_ratio = 0.02,
--  ^ The value determines &#x27;decorations per surface node&#x27;.
--  ^ Used only if noise_params is not specified.
--  ^ If &gt;= 10.0 complete coverage is enabled and decoration placement uses
--  ^ a different and much faster method.
    noise_params = {
        offset = 0,
        scale = 0.45,
        spread = {x = 100, y = 100, z = 100},
        seed = 354,
        octaves = 3,
        persist = 0.7,
        lacunarity = 2.0,
        flags = &quot;absvalue&quot;
    },
--  ^ NoiseParams structure describing the perlin noise used for decoration
--  ^ distribution.
--  ^ A noise value is calculated for each square division and determines
--  ^ &#x27;decorations per surface node&#x27; within each division.
--  ^ If the noise value &gt;= 10.0 complete coverage is enabled and decoration
--  ^ placement uses a different and much faster method.
    biomes = {&quot;Oceanside&quot;, &quot;Hills&quot;, &quot;Plains&quot;},
--  ^ List of biomes in which this decoration occurs. Occurs in all biomes
--  ^ if this is omitted, and ignored if the Mapgen being used does not
--  ^ support biomes.
--  ^ Can be a list of (or a single) biome names, IDs, or definitions.
    y_min = -31000
    y_max = 31000
--  ^ Lower and upper limits for decoration.
--  ^ These parameters refer to the Y co-ordinate of the &#x27;place_on&#x27; node.
    spawn_by = &quot;default:water&quot;,
--  ^ Node (or list of nodes) that the decoration only spawns next to.
--  ^ Checks two horizontal planes of 8 neighbouring nodes (including
--  ^ diagonal neighbours), one plane level with the &#x27;place_on&#x27; node and a
--  ^ plane one node above that.
    num_spawn_by = 1,
--  ^ Number of spawn_by nodes that must be surrounding the decoration
--  ^ position to occur.
--  ^ If absent or -1, decorations occur next to any nodes.
    flags = &quot;liquid_surface, force_placement, all_floors, all_ceilings&quot;,
--  ^ Flags for all decoration types.
--  ^ &quot;liquid_surface&quot;: Instead of placement on the highest solid surface
--  ^   in a mapchunk column, placement is on the highest liquid surface.
--  ^   Placement is disabled if solid nodes are found above the liquid
--  ^   surface.
--  ^ &quot;force_placement&quot;: Nodes other than &quot;air&quot; and &quot;ignore&quot; are replaced
--  ^   by the decoration.
--  ^ &quot;all_floors&quot;, &quot;all_ceilings&quot;: Instead of placement on the highest
--  ^   surface in a mapchunk the decoration is placed on all floor and/or
--  ^   ceiling surfaces, for example in caves.
--  ^   Ceiling decorations act as an inversion of floor decorations so the
--  ^   effect of &#x27;place_offset_y&#x27; is inverted.
--  ^   If a single decoration registration has both flags the floor and
--  ^   ceiling decorations will be aligned vertically and may sometimes
--  ^   meet to form a column.
</code></pre><br><pre><code>    ----- Simple-type parameters
    decoration = &quot;default:grass&quot;,
--  ^ The node name used as the decoration.
--  ^ If instead a list of strings, a randomly selected node from the list
--  ^ is placed as the decoration.
    height = 1,
--  ^ Decoration height in nodes.
--  ^ If height_max is not 0, this is the lower limit of a randomly
--  ^ selected height.
    height_max = 0,
--  ^ Upper limit of the randomly selected height.
--  ^ If absent, the parameter &#x27;height&#x27; is used as a constant.
    param2 = 0,
--  ^ Param2 value of decoration nodes.
--  ^ If param2_max is not 0, this is the lower limit of a randomly
--  ^ selected param2.
    param2_max = 0,
--  ^ Upper limit of the randomly selected param2.
--  ^ If absent, the parameter &#x27;param2&#x27; is used as a constant.
    place_offset_y = 0,
--  ^ Y offset of the decoration base node relative to the standard base
--  ^ node position.
--  ^ Can be positive or negative. Default is 0.
--  ^ Effect is inverted for &quot;all_ceilings&quot; decorations.
--  ^ Ignored by &#x27;y_min&#x27;, &#x27;y_max&#x27; and &#x27;spawn_by&#x27; checks, which always refer
--  ^ to the &#x27;place_on&#x27; node.
</code></pre><br><pre><code>    ----- Schematic-type parameters
    schematic = &quot;foobar.mts&quot;,
--  ^ If schematic is a string, it is the filepath relative to the current
--  ^ working directory of the specified Minetest schematic file.
--  ^  - OR -, could be the ID of a previously registered schematic
--  ^  - OR -, could instead be a table containing two mandatory fields,
--  ^ size and data, and an optional table yslice_prob:
    schematic = {
        size = {x = 4, y = 6, z = 4},
        data = {
            {name = &quot;default:cobble&quot;, param1 = 255, param2 = 0},
            {name = &quot;default:dirt_with_grass&quot;, param1 = 255, param2 = 0},
            {name = &quot;air&quot;, param1 = 255, param2 = 0},
             ...
        },
        yslice_prob = {
            {ypos = 2, prob = 128},
            {ypos = 5, prob = 64},
             ...
        },
    },
--  ^ See &#x27;Schematic specifier&#x27; for details.
    replacements = {[&quot;oldname&quot;] = &quot;convert_to&quot;, ...},
    flags = &quot;place_center_x, place_center_y, place_center_z&quot;,
--  ^ Flags for schematic decorations.  See &#x27;Schematic attributes&#x27;.
    rotation = &quot;90&quot;,
--  ^ Rotation can be &quot;0&quot;, &quot;90&quot;, &quot;180&quot;, &quot;270&quot;, or &quot;random&quot;.
    place_offset_y = 0,
--  ^ If the flag &#x27;place_center_y&#x27; is set this parameter is ignored.
--  ^ Y offset of the schematic base node layer relative to the &#x27;place_on&#x27;
--  ^ node.
--  ^ Can be positive or negative. Default is 0.
--  ^ Effect is inverted for &quot;all_ceilings&quot; decorations.
--  ^ Ignored by &#x27;y_min&#x27;, &#x27;y_max&#x27; and &#x27;spawn_by&#x27; checks, which always refer
--  ^ to the &#x27;place_on&#x27; node.
}
</code></pre><br><h3 id="gheader313"><p>Chat command definition (<code>register_chatcommand</code>)</p></h3><br><pre><code>{
    params = &quot;&lt;name&gt; &lt;privilege&gt;&quot;, -- Short parameter description
    description = &quot;Remove privilege from player&quot;, -- Full description
    privs = {privs=true}, -- Require the &quot;privs&quot; privilege to run
    func = function(name, param), -- Called when command is run.
                                  -- Returns boolean success and text
                                  -- output.
}
</code></pre><br><p>Note that in params, use of symbols is as follows:</p><br><ul><li><p><code>&lt;&gt;</code> signifies a placeholder to be replaced when the command is used. For</p></li><p>  example, when a player name is needed: <code>&lt;name&gt;</code></p><li><p><code>[]</code> signifies param is optional and not required when the command is used.</p></li><p>  For example, if you require param1 but param2 is optional:</p><p>  <code>&lt;param1&gt; [&lt;param2&gt;]</code></p><li><p><code>|</code> signifies exclusive or. The command requires one param from the options</p></li><p>  provided. For example: <code>&lt;param1&gt; | &lt;param2&gt;</code></p><li><p><code>()</code> signifies grouping. For example, when param1 and param2 are both</p></li><p>  required, or only param3 is required: <code>(&lt;param1&gt; &lt;param2&gt;) | &lt;param3&gt;</code></p></ul><br><h3 id="gheader314"><p>Detached inventory callbacks</p></h3><br><pre><code>{
    allow_move = func(inv, from_list, from_index, to_list, to_index, count, player),
--  ^ Called when a player wants to move items inside the inventory
--  ^ Return value: number of items allowed to move
</code></pre><br><pre><code>    allow_put = func(inv, listname, index, stack, player),
--  ^ Called when a player wants to put something into the inventory
--  ^ Return value: number of items allowed to put
--  ^ Return value: -1: Allow and don&#x27;t modify item count in inventory
</code></pre><br><pre><code>    allow_take = func(inv, listname, index, stack, player),
--  ^ Called when a player wants to take something out of the inventory
--  ^ Return value: number of items allowed to take
--  ^ Return value: -1: Allow and don&#x27;t modify item count in inventory
</code></pre><br><pre><code>    on_move = func(inv, from_list, from_index, to_list, to_index, count, player),
    on_put = func(inv, listname, index, stack, player),
    on_take = func(inv, listname, index, stack, player),
--  ^ Called after the actual action has happened, according to what was
--  ^ allowed.
--  ^ No return value
}
</code></pre><br><h3 id="gheader315"><p>HUD Definition (<code>hud_add</code>, <code>hud_get</code>)</p></h3><br><pre><code>{
    hud_elem_type = &quot;image&quot;, -- see HUD element types
--  ^ type of HUD element, can be either of &quot;image&quot;, &quot;text&quot;, &quot;statbar&quot;,
      &quot;inventory&quot;.
    position = {x=0.5, y=0.5},
--  ^ Left corner position of element
    name = &quot;&lt;name&gt;&quot;,
    scale = {x = 2, y = 2},
    text = &quot;&lt;text&gt;&quot;,
    number = 2,
    item = 3,
--  ^ Selected item in inventory.  0 for no item selected.
    direction = 0,
--  ^ Direction: 0: left-right, 1: right-left, 2: top-bottom, 3: bottom-top
    alignment = {x=0, y=0},
--  ^ See &quot;HUD Element Types&quot;
    offset = {x=0, y=0},
--  ^ See &quot;HUD Element Types&quot;
    size = { x=100, y=100 },
--  ^ Size of element in pixels
}
</code></pre><br><h3 id="gheader316"><p>Particle definition (<code>add_particle</code>)</p></h3><br><pre><code>{
    pos = {x=0, y=0, z=0},
    velocity = {x=0, y=0, z=0},
    acceleration = {x=0, y=0, z=0},
--  ^ Spawn particle at pos with velocity and acceleration
    expirationtime = 1,
--  ^ Disappears after expirationtime seconds
    size = 1,
    collisiondetection = false,
--  ^ collisiondetection: if true collides with physical objects
    collision_removal = false,
--  ^ collision_removal: if true then particle is removed when it collides,
--  ^ requires collisiondetection = true to have any effect
    vertical = false,
--  ^ vertical: if true faces player using y axis only
    texture = &quot;image.png&quot;,
--  ^ Uses texture (string)
    playername = &quot;singleplayer&quot;,
--  ^ Optional, if specified spawns particle only on the player&#x27;s client
    animation = {Tile Animation definition},
--  ^ Optional, specifies how to animate the particle texture
    glow = 0
--  ^ Optional, specify particle self-luminescence in darkness.
--  ^ Values 0-14.
}
</code></pre><h1 id="gheader317"><br></h1><br><h3 id="gheader318"><p><code>ParticleSpawner</code> definition (<code>add_particlespawner</code>)</p></h3><br><pre><code>{
    amount = 1,
    time = 1,
--  ^ If time is 0 has infinite lifespan and spawns the amount on a
--  ^ per-second basis.
    minpos = {x=0, y=0, z=0},
    maxpos = {x=0, y=0, z=0},
    minvel = {x=0, y=0, z=0},
    maxvel = {x=0, y=0, z=0},
    minacc = {x=0, y=0, z=0},
    maxacc = {x=0, y=0, z=0},
    minexptime = 1,
    maxexptime = 1,
    minsize = 1,
    maxsize = 1,
--  ^ The particle&#x27;s properties are random values in between the bounds:
--  ^ minpos/maxpos, minvel/maxvel (velocity),
--  ^ minacc/maxacc (acceleration), minsize/maxsize,
--  ^ minexptime/maxexptime (expirationtime).
    collisiondetection = false,
--  ^ collisiondetection: if true uses collision detection
    collision_removal = false,
--  ^ collision_removal: if true then particle is removed when it collides,
--  ^ requires collisiondetection = true to have any effect
    attached = ObjectRef,
--  ^ attached: if defined, particle positions, velocities and
--  ^ accelerations are relative to this object&#x27;s position and yaw.
    vertical = false,
--  ^ vertical: if true faces player using y axis only
    texture = &quot;image.png&quot;,
--  ^ Uses texture (string)
    playername = &quot;singleplayer&quot;
--  ^ Playername is optional, if specified spawns particle only on the
--  ^ player&#x27;s client.
    animation = {Tile Animation definition},
--  ^ Optional, specifies how to animate the particle texture
    glow = 0
--  ^ Optional, specify particle self-luminescence in darkness.
--  ^ Values 0-14.
}
</code></pre><br><h3 id="gheader319"><p><code>HTTPRequest</code> definition (<code>HTTPApiTable.fetch_async</code>, <code>HTTPApiTable.fetch_async</code>)</p></h3><br><pre><code>{
    url = &quot;http://example.org&quot;,
    timeout = 10,
--  ^ Timeout for connection in seconds. Default is 3 seconds.
    post_data = &quot;Raw POST request data string&quot; OR {field1 = &quot;data1&quot;, field2 = &quot;data2&quot;},
--  ^ Optional, if specified a POST request with post_data is performed.
--  ^ Accepts both a string and a table. If a table is specified, encodes
--  ^ table as x-www-form-urlencoded key-value pairs.
--  ^ If post_data ist not specified, a GET request is performed instead.
    user_agent = &quot;ExampleUserAgent&quot;,
--  ^ Optional, if specified replaces the default minetest user agent with
--  ^ given string.
    extra_headers = { &quot;Accept-Language: en-us&quot;, &quot;Accept-Charset: utf-8&quot; },
--  ^ Optional, if specified adds additional headers to the HTTP request.
--  ^ You must make sure that the header strings follow HTTP specification
--  ^ (&quot;Key: Value&quot;).
    multipart = boolean
--  ^ Optional, if true performs a multipart HTTP request.
--  ^ Default is false.
}
</code></pre><br><h3 id="gheader320"><p><code>HTTPRequestResult</code> definition (<code>HTTPApiTable.fetch</code> callback, <code>HTTPApiTable.fetch_async_get</code>)</p></h3><br><pre><code>{
    completed = true,
--  ^ If true, the request has finished (either succeeded, failed or timed
      out).
    succeeded = true,
--  ^ If true, the request was successful
    timeout = false,
--  ^ If true, the request timed out
    code = 200,
--  ^ HTTP status code
    data = &quot;response&quot;
}
</code></pre><br><h3 id="gheader321"><p>Authentication handler definition</p></h3><br><pre><code>{
    get_auth = func(name),
--  ^ Get authentication data for existing player `name` (`nil` if player
      doesn&#x27;t exist).
--  ^ returns following structure:
--  ^ `{password=&lt;string&gt;, privileges=&lt;table&gt;, last_login=&lt;number or nil&gt;}`
    create_auth = func(name, password),
--  ^ Create new auth data for player `name`
--  ^ Note that `password` is not plain-text but an arbitrary
--  ^ representation decided by the engine
    delete_auth = func(name),
--  ^ Delete auth data of player `name`, returns boolean indicating success
--  ^ (false if player nonexistant).
    set_password = func(name, password),
--  ^ Set password of player `name` to `password`
       Auth data should be created if not present
    set_privileges = func(name, privileges),
--  ^ Set privileges of player `name`
--  ^ `privileges` is in table form, auth data should be created if not
--  ^ present.
    reload = func(),
--  ^ Reload authentication data from the storage location
--  ^ Returns boolean indicating success
    record_login = func(name),
--  ^ Called when player joins, used for keeping track of last_login
    iterate = func(),
--  ^ Returns an iterator (use with `for` loops) for all player names
--  ^ currently in the auth database.
}
</code></pre><br>
                        <!--Python script places stuff here-->
                    </div>
                </div>
                <hr>
            </div>
        </div>


        <div class="container">
            <footer>
                <p>Minetest is a free software game engine currently under development to create various games based on voxel gameplay, inspired by InfiniMiner, Minecraft, and the like. Minetest was originally created by Perttu Ahola (alias âceleron55â). </p>
                <p>&copy; Minetest Lua API Python Parser(mt-lua-api-pyparse) - Lars MÃ¼ller</p>
            </footer>
        </div>

    </body>

</html>
